2020-02-09 00:43:07.725125: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-09 00:43:07.741460: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fdea0e29f90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-09 00:43:07.741508: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Using TensorFlow backend.
WARNING:tensorflow:Large dropout rate: 0.8 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
=================================================
        TRAINING v0.4.4 (multi-class)
=================================================
Date: 2020-02-09 00:43:07.712007
MULTI-CLASS num classes: 5
------------DNN info-------------
wrapLayerSize 2
coreLayerSize 4
numCoreLayers 1
outputLayerActivation softmax
output_dim 5
loss categorical_crossentropy
optimizer adam
------------DNN info-------------
[INFO] input_shape (128, 107)
[INFO] LSTM first and last layer neurons: 2
[INFO] adding core layer 0
[INFO] created DNN
[33m[INFO] epoch 1/3[0m
[33m[INFO] loading file 1-50/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (24819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[33mencode_text_dummy orig[0m
[33mencode_text_dummy type[0m
[33mencode_text_dummy i/f_name[0m
[33mencode_text_dummy i/f_dir[0m
[33mencode_text_dummy src[0m
[33mencode_text_dummy dst[0m
[33mencode_text_dummy proto[0m
[33mencode_text_dummy appi_name[0m
[33mencode_text_dummy proxy_src_ip[0m
[33mencode_text_dummy modbus_function_description[0m
[33mencode_text_dummy scada_tag[0m
len(df.columns) 108
numFeatures 107
[INFO] columns: Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'orig-192.168.1.87',
       'orig-192.168.1.88', 'type-alert',
       ...
       'modbus_function_description-Read Tag Service',
       'modbus_function_description-Read Tag Service - Response',
       'modbus_function_description-Unknown Function Code',
       'modbus_function_description-Write Tag Service', 'scada_tag-0',
       'scada_tag-HMI_AIT202', 'scada_tag-HMI_FIT201', 'scada_tag-HMI_LIT101',
       'scada_tag-HMI_LIT301', 'scada_tag-HMI_LIT401'],
      dtype='object', length=108)
[INFO] analyze dataset: (24819975, 108)

[INFO] analyzing data
[INFO] 24819975 rows
[INFO] ** unixtime:67474 (0.27185%)
[INFO] ** modbus_function_code:[0.9743589744:99.99716%,0.0:0.0028%,1.0:4e-05%,0.9615384615000001:0.0%,0.9871794872:0.0%]
[INFO] ** modbus_transaction_id:65536 (0.26405%)
[INFO] ** service:[0.7025755984000001:99.99736%,0.0:0.00126%,0.08394601119999999:0.00023%,0.0021633145999999997:0.00021%,0.0021476384:0.00021%,0.0208806885:0.00017%,0.002116286:0.00017%,0.08391465880000001:0.00013%,0.0297847659:7e-05%,0.0021789908:5e-05%,0.0012540954:5e-05%,0.09248953609999999:4e-05%,0.08543524949999999:4e-05%,0.0348324999:1e-05%,1.0:0.0%]
[INFO] ** s_port:[0.834280824:26.01285%,0.8139250565:20.97143%,0.8029830673999999:18.17391%,0.8149336757:17.51381%,0.8137722355:17.32337%,0.0:0.00126%,0.814841983:0.00035%,0.8059172320999999:0.00033%,0.8343113882:0.00029%,0.8030136315999999:0.00025%,0.0020936488:0.00021%,0.0021089309:0.00021%,0.8345253376999999:0.00018%,0.8030441959000001:0.00014%,0.8344030809:0.00014%,0.0818051226:0.00013%,0.8147502904:0.00011%,0.8166299895999999:9e-05%,0.7788831836:4e-05%,0.8411730545999999:4e-05%,0.15240846019999998:4e-05%,0.7586191087:4e-05%,0.9834647595:4e-05%,0.9715599976:4e-05%,0.7593068036:4e-05%,0.15243902439999998:4e-05%,0.315972859:4e-05%,0.0290360046:3e-05%,0.2528119078:3e-05%,0.8876612262000001:3e-05%,0.9344397579000001:3e-05%,0.9535729568000001:3e-05%,0.1074484993:2e-05%,0.792988569:2e-05%,0.9502261752:2e-05%,0.7579772602:2e-05%,0.705452656:2e-05%,0.7414573018:2e-05%,0.7077908184999999:2e-05%,0.6970474968000001:2e-05%,0.8868054282:2e-05%,0.9802707989:2e-05%,0.9054801638:2e-05%,0.6452258696000001:2e-05%,0.8685433095:1e-05%,0.980989058:1e-05%,0.8465523565:1e-05%,0.9621003729000001:1e-05%,0.8831377224:1e-05%,0.9399107525:1e-05%,0.7825203251999999:1e-05%,0.9004676325:1e-05%,0.8212604682:1e-05%,0.9088575095999999:1e-05%,0.8738156367000001:1e-05%,0.8711259856999999:1e-05%,0.8643407299:1e-05%,0.8668928418999999:1e-05%,0.45597224770000006:1e-05%,0.7897640443:1e-05%,0.0339568433:1e-05%,0.905082829:1e-05%,0.8870957883:1e-05%,1.0:1e-05%,0.9156580476:0.0%,0.8683752063:0.0%,0.8935448376999999:0.0%,0.1074637814:0.0%,0.9339660126:0.0%,0.8591448133:0.0%,0.9842747112000001:0.0%,0.9034629256000001:0.0%,0.8262729995999999:0.0%,0.0818356868:0.0%,0.8881655358:0.0%,0.8916498562999999:0.0%,0.8985420868999999:0.0%,0.7673146279999999:0.0%,0.9765266826000001:0.0%,0.8673054588:0.0%,0.7918882572:0.0%,0.7891527599:0.0%,0.8431597286:0.0%,0.9104621309:0.0%]
[INFO] ** classification:[normal:75.94865%,Single Stage Single Point:20.68165%,Multi Stage Single Point:1.90264%,Single Stage Multi Point:0.95195%,Multi Stage Multi Point:0.5151%]
[INFO] ** orig-192.168.1.48:[1:99.9996%,0:0.0004%]
[INFO] ** orig-192.168.1.87:[0:99.99993%,1:7e-05%]
[INFO] ** orig-192.168.1.88:[0:99.99967%,1:0.00033%]
[INFO] ** type-alert:[0:99.99996%,1:4e-05%]
[INFO] ** type-control:[0:99.99975%,1:0.00025%]
[INFO] ** type-log:[1:99.99971%,0:0.00029%]
[INFO] ** i/f_name-0:[0:99.99875%,1:0.00125%]
[INFO] ** i/f_name-eth1:[1:99.99874%,0:0.00126%]
[INFO] ** i/f_name-geod daemon:[0:100.0%,1:0.0%]
[INFO] ** i/f_dir-inbound:[0:99.99885%,1:0.00115%]
[INFO] ** i/f_dir-outbound:[1:99.99885%,0:0.00115%]
[INFO] ** src-0:[0:99.99907%,1:0.00093%]
[INFO] ** src-10.15.51.65:[0:100.0%,1:0.0%]
[INFO] ** src-192.168.1.10:[0:73.98655%,1:26.01345%]
[INFO] ** src-192.168.1.134:[0:99.99995%,1:5e-05%]
[INFO] ** src-192.168.1.136:[0:99.99982%,1:0.00018%]
[INFO] ** src-192.168.1.19:[0:99.99978%,1:0.00022%]
[INFO] ** src-192.168.1.199:[0:99.99989%,1:0.00011%]
[INFO] ** src-192.168.1.20:[0:82.48573%,1:17.51427%]
[INFO] ** src-192.168.1.200:[0:99.99981%,1:0.00019%]
[INFO] ** src-192.168.1.201:[0:99.99966%,1:0.00034%]
[INFO] ** src-192.168.1.202:[0:99.99997%,1:3e-05%]
[INFO] ** src-192.168.1.30:[0:81.82569%,1:18.17431%]
[INFO] ** src-192.168.1.40:[0:99.99967%,1:0.00033%]
[INFO] ** src-192.168.1.49:[0:99.99973%,1:0.00027%]
[INFO] ** src-192.168.1.60:[0:61.7052%,1:38.2948%]
[INFO] ** src-192.168.1.88:[0:99.9995%,1:0.0005%]
[INFO] ** dst-0:[0:99.99874%,1:0.00126%]
[INFO] ** dst-192.168.1.10:[0:79.02848%,1:20.97152%]
[INFO] ** dst-192.168.1.100:[0:99.99996%,1:4e-05%]
[INFO] ** dst-192.168.1.19:[0:99.99996%,1:4e-05%]
[INFO] ** dst-192.168.1.20:[0:56.66363%,1:43.33637%]
[INFO] ** dst-192.168.1.200:[0:99.99993%,1:7e-05%]
[INFO] ** dst-192.168.1.201:[0:99.99973%,1:0.00027%]
[INFO] ** dst-192.168.1.255:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.30:[0:82.48595%,1:17.51405%]
[INFO] ** dst-192.168.1.40:[0:81.8258%,1:18.1742%]
[INFO] ** dst-192.168.1.49:[0:99.99998%,1:2e-05%]
[INFO] ** dst-192.168.1.50:[0:99.99902%,1:0.00098%]
[INFO] ** dst-192.168.1.60:[0:99.99975%,1:0.00025%]
[INFO] ** dst-192.168.1.88:[0:99.99991%,1:9e-05%]
[INFO] ** dst-224.0.0.251:[0:99.99987%,1:0.00013%]
[INFO] ** dst-224.0.0.252:[0:99.99977%,1:0.00023%]
[INFO] ** dst-239.192.4.191:[0:99.99999%,1:1e-05%]
[INFO] ** dst-239.255.255.250:[0:99.99993%,1:7e-05%]
[INFO] ** proto-0:[0:99.99874%,1:0.00126%]
[INFO] ** proto-tcp:[1:99.99788%,0:0.00212%]
[INFO] ** proto-udp:[0:99.99913%,1:0.00087%]
[INFO] ** appi_name-0:[0:99.99869%,1:0.00131%]
[INFO] ** appi_name-CIP_func75:[0:100.0%,1:0.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99996%,1:4e-05%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99716%,0:0.00284%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%,1:0.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99999%,1:1e-05%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99998%,1:2e-05%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99998%,1:2e-05%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%,1:0.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99984%,1:0.00016%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%,1:0.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99996%,1:4e-05%]
[INFO] ** appi_name-Google Chrome:[0:100.0%,1:0.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99979%,1:0.00021%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99987%,1:0.00013%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99979%,1:0.00021%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99998%,1:2e-05%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99996%,1:4e-05%]
[INFO] ** appi_name-SSDP:[0:99.99993%,1:7e-05%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99983%,1:0.00017%]
[INFO] ** appi_name-VNC:[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Web Browsing:[0:99.99996%,1:4e-05%]
[INFO] ** proxy_src_ip-0:[0:99.99869%,1:0.00131%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%,1:0.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.98655%,1:26.01345%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99996%,1:4e-05%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99978%,1:0.00022%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.9999%,1:0.0001%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48573%,1:17.51427%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99968%,1:0.00032%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99997%,1:3e-05%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82569%,1:18.17431%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99967%,1:0.00033%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99973%,1:0.00027%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.7052%,1:38.2948%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99983%,1:0.00017%]
[INFO] ** modbus_function_description-0:[0:99.9972%,1:0.0028%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99996%,1:4e-05%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00222%,1:49.99778%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00062%,1:49.99938%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%,1:0.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%,1:0.0%]
[INFO] ** scada_tag-0:[0:99.9944%,1:0.0056%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67675%,1:17.32325%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98751%,1:26.01249%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.02869%,1:20.97131%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.48643%,1:17.51357%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82621%,1:18.17379%]
[INFO] columns with count within 2-10 {'modbus_function_code': 5, 'classification': 5, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_name-geod daemon': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-10.15.51.65': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.192.4.191': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_func75': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-CIP_write_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-Common Industrial Protocol - success': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-DNP3 Protocol - initialize data to defaults': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Google Chrome': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-VNC': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-10.15.51.65': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'modbus_function_description-Unknown Function Code': 2, 'modbus_function_description-Write Tag Service': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
--------------AFTER DROPPING COLUMNS ----------------
df.columns Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'orig-192.168.1.87',
       'orig-192.168.1.88', 'type-alert',
       ...
       'modbus_function_description-Read Tag Service',
       'modbus_function_description-Read Tag Service - Response',
       'modbus_function_description-Unknown Function Code',
       'modbus_function_description-Write Tag Service', 'scada_tag-0',
       'scada_tag-HMI_AIT202', 'scada_tag-HMI_FIT201', 'scada_tag-HMI_LIT101',
       'scada_tag-HMI_LIT301', 'scada_tag-HMI_LIT401'],
      dtype='object', length=108) 108
          unixtime  modbus_function_code  modbus_transaction_id   service  \
0         0.000000              0.974359               0.105043  0.702576   
1         0.000000              0.974359               0.049699  0.702576   
2         0.000000              0.974359               0.760021  0.702576   
3         0.000000              0.974359               0.724208  0.702576   
4         0.000000              0.974359               0.099031  0.702576   
...            ...                   ...                    ...       ...   
24819970  0.587998              0.974359               0.724636  0.702576   
24819971  0.587998              0.974359               0.447852  0.702576   
24819972  0.587998              0.974359               0.724636  0.702576   
24819973  0.587998              0.974359               0.652247  0.702576   
24819974  0.587998              0.974359               0.004623  0.702576   

            s_port             classification  orig-192.168.1.48  \
0         0.813772                     normal                  1   
1         0.834281                     normal                  1   
2         0.802983                     normal                  1   
3         0.814934                     normal                  1   
4         0.813925                     normal                  1   
...            ...                        ...                ...   
24819970  0.813925                     normal                  1   
24819971  0.813772                     normal                  1   
24819972  0.813925                     normal                  1   
24819973  0.834281                     normal                  1   
24819974  0.814934  Single Stage Single Point                  1   

          orig-192.168.1.87  orig-192.168.1.88  type-alert  type-control  \
0                         0                  0           0             0   
1                         0                  0           0             0   
2                         0                  0           0             0   
3                         0                  0           0             0   
4                         0                  0           0             0   
...                     ...                ...         ...           ...   
24819970                  0                  0           0             0   
24819971                  0                  0           0             0   
24819972                  0                  0           0             0   
24819973                  0                  0           0             0   
24819974                  0                  0           0             0   

          type-log  i/f_name-0  i/f_name-eth1  i/f_name-geod daemon  \
0                1           0              1                     0   
1                1           0              1                     0   
2                1           0              1                     0   
3                1           0              1                     0   
4                1           0              1                     0   
...            ...         ...            ...                   ...   
24819970         1           0              1                     0   
24819971         1           0              1                     0   
24819972         1           0              1                     0   
24819973         1           0              1                     0   
24819974         1           0              1                     0   

          i/f_dir-inbound  i/f_dir-outbound  src-0  src-10.15.51.65  \
0                       0                 1      0                0   
1                       0                 1      0                0   
2                       0                 1      0                0   
3                       0                 1      0                0   
4                       0                 1      0                0   
...                   ...               ...    ...              ...   
24819970                0                 1      0                0   
24819971                0                 1      0                0   
24819972                0                 1      0                0   
24819973                0                 1      0                0   
24819974                0                 1      0                0   

          src-192.168.1.10  src-192.168.1.134  src-192.168.1.136  \
0                        0                  0                  0   
1                        1                  0                  0   
2                        0                  0                  0   
3                        0                  0                  0   
4                        0                  0                  0   
...                    ...                ...                ...   
24819970                 0                  0                  0   
24819971                 0                  0                  0   
24819972                 0                  0                  0   
24819973                 1                  0                  0   
24819974                 0                  0                  0   

          src-192.168.1.19  src-192.168.1.199  src-192.168.1.20  \
0                        0                  0                 0   
1                        0                  0                 0   
2                        0                  0                 0   
3                        0                  0                 1   
4                        0                  0                 0   
...                    ...                ...               ...   
24819970                 0                  0                 0   
24819971                 0                  0                 0   
24819972                 0                  0                 0   
24819973                 0                  0                 0   
24819974                 0                  0                 1   

          src-192.168.1.200  src-192.168.1.201  src-192.168.1.202  \
0                         0                  0                  0   
1                         0                  0                  0   
2                         0                  0                  0   
3                         0                  0                  0   
4                         0                  0                  0   
...                     ...                ...                ...   
24819970                  0                  0                  0   
24819971                  0                  0                  0   
24819972                  0                  0                  0   
24819973                  0                  0                  0   
24819974                  0                  0                  0   

          src-192.168.1.30  src-192.168.1.40  src-192.168.1.49  \
0                        0                 0                 0   
1                        0                 0                 0   
2                        1                 0                 0   
3                        0                 0                 0   
4                        0                 0                 0   
...                    ...               ...               ...   
24819970                 0                 0                 0   
24819971                 0                 0                 0   
24819972                 0                 0                 0   
24819973                 0                 0                 0   
24819974                 0                 0                 0   

          src-192.168.1.60  src-192.168.1.88  dst-0  dst-192.168.1.10  \
0                        1                 0      0                 0   
1                        0                 0      0                 0   
2                        0                 0      0                 0   
3                        0                 0      0                 0   
4                        1                 0      0                 1   
...                    ...               ...    ...               ...   
24819970                 1                 0      0                 1   
24819971                 1                 0      0                 0   
24819972                 1                 0      0                 1   
24819973                 0                 0      0                 0   
24819974                 0                 0      0                 0   

          dst-192.168.1.100  dst-192.168.1.19  dst-192.168.1.20  \
0                         0                 0                 1   
1                         0                 0                 1   
2                         0                 0                 0   
3                         0                 0                 0   
4                         0                 0                 0   
...                     ...               ...               ...   
24819970                  0                 0                 0   
24819971                  0                 0                 1   
24819972                  0                 0                 0   
24819973                  0                 0                 1   
24819974                  0                 0                 0   

          dst-192.168.1.200  dst-192.168.1.201  dst-192.168.1.255  \
0                         0                  0                  0   
1                         0                  0                  0   
2                         0                  0                  0   
3                         0                  0                  0   
4                         0                  0                  0   
...                     ...                ...                ...   
24819970                  0                  0                  0   
24819971                  0                  0                  0   
24819972                  0                  0                  0   
24819973                  0                  0                  0   
24819974                  0                  0                  0   

          dst-192.168.1.30  dst-192.168.1.40  dst-192.168.1.49  \
0                        0                 0                 0   
1                        0                 0                 0   
2                        0                 1                 0   
3                        1                 0                 0   
4                        0                 0                 0   
...                    ...               ...               ...   
24819970                 0                 0                 0   
24819971                 0                 0                 0   
24819972                 0                 0                 0   
24819973                 0                 0                 0   
24819974                 1                 0                 0   

          dst-192.168.1.50  dst-192.168.1.60  dst-192.168.1.88  \
0                        0                 0                 0   
1                        0                 0                 0   
2                        0                 0                 0   
3                        0                 0                 0   
4                        0                 0                 0   
...                    ...               ...               ...   
24819970                 0                 0                 0   
24819971                 0                 0                 0   
24819972                 0                 0                 0   
24819973                 0                 0                 0   
24819974                 0                 0                 0   

          dst-224.0.0.251  dst-224.0.0.252  dst-239.192.4.191  \
0                       0                0                  0   
1                       0                0                  0   
2                       0                0                  0   
3                       0                0                  0   
4                       0                0                  0   
...                   ...              ...                ...   
24819970                0                0                  0   
24819971                0                0                  0   
24819972                0                0                  0   
24819973                0                0                  0   
24819974                0                0                  0   

          dst-239.255.255.250  proto-0  proto-tcp  proto-udp  appi_name-0  \
0                           0        0          1          0            0   
1                           0        0          1          0            0   
2                           0        0          1          0            0   
3                           0        0          1          0            0   
4                           0        0          1          0            0   
...                       ...      ...        ...        ...          ...   
24819970                    0        0          1          0            0   
24819971                    0        0          1          0            0   
24819972                    0        0          1          0            0   
24819973                    0        0          1          0            0   
24819974                    0        0          1          0            0   

          appi_name-CIP_func75  appi_name-CIP_gen  \
0                            0                  0   
1                            0                  0   
2                            0                  0   
3                            0                  0   
4                            0                  0   
...                        ...                ...   
24819970                     0                  0   
24819971                     0                  0   
24819972                     0                  0   
24819973                     0                  0   
24819974                     0                  0   

          appi_name-CIP_read_tag_service  appi_name-CIP_write_tag_service  \
0                                      1                                0   
1                                      1                                0   
2                                      1                                0   
3                                      1                                0   
4                                      1                                0   
...                                  ...                              ...   
24819970                               1                                0   
24819971                               1                                0   
24819972                               1                                0   
24819973                               1                                0   
24819974                               1                                0   

          appi_name-Common Industrial Protocol  \
0                                            0   
1                                            0   
2                                            0   
3                                            0   
4                                            0   
...                                        ...   
24819970                                     0   
24819971                                     0   
24819972                                     0   
24819973                                     0   
24819974                                     0   

          appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)  \
0                                                         0                
1                                                         0                
2                                                         0                
3                                                         0                
4                                                         0                
...                                                     ...                
24819970                                                  0                
24819971                                                  0                
24819972                                                  0                
24819973                                                  0                
24819974                                                  0                

          appi_name-Common Industrial Protocol - get attribute all  \
0                                                         0          
1                                                         0          
2                                                         0          
3                                                         0          
4                                                         0          
...                                                     ...          
24819970                                                  0          
24819971                                                  0          
24819972                                                  0          
24819973                                                  0          
24819974                                                  0          

          appi_name-Common Industrial Protocol - get attribute single  \
0                                                         0             
1                                                         0             
2                                                         0             
3                                                         0             
4                                                         0             
...                                                     ...             
24819970                                                  0             
24819971                                                  0             
24819972                                                  0             
24819973                                                  0             
24819974                                                  0             

          appi_name-Common Industrial Protocol - multiple service packet  \
0                                                         0                
1                                                         0                
2                                                         0                
3                                                         0                
4                                                         0                
...                                                     ...                
24819970                                                  0                
24819971                                                  0                
24819972                                                  0                
24819973                                                  0                
24819974                                                  0                

          appi_name-Common Industrial Protocol - success  \
0                                                      0   
1                                                      0   
2                                                      0   
3                                                      0   
4                                                      0   
...                                                  ...   
24819970                                               0   
24819971                                               0   
24819972                                               0   
24819973                                               0   
24819974                                               0   

          appi_name-DCE-RPC Protocol  \
0                                  0   
1                                  0   
2                                  0   
3                                  0   
4                                  0   
...                              ...   
24819970                           0   
24819971                           0   
24819972                           0   
24819973                           0   
24819974                           0   

          appi_name-DNP3 Protocol - initialize data to defaults  \
0                                                         0       
1                                                         0       
2                                                         0       
3                                                         0       
4                                                         0       
...                                                     ...       
24819970                                                  0       
24819971                                                  0       
24819972                                                  0       
24819973                                                  0       
24819974                                                  0       

          appi_name-EtherNet/IP  appi_name-Google Chrome  \
0                             0                        0   
1                             0                        0   
2                             0                        0   
3                             0                        0   
4                             0                        0   
...                         ...                      ...   
24819970                      0                        0   
24819971                      0                        0   
24819972                      0                        0   
24819973                      0                        0   
24819974                      0                        0   

          appi_name-LLMNR Protocol  appi_name-Multicast DNS Protocol (mDNS)  \
0                                0                                        0   
1                                0                                        0   
2                                0                                        0   
3                                0                                        0   
4                                0                                        0   
...                            ...                                      ...   
24819970                         0                                        0   
24819971                         0                                        0   
24819972                         0                                        0   
24819973                         0                                        0   
24819974                         0                                        0   

          appi_name-NetBIOS Datagram Service  appi_name-NetBIOS Name Service  \
0                                          0                               0   
1                                          0                               0   
2                                          0                               0   
3                                          0                               0   
4                                          0                               0   
...                                      ...                             ...   
24819970                                   0                               0   
24819971                                   0                               0   
24819972                                   0                               0   
24819973                                   0                               0   
24819974                                   0                               0   

          appi_name-NetBIOS Session Service  appi_name-OSIsoft PI  \
0                                         0                     0   
1                                         0                     0   
2                                         0                     0   
3                                         0                     0   
4                                         0                     0   
...                                     ...                   ...   
24819970                                  0                     0   
24819971                                  0                     0   
24819972                                  0                     0   
24819973                                  0                     0   
24819974                                  0                     0   

          appi_name-SSDP  appi_name-Server Message Block (SMB)  \
0                      0                                     0   
1                      0                                     0   
2                      0                                     0   
3                      0                                     0   
4                      0                                     0   
...                  ...                                   ...   
24819970               0                                     0   
24819971               0                                     0   
24819972               0                                     0   
24819973               0                                     0   
24819974               0                                     0   

          appi_name-Unknown Traffic  appi_name-VNC  appi_name-Web Browsing  \
0                                 0              0                       0   
1                                 0              0                       0   
2                                 0              0                       0   
3                                 0              0                       0   
4                                 0              0                       0   
...                             ...            ...                     ...   
24819970                          0              0                       0   
24819971                          0              0                       0   
24819972                          0              0                       0   
24819973                          0              0                       0   
24819974                          0              0                       0   

          proxy_src_ip-0  proxy_src_ip-10.15.51.65  proxy_src_ip-192.168.1.10  \
0                      0                         0                          0   
1                      0                         0                          1   
2                      0                         0                          0   
3                      0                         0                          0   
4                      0                         0                          0   
...                  ...                       ...                        ...   
24819970               0                         0                          0   
24819971               0                         0                          0   
24819972               0                         0                          0   
24819973               0                         0                          1   
24819974               0                         0                          0   

          proxy_src_ip-192.168.1.134  proxy_src_ip-192.168.1.136  \
0                                  0                           0   
1                                  0                           0   
2                                  0                           0   
3                                  0                           0   
4                                  0                           0   
...                              ...                         ...   
24819970                           0                           0   
24819971                           0                           0   
24819972                           0                           0   
24819973                           0                           0   
24819974                           0                           0   

          proxy_src_ip-192.168.1.19  proxy_src_ip-192.168.1.199  \
0                                 0                           0   
1                                 0                           0   
2                                 0                           0   
3                                 0                           0   
4                                 0                           0   
...                             ...                         ...   
24819970                          0                           0   
24819971                          0                           0   
24819972                          0                           0   
24819973                          0                           0   
24819974                          0                           0   

          proxy_src_ip-192.168.1.20  proxy_src_ip-192.168.1.200  \
0                                 0                           0   
1                                 0                           0   
2                                 0                           0   
3                                 1                           0   
4                                 0                           0   
...                             ...                         ...   
24819970                          0                           0   
24819971                          0                           0   
24819972                          0                           0   
24819973                          0                           0   
24819974                          1                           0   

          proxy_src_ip-192.168.1.201  proxy_src_ip-192.168.1.202  \
0                                  0                           0   
1                                  0                           0   
2                                  0                           0   
3                                  0                           0   
4                                  0                           0   
...                              ...                         ...   
24819970                           0                           0   
24819971                           0                           0   
24819972                           0                           0   
24819973                           0                           0   
24819974                           0                           0   

          proxy_src_ip-192.168.1.30  proxy_src_ip-192.168.1.40  \
0                                 0                          0   
1                                 0                          0   
2                                 1                          0   
3                                 0                          0   
4                                 0                          0   
...                             ...                        ...   
24819970                          0                          0   
24819971                          0                          0   
24819972                          0                          0   
24819973                          0                          0   
24819974                          0                          0   

          proxy_src_ip-192.168.1.49  proxy_src_ip-192.168.1.60  \
0                                 0                          1   
1                                 0                          0   
2                                 0                          0   
3                                 0                          0   
4                                 0                          1   
...                             ...                        ...   
24819970                          0                          1   
24819971                          0                          1   
24819972                          0                          1   
24819973                          0                          0   
24819974                          0                          0   

          proxy_src_ip-192.168.1.88  modbus_function_description-0  \
0                                 0                              0   
1                                 0                              0   
2                                 0                              0   
3                                 0                              0   
4                                 0                              0   
...                             ...                            ...   
24819970                          0                              0   
24819971                          0                              0   
24819972                          0                              0   
24819973                          0                              0   
24819974                          0                              0   

          modbus_function_description-Forward Close - Response  \
0                                                         0      
1                                                         0      
2                                                         0      
3                                                         0      
4                                                         0      
...                                                     ...      
24819970                                                  0      
24819971                                                  0      
24819972                                                  0      
24819973                                                  0      
24819974                                                  0      

          modbus_function_description-Read Tag Service  \
0                                                    0   
1                                                    0   
2                                                    1   
3                                                    1   
4                                                    1   
...                                                ...   
24819970                                             1   
24819971                                             1   
24819972                                             0   
24819973                                             0   
24819974                                             1   

          modbus_function_description-Read Tag Service - Response  \
0                                                         1         
1                                                         1         
2                                                         0         
3                                                         0         
4                                                         0         
...                                                     ...         
24819970                                                  0         
24819971                                                  0         
24819972                                                  1         
24819973                                                  1         
24819974                                                  0         

          modbus_function_description-Unknown Function Code  \
0                                                         0   
1                                                         0   
2                                                         0   
3                                                         0   
4                                                         0   
...                                                     ...   
24819970                                                  0   
24819971                                                  0   
24819972                                                  0   
24819973                                                  0   
24819974                                                  0   

          modbus_function_description-Write Tag Service  scada_tag-0  \
0                                                     0            0   
1                                                     0            0   
2                                                     0            0   
3                                                     0            0   
4                                                     0            0   
...                                                 ...          ...   
24819970                                              0            0   
24819971                                              0            0   
24819972                                              0            0   
24819973                                              0            0   
24819974                                              0            0   

          scada_tag-HMI_AIT202  scada_tag-HMI_FIT201  scada_tag-HMI_LIT101  \
0                            1                     0                     0   
1                            0                     1                     0   
2                            0                     0                     0   
3                            0                     0                     0   
4                            0                     0                     1   
...                        ...                   ...                   ...   
24819970                     0                     0                     1   
24819971                     1                     0                     0   
24819972                     0                     0                     1   
24819973                     0                     1                     0   
24819974                     0                     0                     0   

          scada_tag-HMI_LIT301  scada_tag-HMI_LIT401  
0                            0                     0  
1                            0                     0  
2                            0                     1  
3                            1                     0  
4                            0                     0  
...                        ...                   ...  
24819970                     0                     0  
24819971                     0                     0  
24819972                     0                     0  
24819973                     0                     0  
24819974                     1                     0  

[24819975 rows x 108 columns]
[INFO] processing batch 0-256000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57548 (22.47969%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0021476384:0.00117%,0.0:0.00117%,0.0021789908:0.00078%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90586%,0.8139250565:21.04297%,0.8029830673999999:18.20469%,0.8149336757:17.47891%,0.8137722355:17.3582%,0.792988569:0.00156%,0.0:0.00117%,0.0020936488:0.00117%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00078%,0.7897640443:0.00078%,0.0818051226:0.00078%,0.0290360046:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.95547%,1:21.04453%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.73555%,1:43.26445%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.5207%,1:17.4793%]
[INFO] ** dst-192.168.1.40:[0:81.79531%,1:18.20469%]
[INFO] ** dst-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64219%,1:17.35781%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09453%,1:25.90547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95703%,1:21.04297%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52109%,1:17.47891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79531%,1:18.20469%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}2020-02-09 00:47:40.882114: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 00:47:40.912115: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:47:40.924516: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:47:41.034707: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 00:47:41.042672: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 00:47:41.051942: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:47:41.060654: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:47:41.099299: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 00:47:51.604861: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 00:47:51.611636: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:47:51.614838: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:47:51.641404: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 00:47:51.643329: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 00:47:51.645526: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:47:51.647807: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:47:51.662190: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.

[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 13s - loss: 1.5645 - tp: 0.0000e+00 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 192000.0000 - accuracy: 0.8000 - precision: 0.0000e+00 - recall: 0.0000e+00 - auc: 0.9152 - val_loss: 1.5047 - val_tp: 0.0000e+00 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 64000.0000 - val_accuracy: 0.8000 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-0-256000
[INFO] processing batch 256000-512000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00703%]
[INFO] ** modbus_transaction_id:65264 (25.49375%)
[INFO] ** service:[0.7025755984000001:99.99297%,0.0208806885:0.00156%,0.002116286:0.00117%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0021789908:0.00078%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.89492%,0.8139250565:21.03672%,0.8029830673999999:18.12031%,0.8149336757:17.56719%,0.8137722355:17.37266%,0.0:0.00117%,0.0020936488:0.00078%,0.8685433095:0.00078%,0.8344030809:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.7593068036:0.00039%,0.9399107525:0.00039%,0.315972859:0.00039%,0.8668928418999999:0.00039%,0.8030136315999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8643407299:0.00039%,0.814841983:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:57.36133%,Single Stage Single Point:42.63867%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.10469%,1:25.89531%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.43242%,1:17.56758%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8793%,1:18.1207%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.60:[0:61.59062%,1:38.40938%]
[INFO] ** src-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.96328%,1:21.03672%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.73242%,1:43.26758%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.43281%,1:17.56719%]
[INFO] ** dst-192.168.1.40:[0:81.8793%,1:18.1207%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.10469%,1:25.89531%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43242%,1:17.56758%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8793%,1:18.1207%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59062%,1:38.40938%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-0:[0:99.99297%,1:0.00703%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00391%,1:49.99609%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62734%,1:17.37266%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.10508%,1:25.89492%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96367%,1:21.03633%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4332%,1:17.5668%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88008%,1:18.11992%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255994, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 23491,  23493,  23497, ..., 255995, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 1.5530 - tp: 0.0000e+00 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 192000.0000 - accuracy: 0.8000 - precision: 0.0000e+00 - recall: 0.0000e+00 - auc: 0.7538 - val_loss: 1.5346 - val_tp: 0.0000e+00 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 64000.0000 - val_accuracy: 0.8000 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_auc: 0.8238
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-256000-512000
[INFO] processing batch 512000-768000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.95469%,0.8139250565:20.98125%,0.8029830673999999:18.17227%,0.8149336757:17.52461%,0.8137722355:17.36484%,0.8030136315999999:0.00039%,0.9621003729000001:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:78.25859%,Single Stage Single Point:21.74141%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04453%,1:25.95547%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47461%,1:17.52539%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.65391%,1:38.34609%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.01875%,1:20.98125%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68047%,1:43.31953%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.475%,1:17.525%]
[INFO] ** dst-192.168.1.40:[0:81.82734%,1:18.17266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04453%,1:25.95547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47461%,1:17.52539%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65391%,1:38.34609%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63516%,1:17.36484%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04609%,1:25.95391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01875%,1:20.98125%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47578%,1:17.52422%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82773%,1:18.17227%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255994, 255995, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      6, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 1.4806 - tp: 0.0000e+00 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 192000.0000 - accuracy: 0.8000 - precision: 0.0000e+00 - recall: 0.0000e+00 - auc: 0.8887 - val_loss: 1.3223 - val_tp: 0.0000e+00 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 64000.0000 - val_accuracy: 0.8000 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_auc: 0.9546
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-512000-768000
[INFO] processing batch 768000-1024000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:698 (0.27266%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.0043%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:63824 (24.93125%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.0208806885:0.00117%,0.0:0.00117%,0.0012540954:0.00078%,0.0348324999:0.00039%,0.0021633145999999997:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.96758%,0.8139250565:21.09844%,0.8029830673999999:18.08594%,0.8149336757:17.48789%,0.8137722355:17.35352%,0.0:0.00117%,0.7788831836:0.00078%,0.0020936488:0.00039%,0.814841983:0.00039%,0.8030441959000001:0.00039%,0.8147502904:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.792988569:0.00039%,0.8411730545999999:0.00039%,0.15240846019999998:0.00039%,0.0339568433:0.00039%,0.315972859:0.00039%,0.0021089309:0.00039%]
[INFO] ** classification:[normal:67.51602%,Single Stage Single Point:32.48398%]
[INFO] ** orig-192.168.1.48:[1:99.99961%,0:0.00039%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.51133%,1:17.48867%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91328%,1:18.08672%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.54805%,1:38.45195%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.90117%,1:21.09883%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67852%,1:43.32148%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.51211%,1:17.48789%]
[INFO] ** dst-192.168.1.40:[0:81.91367%,1:18.08633%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51133%,1:17.48867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91328%,1:18.08672%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54805%,1:38.45195%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.9957%,1:0.0043%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64687%,1:17.35312%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03242%,1:25.96758%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90156%,1:21.09844%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5125%,1:17.4875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91406%,1:18.08594%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-239.192.4.191': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      4, ..., 255995, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      7, ..., 255994, 255996, 255997]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.4442 - tp: 0.0000e+00 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 192000.0000 - accuracy: 0.8000 - precision: 0.0000e+00 - recall: 0.0000e+00 - auc: 0.8393 - val_loss: 1.6194 - val_tp: 0.0000e+00 - val_fp: 16967.0000 - val_tn: 239033.0000 - val_fn: 64000.0000 - val_accuracy: 0.7470 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_auc: 0.8520
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-768000-1024000
[INFO] processing batch 1024000-1280000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.9875%,0.0:0.0125%]
[INFO] ** modbus_transaction_id:53455 (20.88086%)
[INFO] ** service:[0.7025755984000001:99.9875%,0.08394601119999999:0.00234%,0.0021633145999999997:0.00195%,0.0:0.00195%,0.002116286:0.00156%,0.0021476384:0.00156%,0.0297847659:0.00078%,0.0208806885:0.00078%,0.08391465880000001:0.00078%,0.08543524949999999:0.00039%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.9625%,0.8139250565:21.11836%,0.8029830673999999:18.14102%,0.8149336757:17.43203%,0.8137722355:17.33203%,0.0021089309:0.00195%,0.0:0.00195%,0.0020936488:0.00156%,0.8343113882:0.00078%,0.0818051226:0.00078%,0.8166299895999999:0.00078%,0.9765266826000001:0.00039%,0.9399107525:0.00039%,0.814841983:0.00039%,0.9834647595:0.00039%,0.8643407299:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8668928418999999:0.00039%,0.7593068036:0.00039%,0.9344397579000001:0.00039%,0.0290360046:0.00039%,0.8738156367000001:0.00039%,0.15243902439999998:0.00039%,0.9621003729000001:0.00039%,0.9715599976:0.00039%]
[INFO] ** classification:[normal:77.33086%,Single Stage Single Point:22.66914%]
[INFO] ** orig-192.168.1.48:[1:99.99805%,0:0.00195%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99805%,1:0.00195%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.10:[0:74.03672%,1:25.96328%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.56758%,1:17.43242%]
[INFO] ** src-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85859%,1:18.14141%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** src-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:78.88164%,1:21.11836%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70508%,1:43.29492%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99648%,1:0.00352%]
[INFO] ** dst-192.168.1.30:[0:82.56797%,1:17.43203%]
[INFO] ** dst-192.168.1.40:[0:81.85898%,1:18.14102%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99766%,1:0.00234%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99062%,0:0.00938%]
[INFO] ** proto-udp:[0:99.99258%,1:0.00742%]
[INFO] ** appi_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9875%,0:0.0125%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99648%,1:0.00352%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03672%,1:25.96328%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56758%,1:17.43242%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85859%,1:18.14141%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-0:[0:99.9875%,1:0.0125%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00703%,1:49.99297%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98477%,1:0.01523%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66836%,1:17.33164%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03789%,1:25.96211%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.88203%,1:21.11797%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56797%,1:17.43203%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85898%,1:18.14102%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-10.15.51.65': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-10.15.51.65': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      5, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      4, ..., 123216, 123217, 123220]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.3569 - tp: 126.0000 - fp: 82.0000 - tn: 767918.0000 - fn: 191874.0000 - accuracy: 0.8000 - precision: 0.6058 - recall: 6.5625e-04 - auc: 0.8677 - val_loss: 1.0408 - val_tp: 13043.0000 - val_fp: 1761.0000 - val_tn: 254239.0000 - val_fn: 50957.0000 - val_accuracy: 0.8353 - val_precision: 0.8810 - val_recall: 0.2038 - val_auc: 0.9536
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-1024000-1280000
[INFO] processing batch 1280000-1536000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:61506 (24.02578%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.08394601119999999:0.00117%,0.0:0.00078%,0.0021789908:0.00039%,0.0021633145999999997:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.96719%,0.8139250565:21.03398%,0.8029830673999999:18.2%,0.8149336757:17.47969%,0.8137722355:17.31445%,0.8166299895999999:0.00078%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8685433095:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.0020936488:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79961%,1:18.20039%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.65156%,1:38.34844%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96602%,1:21.03398%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.20:[0:56.71836%,1:43.28164%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.51992%,1:17.48008%]
[INFO] ** dst-192.168.1.40:[0:81.79961%,1:18.20039%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99883%,1:0.00117%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79961%,1:18.20039%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65156%,1:38.34844%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68555%,1:17.31445%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0332%,1:25.9668%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96602%,1:21.03398%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5207%,1:17.4793%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80039%,1:18.19961%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.0379 - tp: 36654.0000 - fp: 24.0000 - tn: 767976.0000 - fn: 155346.0000 - accuracy: 0.8382 - precision: 0.9993 - recall: 0.1909 - auc: 0.9873 - val_loss: 0.4037 - val_tp: 51342.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 12658.0000 - val_accuracy: 0.9604 - val_precision: 1.0000 - val_recall: 0.8022 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-1280000-1536000
[INFO] processing batch 1536000-1792000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65533 (25.59883%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99258%,0.8139250565:21.06133%,0.8029830673999999:18.11328%,0.8149336757:17.46836%,0.8137722355:17.36289%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:99.99961%,Single Stage Single Point:0.00039%]
[INFO] ** orig-192.168.1.48:[1:99.99961%,0:0.00039%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00742%,1:25.99258%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53125%,1:17.46875%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88633%,1:18.11367%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.57578%,1:38.42422%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.93867%,1:21.06133%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64453%,1:43.35547%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53164%,1:17.46836%]
[INFO] ** dst-192.168.1.40:[0:81.88672%,1:18.11328%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00742%,1:25.99258%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53125%,1:17.46875%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88633%,1:18.11367%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.57578%,1:38.42422%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63711%,1:17.36289%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00781%,1:25.99219%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93867%,1:21.06133%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53203%,1:17.46797%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88672%,1:18.11328%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [255999.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([103785]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7779 - tp: 69404.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 122596.0000 - accuracy: 0.8723 - precision: 1.0000 - recall: 0.3615 - auc: 1.0000 - val_loss: 0.0692 - val_tp: 60530.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 3470.0000 - val_accuracy: 0.9892 - val_precision: 1.0000 - val_recall: 0.9458 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-1536000-1792000
[INFO] processing batch 1792000-2048000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:707 (0.27617%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.0:0.00391%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.13906%,0.8139250565:20.75586%,0.8029830673999999:18.23828%,0.8149336757:17.6168%,0.8137722355:17.2418%,0.0:0.00391%,0.8343113882:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:80.53203%,Single Stage Single Point:19.46797%]
[INFO] ** orig-192.168.1.48:[1:99.99688%,0:0.00312%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** i/f_name-eth1:[1:99.99609%,0:0.00391%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99688%,1:0.00312%]
[INFO] ** i/f_dir-outbound:[1:99.99688%,0:0.00312%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85938%,1:26.14062%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38203%,1:17.61797%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76133%,1:18.23867%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:62.00234%,1:37.99766%]
[INFO] ** src-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** dst-0:[0:99.99609%,1:0.00391%]
[INFO] ** dst-192.168.1.10:[0:79.24375%,1:20.75625%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61875%,1:43.38125%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38281%,1:17.61719%]
[INFO] ** dst-192.168.1.40:[0:81.76094%,1:18.23906%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99609%,1:0.00391%]
[INFO] ** proto-tcp:[1:99.99609%,0:0.00391%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99609%,1:0.00391%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85938%,1:26.14062%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38203%,1:17.61797%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76133%,1:18.23867%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.00234%,1:37.99766%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75859%,1:17.24141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86094%,1:26.13906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.24453%,1:20.75547%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.3832%,1:17.6168%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76211%,1:18.23789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255995, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 74088,  74092,  74093, ..., 255994, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.9460 - tp: 53884.0000 - fp: 15916.0000 - tn: 752084.0000 - fn: 138116.0000 - accuracy: 0.8395 - precision: 0.7720 - recall: 0.2806 - auc: 0.8902 - val_loss: 0.6739 - val_tp: 46686.0000 - val_fp: 4898.0000 - val_tn: 251102.0000 - val_fn: 17314.0000 - val_accuracy: 0.9306 - val_precision: 0.9050 - val_recall: 0.7295 - val_auc: 0.9432
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-1792000-2048000
[INFO] processing batch 2048000-2304000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:704 (0.275%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.0012540954:0.00039%]
[INFO] ** s_port:[0.834280824:26.12969%,0.8139250565:20.76406%,0.8029830673999999:18.24258%,0.8149336757:17.61289%,0.8137722355:17.24648%,0.0:0.00273%,0.8030136315999999:0.00039%,0.8431597286:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:80.35703%,Single Stage Single Point:19.64297%]
[INFO] ** orig-192.168.1.48:[1:99.99766%,0:0.00234%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99766%,1:0.00234%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86992%,1:26.13008%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38672%,1:17.61328%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.75703%,1:18.24297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.98945%,1:38.01055%]
[INFO] ** src-192.168.1.88:[0:99.99766%,1:0.00234%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.23594%,1:20.76406%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.62383%,1:43.37617%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38711%,1:17.61289%]
[INFO] ** dst-192.168.1.40:[0:81.75742%,1:18.24258%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86992%,1:26.13008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38672%,1:17.61328%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75703%,1:18.24297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98945%,1:38.01055%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75352%,1:17.24648%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.87109%,1:26.12891%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.23594%,1:20.76406%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38711%,1:17.61289%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75742%,1:18.24258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Google Chrome': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      7, ..., 140271, 140272, 140276]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.1543 - tp: 35008.0000 - fp: 12298.0000 - tn: 755702.0000 - fn: 156992.0000 - accuracy: 0.8237 - precision: 0.7400 - recall: 0.1823 - auc: 0.8929 - val_loss: 0.8794 - val_tp: 0.0000e+00 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 64000.0000 - val_accuracy: 0.8000 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-2048000-2304000
[INFO] processing batch 2304000-2560000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0348324999:0.00039%,0.0021633145999999997:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.11992%,0.8139250565:20.79062%,0.8029830673999999:18.25898%,0.8149336757:17.61406%,0.8137722355:17.21367%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0339568433:0.00039%,0.0818051226:0.00039%,0.0021089309:0.00039%,0.2528119078:0.00039%,0.1074484993:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88008%,1:26.11992%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.38594%,1:17.61406%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.74023%,1:18.25977%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.9957%,1:38.0043%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.20859%,1:20.79141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66641%,1:43.33359%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.38594%,1:17.61406%]
[INFO] ** dst-192.168.1.40:[0:81.74102%,1:18.25898%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88008%,1:26.11992%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38594%,1:17.61406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74023%,1:18.25977%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.9957%,1:38.0043%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78633%,1:17.21367%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88008%,1:26.11992%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20977%,1:20.79023%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38633%,1:17.61367%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74102%,1:18.25898%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-239.192.4.191': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8558 - tp: 72630.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 119370.0000 - accuracy: 0.8757 - precision: 1.0000 - recall: 0.3783 - auc: 1.0000 - val_loss: 0.7116 - val_tp: 0.0000e+00 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 64000.0000 - val_accuracy: 0.8000 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-2304000-2560000
[INFO] processing batch 2560000-2816000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65413 (25.55195%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.18945%,0.8139250565:20.77422%,0.8029830673999999:18.24023%,0.8149336757:17.56523%,0.8137722355:17.22891%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.80977%,1:26.19023%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43438%,1:17.56562%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.75938%,1:18.24062%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.99688%,1:38.00312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.22578%,1:20.77422%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.58125%,1:43.41875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.43438%,1:17.56562%]
[INFO] ** dst-192.168.1.40:[0:81.75938%,1:18.24062%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.80977%,1:26.19023%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43438%,1:17.56562%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75938%,1:18.24062%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.99688%,1:38.00312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.77109%,1:17.22891%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.81055%,1:26.18945%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22617%,1:20.77383%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43516%,1:17.56484%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75977%,1:18.24023%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7304 - tp: 95994.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 96006.0000 - accuracy: 0.9000 - precision: 1.0000 - recall: 0.5000 - auc: 1.0000 - val_loss: 0.4960 - val_tp: 63500.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 500.0000 - val_accuracy: 0.9984 - val_precision: 1.0000 - val_recall: 0.9922 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-2560000-2816000
[INFO] processing batch 2816000-3072000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.98984%,0.0:0.01016%]
[INFO] ** modbus_transaction_id:64676 (25.26406%)
[INFO] ** service:[0.7025755984000001:99.98984%,0.0:0.00742%,0.0297847659:0.00078%,0.08394601119999999:0.00078%,0.0021476384:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.15078%,0.8139250565:20.64023%,0.8029830673999999:18.33633%,0.8149336757:17.66367%,0.8137722355:17.19766%,0.0:0.00742%,0.0020936488:0.00078%,0.9715599976:0.00039%,0.8059172320999999:0.00039%,0.980989058:0.00039%,0.0818051226:0.00039%,0.8738156367000001:0.00039%,0.0290360046:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:74.09414%,Single Stage Single Point:25.90586%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99258%,1:0.00742%]
[INFO] ** i/f_name-eth1:[1:99.99258%,0:0.00742%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99297%,1:0.00703%]
[INFO] ** i/f_dir-outbound:[1:99.99297%,0:0.00703%]
[INFO] ** src-0:[0:99.99258%,1:0.00742%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.84883%,1:26.15117%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.33594%,1:17.66406%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.66367%,1:18.33633%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:62.16211%,1:37.83789%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99258%,1:0.00742%]
[INFO] ** dst-192.168.1.10:[0:79.35977%,1:20.64023%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65156%,1:43.34844%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.33633%,1:17.66367%]
[INFO] ** dst-192.168.1.40:[0:81.66328%,1:18.33672%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99258%,1:0.00742%]
[INFO] ** proto-tcp:[1:99.98984%,0:0.01016%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:99.99258%,1:0.00742%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98984%,0:0.01016%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99258%,1:0.00742%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.84883%,1:26.15117%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.33594%,1:17.66406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.66367%,1:18.33633%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.16211%,1:37.83789%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.98984%,1:0.01016%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9875%,1:0.0125%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.80273%,1:17.19727%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.84961%,1:26.15039%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.35977%,1:20.64023%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.33633%,1:17.66367%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.66406%,1:18.33594%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255995, 255996, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [189681.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 71814,  71815,  71818, ..., 255993, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9983 - tp: 74568.0000 - fp: 21680.0000 - tn: 746320.0000 - fn: 117432.0000 - accuracy: 0.8551 - precision: 0.7747 - recall: 0.3884 - auc: 0.8868 - val_loss: 1.0272 - val_tp: 40961.0000 - val_fp: 23039.0000 - val_tn: 232961.0000 - val_fn: 23039.0000 - val_accuracy: 0.8560 - val_precision: 0.6400 - val_recall: 0.6400 - val_auc: 0.9102
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-2816000-3072000
[INFO] processing batch 3072000-3328000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:54629 (21.33945%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00156%,0.0021633145999999997:0.00078%,0.0021476384:0.00078%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.14023%,0.8139250565:20.83086%,0.8029830673999999:18.17813%,0.8149336757:17.62773%,0.8137722355:17.21641%,0.0:0.00156%,0.8030136315999999:0.00078%,0.0021089309:0.00078%,0.0020936488:0.00078%,0.8343113882:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:76.36523%,Single Stage Single Point:23.63477%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8582%,1:26.1418%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.37188%,1:17.62812%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82109%,1:18.17891%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.95273%,1:38.04727%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:79.16914%,1:20.83086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64336%,1:43.35664%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.37188%,1:17.62812%]
[INFO] ** dst-192.168.1.40:[0:81.82148%,1:18.17852%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8582%,1:26.1418%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.37188%,1:17.62812%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82109%,1:18.17891%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.95273%,1:38.04727%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78359%,1:17.21641%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86016%,1:26.13984%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16914%,1:20.83086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.37266%,1:17.62734%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82188%,1:18.17813%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      6,      8, ..., 168921, 168922, 168923]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.0607 - tp: 65648.0000 - fp: 30251.0000 - tn: 737749.0000 - fn: 126352.0000 - accuracy: 0.8369 - precision: 0.6846 - recall: 0.3419 - auc: 0.8671 - val_loss: 0.6013 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-3072000-3328000
[INFO] processing batch 3328000-3584000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:48170 (18.81641%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.08391465880000001:0.00078%,0.0:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.125%,0.8139250565:20.73086%,0.8029830673999999:18.2793%,0.8149336757:17.60469%,0.8137722355:17.25391%,0.0:0.00078%,0.0818051226:0.00078%,0.0020936488:0.00039%,0.814841983:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.0021089309:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.87461%,1:26.12539%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.39492%,1:17.60508%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.72031%,1:18.27969%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:62.01523%,1:37.98477%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.26914%,1:20.73086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6207%,1:43.3793%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.39531%,1:17.60469%]
[INFO] ** dst-192.168.1.40:[0:81.7207%,1:18.2793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.87461%,1:26.12539%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.39492%,1:17.60508%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72031%,1:18.27969%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.01523%,1:37.98477%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74609%,1:17.25391%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.87539%,1:26.12461%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.26914%,1:20.73086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.39531%,1:17.60469%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7207%,1:18.2793%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 8, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.6563 - tp: 95698.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 96302.0000 - accuracy: 0.8997 - precision: 1.0000 - recall: 0.4984 - auc: 1.0000 - val_loss: 0.4952 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-3328000-3584000
[INFO] processing batch 3584000-3840000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00273%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00117%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.11992%,0.8139250565:20.84648%,0.8029830673999999:18.15625%,0.8149336757:17.56992%,0.8137722355:17.30234%,0.6452258696000001:0.00156%,0.0:0.00117%,0.8059172320999999:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.87969%,1:26.12031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42969%,1:17.57031%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.84336%,1:18.15664%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85117%,1:38.14883%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.15352%,1:20.84648%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.57773%,1:43.42227%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43008%,1:17.56992%]
[INFO] ** dst-192.168.1.40:[0:81.84219%,1:18.15781%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.87969%,1:26.12031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42969%,1:17.57031%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84336%,1:18.15664%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85117%,1:38.14883%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69766%,1:17.30234%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88086%,1:26.11914%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15352%,1:20.84648%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43047%,1:17.56953%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84375%,1:18.15625%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 3, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.5786 - tp: 96055.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 95945.0000 - accuracy: 0.9001 - precision: 1.0000 - recall: 0.5003 - auc: 1.0000 - val_loss: 0.3597 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-3584000-3840000
[INFO] processing batch 3840000-4096000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.17852%,0.8139250565:20.77656%,0.8029830673999999:18.23789%,0.8149336757:17.56172%,0.8137722355:17.24063%,0.0:0.00117%,0.8711259856999999:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:81.93477%,Single Stage Single Point:18.06523%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8207%,1:26.1793%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76211%,1:18.23789%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.98281%,1:38.01719%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.22344%,1:20.77656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.58086%,1:43.41914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43789%,1:17.56211%]
[INFO] ** dst-192.168.1.40:[0:81.76133%,1:18.23867%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8207%,1:26.1793%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76211%,1:18.23789%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98281%,1:38.01719%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75977%,1:17.24023%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.82148%,1:26.17852%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22383%,1:20.77617%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43828%,1:17.56172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76211%,1:18.23789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([  2401,   2407,   2413, ..., 255980, 255989, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 12s - loss: 0.8393 - tp: 79286.0000 - fp: 17322.0000 - tn: 750678.0000 - fn: 112714.0000 - accuracy: 0.8645 - precision: 0.8207 - recall: 0.4129 - auc: 0.9148 - val_loss: 0.6908 - val_tp: 52219.0000 - val_fp: 11781.0000 - val_tn: 244219.0000 - val_fn: 11781.0000 - val_accuracy: 0.9264 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.9543
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-3840000-4096000
[INFO] processing batch 4096000-4352000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:58132 (22.70781%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08391465880000001:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.11641%,0.8139250565:20.75781%,0.8029830673999999:18.28242%,0.8149336757:17.6%,0.8137722355:17.24141%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:99.29219%,Single Stage Single Point:0.70781%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8832%,1:26.1168%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.39961%,1:17.60039%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:62.00078%,1:37.99922%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.24219%,1:20.75781%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6418%,1:43.3582%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4%,1:17.6%]
[INFO] ** dst-192.168.1.40:[0:81.71758%,1:18.28242%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8832%,1:26.1168%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.39961%,1:17.60039%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.00078%,1:37.99922%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75859%,1:17.24141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88438%,1:26.11562%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.24219%,1:20.75781%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.40039%,1:17.59961%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71758%,1:18.28242%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([   4,    7,   13, ..., 9894, 9903, 9905]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.5389 - tp: 95212.0000 - fp: 875.0000 - tn: 767125.0000 - fn: 96788.0000 - accuracy: 0.8983 - precision: 0.9909 - recall: 0.4959 - auc: 0.9957 - val_loss: 0.3378 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-4096000-4352000
[INFO] processing batch 4352000-4608000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:702 (0.27422%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00469%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:64698 (25.27266%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00234%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.14844%,0.8139250565:20.81289%,0.8029830673999999:18.23438%,0.8149336757:17.55586%,0.8137722355:17.24141%,0.0:0.00234%,0.6970474968000001:0.00156%,0.8166299895999999:0.00078%,0.8343113882:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_dir-outbound:[1:99.99766%,0:0.00234%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.44375%,1:17.55625%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76523%,1:18.23477%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.9457%,1:38.0543%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:79.18711%,1:20.81289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61016%,1:43.38984%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.44219%,1:17.55781%]
[INFO] ** dst-192.168.1.40:[0:81.76562%,1:18.23438%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44375%,1:17.55625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76523%,1:18.23477%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.9457%,1:38.0543%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99219%,1:0.00781%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75898%,1:17.24102%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85195%,1:26.14805%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.18711%,1:20.81289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44414%,1:17.55586%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76562%,1:18.23438%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 4, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.4764 - tp: 95971.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 96029.0000 - accuracy: 0.9000 - precision: 1.0000 - recall: 0.4998 - auc: 1.0000 - val_loss: 0.2267 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-4352000-4608000
[INFO] processing batch 4608000-4864000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99609%,0.0:0.00391%]
[INFO] ** modbus_transaction_id:54680 (21.35938%)
[INFO] ** service:[0.7025755984000001:99.99609%,0.0:0.00234%,0.0021789908:0.00078%,0.08391465880000001:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.11484%,0.8139250565:20.79258%,0.8029830673999999:18.24414%,0.8149336757:17.55781%,0.8137722355:17.28555%,0.0:0.00234%,0.8831377224:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:88.0668%,Single Stage Single Point:11.9332%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4418%,1:17.5582%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.75547%,1:18.24453%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.92188%,1:38.07812%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:79.20742%,1:20.79258%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.59961%,1:43.40039%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44219%,1:17.55781%]
[INFO] ** dst-192.168.1.40:[0:81.75547%,1:18.24453%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99609%,0:0.00391%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4418%,1:17.5582%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75547%,1:18.24453%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.92188%,1:38.07812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99609%,1:0.00391%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71445%,1:17.28555%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88555%,1:26.11445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20742%,1:20.79258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44219%,1:17.55781%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75586%,1:18.24414%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 71810,  71813,  71819, ..., 157065, 157071, 157072]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.7715 - tp: 80746.0000 - fp: 15340.0000 - tn: 752660.0000 - fn: 111254.0000 - accuracy: 0.8681 - precision: 0.8404 - recall: 0.4206 - auc: 0.9245 - val_loss: 0.3189 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-4608000-4864000
[INFO] processing batch 4864000-5120000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:57519 (22.46836%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.1043%,0.8139250565:20.84141%,0.8029830673999999:18.19336%,0.8149336757:17.55039%,0.8137722355:17.30859%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89492%,1:26.10508%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44961%,1:17.55039%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80586%,1:18.19414%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85%,1:38.15%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.15859%,1:20.84141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.58672%,1:43.41328%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44922%,1:17.55078%]
[INFO] ** dst-192.168.1.40:[0:81.80625%,1:18.19375%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89492%,1:26.10508%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44961%,1:17.55039%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80586%,1:18.19414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85%,1:38.15%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69141%,1:17.30859%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89609%,1:26.10391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15898%,1:20.84102%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.45039%,1:17.54961%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80664%,1:18.19336%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.4485 - tp: 95817.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 96183.0000 - accuracy: 0.8998 - precision: 1.0000 - recall: 0.4990 - auc: 1.0000 - val_loss: 0.2737 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-4864000-5120000
[INFO] processing batch 5120000-5376000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:62100 (24.25781%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.0957%,0.8139250565:20.8875%,0.8029830673999999:18.22148%,0.8149336757:17.5375%,0.8137722355:17.25469%,0.8059172320999999:0.00117%,0.814841983:0.00117%,0.8343113882:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90391%,1:26.09609%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.46133%,1:17.53867%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77852%,1:18.22148%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85781%,1:38.14219%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.1125%,1:20.8875%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64961%,1:43.35039%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4625%,1:17.5375%]
[INFO] ** dst-192.168.1.40:[0:81.77852%,1:18.22148%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90391%,1:26.09609%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.46133%,1:17.53867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77852%,1:18.22148%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85781%,1:38.14219%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7457%,1:17.2543%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90469%,1:26.09531%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.1125%,1:20.8875%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4625%,1:17.5375%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77891%,1:18.22109%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.4140 - tp: 95819.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 96181.0000 - accuracy: 0.8998 - precision: 1.0000 - recall: 0.4991 - auc: 1.0000 - val_loss: 0.2150 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-5120000-5376000
[INFO] processing batch 5376000-5632000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.16484%,0.8139250565:20.91719%,0.8029830673999999:18.13555%,0.8149336757:17.49727%,0.8137722355:17.28086%,0.0:0.00117%,0.8166299895999999:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.83437%,1:26.16562%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.50195%,1:17.49805%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86406%,1:18.13594%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.80195%,1:38.19805%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.08281%,1:20.91719%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.5543%,1:43.4457%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.50234%,1:17.49766%]
[INFO] ** dst-192.168.1.40:[0:81.86367%,1:18.13633%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.83437%,1:26.16562%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50195%,1:17.49805%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86406%,1:18.13594%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.80195%,1:38.19805%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71914%,1:17.28086%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.83555%,1:26.16445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.08281%,1:20.91719%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50273%,1:17.49727%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86445%,1:18.13555%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.3813 - tp: 138931.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 53069.0000 - accuracy: 0.9447 - precision: 1.0000 - recall: 0.7236 - auc: 1.0000 - val_loss: 0.1549 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-5376000-5632000
[INFO] processing batch 5632000-5888000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:704 (0.275%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.13164%,0.8139250565:20.83203%,0.8029830673999999:18.21758%,0.8149336757:17.55508%,0.8137722355:17.25898%,0.0:0.00273%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:85.86289%,Single Stage Single Point:14.13711%]
[INFO] ** orig-192.168.1.48:[1:99.99727%,0:0.00273%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86797%,1:26.13203%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44492%,1:17.55508%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.78164%,1:18.21836%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90898%,1:38.09102%]
[INFO] ** src-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.16797%,1:20.83203%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.60898%,1:43.39102%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44492%,1:17.55508%]
[INFO] ** dst-192.168.1.40:[0:81.78242%,1:18.21758%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86797%,1:26.13203%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44492%,1:17.55508%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.78164%,1:18.21836%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90898%,1:38.09102%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74102%,1:17.25898%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86875%,1:26.13125%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16797%,1:20.83203%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4457%,1:17.5543%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.78242%,1:18.21758%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 58699,  58701,  58705, ..., 159872, 159875, 159879]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.8036 - tp: 155809.0000 - fp: 36191.0000 - tn: 731809.0000 - fn: 36191.0000 - accuracy: 0.9246 - precision: 0.8115 - recall: 0.8115 - auc: 0.9115 - val_loss: 0.2473 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-5632000-5888000
[INFO] processing batch 5888000-6144000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99414%,0.0:0.00547%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:63474 (24.79453%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.08391465880000001:0.00117%,0.0021633145999999997:0.00078%,0.0021476384:0.00078%,0.0:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.09609%,0.8139250565:20.79141%,0.8029830673999999:18.28281%,0.8149336757:17.57773%,0.8137722355:17.2457%,0.705452656:0.00156%,0.0818051226:0.00117%,0.0021089309:0.00078%,0.0020936488:0.00078%,0.0:0.00078%,0.8345253376999999:0.00039%,0.0290360046:0.00039%,0.9842747112000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90352%,1:26.09648%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42227%,1:17.57773%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96289%,1:38.03711%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.20859%,1:20.79141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6582%,1:43.3418%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.42031%,1:17.57969%]
[INFO] ** dst-192.168.1.40:[0:81.71719%,1:18.28281%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99883%,1:0.00117%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.9957%,0:0.0043%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99414%,0:0.00586%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90352%,1:26.09648%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42227%,1:17.57773%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96289%,1:38.03711%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7543%,1:17.2457%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9043%,1:26.0957%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20859%,1:20.79141%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42227%,1:17.57773%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71719%,1:18.28281%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.3738 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2219 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-5888000-6144000
[INFO] processing batch 6144000-6400000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.09102%,0.8139250565:20.84219%,0.8029830673999999:18.28203%,0.8149336757:17.53047%,0.8137722355:17.25%,0.8059172320999999:0.00117%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8876612262000001:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:84.0875%,Single Stage Single Point:15.9125%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9082%,1:26.0918%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.46875%,1:17.53125%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90781%,1:38.09219%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.15781%,1:20.84219%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65859%,1:43.34141%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.46953%,1:17.53047%]
[INFO] ** dst-192.168.1.40:[0:81.71758%,1:18.28242%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9082%,1:26.0918%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.46875%,1:17.53125%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90781%,1:38.09219%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75039%,1:17.24961%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90938%,1:26.09062%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15781%,1:20.84219%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.46953%,1:17.53047%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71797%,1:18.28203%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([142218, 142219, 142225, ..., 255993, 255994, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.5570 - tp: 174156.0000 - fp: 17844.0000 - tn: 750156.0000 - fn: 17844.0000 - accuracy: 0.9628 - precision: 0.9071 - recall: 0.9071 - auc: 0.9574 - val_loss: 0.9862 - val_tp: 41108.0000 - val_fp: 22892.0000 - val_tn: 233108.0000 - val_fn: 22892.0000 - val_accuracy: 0.8569 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-6144000-6400000
[INFO] processing batch 6400000-6656000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.14219%,0.8139250565:20.80625%,0.8029830673999999:18.25117%,0.8149336757:17.57578%,0.8137722355:17.22266%,0.8166299895999999:0.00078%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:79.20547%,Single Stage Single Point:20.79453%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85781%,1:26.14219%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.42383%,1:17.57617%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74883%,1:18.25117%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97109%,1:38.02891%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.19375%,1:20.80625%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63516%,1:43.36484%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.42422%,1:17.57578%]
[INFO] ** dst-192.168.1.40:[0:81.74844%,1:18.25156%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85781%,1:26.14219%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42383%,1:17.57617%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74883%,1:18.25117%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97109%,1:38.02891%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.77734%,1:17.22266%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85781%,1:26.14219%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19414%,1:20.80586%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.425%,1:17.575%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74922%,1:18.25078%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      7, ..., 148577, 148583, 148584]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9211 - tp: 138766.0000 - fp: 53234.0000 - tn: 714766.0000 - fn: 53234.0000 - accuracy: 0.8891 - precision: 0.7227 - recall: 0.7227 - auc: 0.8762 - val_loss: 0.2620 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-6400000-6656000
[INFO] processing batch 6656000-6912000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65197 (25.46758%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.11367%,0.8139250565:20.77734%,0.8029830673999999:18.2707%,0.8149336757:17.58906%,0.8137722355:17.24609%,0.8030136315999999:0.00078%,0.8343113882:0.00078%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.72812%,1:18.27188%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97656%,1:38.02344%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.22266%,1:20.77734%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63984%,1:43.36016%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.41055%,1:17.58945%]
[INFO] ** dst-192.168.1.40:[0:81.7293%,1:18.2707%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72812%,1:18.27188%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97656%,1:38.02344%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75391%,1:17.24609%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88711%,1:26.11289%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22266%,1:20.77734%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41094%,1:17.58906%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7293%,1:18.2707%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3574 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2377 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-6656000-6912000
[INFO] processing batch 6912000-7168000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:59892 (23.39531%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.1043%,0.8139250565:20.79102%,0.8029830673999999:18.27422%,0.8149336757:17.5875%,0.8137722355:17.23945%,0.8059172320999999:0.00078%,0.8343113882:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8344030809:0.00039%]
[INFO] ** classification:[normal:99.99883%,Single Stage Single Point:0.00117%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89453%,1:26.10547%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4125%,1:17.5875%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.72539%,1:18.27461%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96953%,1:38.03047%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.20898%,1:20.79102%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65625%,1:43.34375%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4125%,1:17.5875%]
[INFO] ** dst-192.168.1.40:[0:81.72539%,1:18.27461%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89453%,1:26.10547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4125%,1:17.5875%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72539%,1:18.27461%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96953%,1:38.03047%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.76094%,1:17.23906%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89609%,1:26.10391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20898%,1:20.79102%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41328%,1:17.58672%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.72578%,1:18.27422%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [255997.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 90086, 134127, 239267]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.3329 - tp: 191998.0000 - fp: 2.0000 - tn: 767998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2030 - val_tp: 63999.0000 - val_fp: 1.0000 - val_tn: 255999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-6912000-7168000
[INFO] processing batch 7168000-7424000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:706 (0.27578%)
[INFO] ** modbus_function_code:[0.9743589744:99.99453%,0.0:0.00547%]
[INFO] ** modbus_transaction_id:64992 (25.3875%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0:0.0043%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.03359%,0.8139250565:20.78242%,0.8029830673999999:18.34414%,0.8149336757:17.58828%,0.8137722355:17.24375%,0.0:0.0043%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.9344397579000001:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:92.32148%,Single Stage Multi Point:7.67812%,Single Stage Single Point:0.00039%]
[INFO] ** orig-192.168.1.48:[1:99.9957%,0:0.0043%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.9957%,1:0.0043%]
[INFO] ** i/f_name-eth1:[1:99.9957%,0:0.0043%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.9957%,1:0.0043%]
[INFO] ** i/f_dir-outbound:[1:99.9957%,0:0.0043%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.96562%,1:26.03437%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.65586%,1:18.34414%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97383%,1:38.02617%]
[INFO] ** src-192.168.1.88:[0:99.99492%,1:0.00508%]
[INFO] ** dst-0:[0:99.9957%,1:0.0043%]
[INFO] ** dst-192.168.1.10:[0:79.21719%,1:20.78281%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.72266%,1:43.27734%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.41133%,1:17.58867%]
[INFO] ** dst-192.168.1.40:[0:81.65508%,1:18.34492%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.9957%,1:0.0043%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99453%,0:0.00547%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.9957%,1:0.0043%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.96562%,1:26.03437%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.65586%,1:18.34414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97383%,1:38.02617%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9918%,1:0.0082%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75625%,1:17.24375%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9668%,1:26.0332%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.21758%,1:20.78242%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41172%,1:17.58828%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.65586%,1:18.34414%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 3, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255993, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [236343.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([849]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([213902, 213904, 213905, ..., 255995, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 1.96560e+04 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 1.96560e+04 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 1.96560e+04 0.00000e+00 0.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3092 - tp: 191999.0000 - fp: 1.0000 - tn: 767999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4035 - val_tp: 44344.0000 - val_fp: 19656.0000 - val_tn: 236344.0000 - val_fn: 19656.0000 - val_accuracy: 0.8772 - val_precision: 0.6929 - val_recall: 0.6929 - val_auc: 0.7312
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-7168000-7424000
[INFO] processing batch 7424000-7680000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:706 (0.27578%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:59138 (23.10078%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00352%]
[INFO] ** s_port:[0.834280824:26.08906%,0.8139250565:20.78789%,0.8029830673999999:18.26367%,0.8149336757:17.61172%,0.8137722355:17.24219%,0.0:0.00352%,0.8059172320999999:0.00078%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:59.34414%,Single Stage Multi Point:40.65586%]
[INFO] ** orig-192.168.1.48:[1:99.99648%,0:0.00352%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** i/f_name-eth1:[1:99.99648%,0:0.00352%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99648%,1:0.00352%]
[INFO] ** i/f_dir-outbound:[1:99.99648%,0:0.00352%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.91055%,1:26.08945%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38789%,1:17.61211%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.73594%,1:18.26406%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96992%,1:38.03008%]
[INFO] ** src-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** dst-0:[0:99.99648%,1:0.00352%]
[INFO] ** dst-192.168.1.10:[0:79.21211%,1:20.78789%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66836%,1:43.33164%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38828%,1:17.61172%]
[INFO] ** dst-192.168.1.40:[0:81.73633%,1:18.26367%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99648%,1:0.00352%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99648%,1:0.00352%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.91055%,1:26.08945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38789%,1:17.61211%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.73594%,1:18.26406%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96992%,1:38.03008%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7582%,1:17.2418%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.91094%,1:26.08906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.2125%,1:20.7875%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38828%,1:17.61172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.73672%,1:18.26328%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([     1,      4,      5, ..., 222071, 222075, 222076]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0. 104079.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0. 104079.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0. 104079.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.9559 - tp: 102062.0000 - fp: 89938.0000 - tn: 678062.0000 - fn: 89938.0000 - accuracy: 0.8126 - precision: 0.5316 - recall: 0.5316 - auc: 0.6904 - val_loss: 0.9260 - val_tp: 49859.0000 - val_fp: 14141.0000 - val_tn: 241859.0000 - val_fn: 14141.0000 - val_accuracy: 0.9116 - val_precision: 0.7790 - val_recall: 0.7790 - val_auc: 0.8343
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-7424000-7680000
[INFO] processing batch 7680000-7936000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:698 (0.27266%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:63218 (24.69453%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.09844%,0.8139250565:20.80234%,0.8029830673999999:18.25859%,0.8149336757:17.5832%,0.8137722355:17.25547%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90078%,1:26.09922%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41641%,1:17.58359%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74102%,1:18.25898%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.94219%,1:38.05781%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.19727%,1:20.80273%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64609%,1:43.35391%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.41641%,1:17.58359%]
[INFO] ** dst-192.168.1.40:[0:81.74141%,1:18.25859%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90078%,1:26.09922%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41641%,1:17.58359%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74102%,1:18.25898%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.94219%,1:38.05781%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74453%,1:17.25547%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90234%,1:26.09766%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19766%,1:20.80234%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41758%,1:17.58242%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74141%,1:18.25859%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3337 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2531 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-7680000-7936000
[INFO] processing batch 7936000-8192000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99414%,0.0:0.00547%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.002116286:0.00117%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.14844%,0.8139250565:20.83828%,0.8029830673999999:18.2082%,0.8149336757:17.56406%,0.8137722355:17.2332%,0.8868054282:0.00156%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.7673146279999999:0.00039%,0.8345253376999999:0.00039%,0.0290360046:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.7788831836:0.00039%,0.8870957883:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.9156580476:0.00039%,0.8881655358:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43594%,1:17.56406%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79102%,1:18.20898%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.92852%,1:38.07148%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.16172%,1:20.83828%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61797%,1:43.38203%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.43555%,1:17.56445%]
[INFO] ** dst-192.168.1.40:[0:81.78984%,1:18.21016%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99414%,0:0.00586%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43594%,1:17.56406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79102%,1:18.20898%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.92852%,1:38.07148%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99102%,1:0.00898%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7668%,1:17.2332%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85156%,1:26.14844%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16211%,1:20.83789%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43672%,1:17.56328%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7918%,1:18.2082%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3119 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2246 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-7936000-8192000
[INFO] processing batch 8192000-8448000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65522 (25.59453%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.08555%,0.8139250565:20.85859%,0.8029830673999999:18.1793%,0.8149336757:17.63516%,0.8137722355:17.23984%,0.8059172320999999:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:87.94922%,Multi Stage Multi Point:12.05078%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.91406%,1:26.08594%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.36445%,1:17.63555%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90156%,1:38.09844%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.14141%,1:20.85859%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67461%,1:43.32539%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.36484%,1:17.63516%]
[INFO] ** dst-192.168.1.40:[0:81.8207%,1:18.1793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.91406%,1:26.08594%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.36445%,1:17.63555%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90156%,1:38.09844%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.76016%,1:17.23984%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.91484%,1:26.08516%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.14141%,1:20.85859%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.36484%,1:17.63516%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82109%,1:18.17891%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([ 25682,  25685,  25695, ..., 195376, 195386, 195390]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.  30850.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7240 - tp: 161781.0000 - fp: 30219.0000 - tn: 737781.0000 - fn: 30219.0000 - accuracy: 0.9370 - precision: 0.8426 - recall: 0.8426 - auc: 0.8968 - val_loss: 0.2467 - val_tp: 63369.0000 - val_fp: 631.0000 - val_tn: 255369.0000 - val_fn: 631.0000 - val_accuracy: 0.9961 - val_precision: 0.9901 - val_recall: 0.9901 - val_auc: 0.9951
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-8192000-8448000
[INFO] processing batch 8448000-8704000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:56456 (22.05313%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.002116286:0.00117%,0.0:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.10742%,0.8139250565:20.80391%,0.8029830673999999:18.28828%,0.8149336757:17.5793%,0.8137722355:17.21602%,0.8030136315999999:0.00078%,0.0:0.00078%,0.9104621309:0.00039%,0.8591448133:0.00039%,0.8916498562999999:0.00039%,0.7788831836:0.00039%,0.7891527599:0.00039%,0.8870957883:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:63.66172%,Multi Stage Multi Point:36.33828%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89219%,1:26.10781%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42031%,1:17.57969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71094%,1:18.28906%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.98008%,1:38.01992%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.19609%,1:20.80391%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67656%,1:43.32344%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.4207%,1:17.5793%]
[INFO] ** dst-192.168.1.40:[0:81.71172%,1:18.28828%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89219%,1:26.10781%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42031%,1:17.57969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71094%,1:18.28906%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98008%,1:38.01992%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78398%,1:17.21602%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89258%,1:26.10742%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19648%,1:20.80352%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42109%,1:17.57891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71211%,1:18.28789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([ 11294,  11295,  11297, ..., 255992, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.  93026.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.2182 - tp: 123282.0000 - fp: 68718.0000 - tn: 699282.0000 - fn: 68718.0000 - accuracy: 0.8568 - precision: 0.6421 - recall: 0.6421 - auc: 0.7754 - val_loss: 1.1673 - val_tp: 39692.0000 - val_fp: 24308.0000 - val_tn: 231692.0000 - val_fn: 24308.0000 - val_accuracy: 0.8481 - val_precision: 0.6202 - val_recall: 0.6202 - val_auc: 0.8101
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-8448000-8704000
[INFO] processing batch 8704000-8960000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:63796 (24.92031%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.09102%,0.8139250565:20.85859%,0.8029830673999999:18.25273%,0.8149336757:17.52617%,0.8137722355:17.26953%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:98.44844%,Multi Stage Multi Point:1.55156%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90742%,1:26.09258%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47383%,1:17.52617%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74688%,1:18.25312%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.87188%,1:38.12813%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.14141%,1:20.85859%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63906%,1:43.36094%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47344%,1:17.52656%]
[INFO] ** dst-192.168.1.40:[0:81.74688%,1:18.25312%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90742%,1:26.09258%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47383%,1:17.52617%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74688%,1:18.25312%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.87188%,1:38.12813%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.73086%,1:17.26914%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90977%,1:26.09023%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.14141%,1:20.85859%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47383%,1:17.52617%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74727%,1:18.25273%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([    4,     6,     9, ..., 10386, 10388, 10391]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.   3972.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3527 - tp: 188028.0000 - fp: 3972.0000 - tn: 764028.0000 - fn: 3972.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9875 - val_loss: 0.2307 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-8704000-8960000
[INFO] processing batch 8960000-9216000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.9957%,0.0:0.00391%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57363 (22.40742%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.07148%,0.8139250565:20.81289%,0.8029830673999999:18.23047%,0.8149336757:17.57383%,0.8137722355:17.30469%,0.7579772602:0.00156%,0.8059172320999999:0.00078%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.8262729995999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.0290360046:0.00039%,0.0020936488:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.92812%,1:26.07188%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42578%,1:17.57422%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76875%,1:18.23125%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.88242%,1:38.11758%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.18711%,1:20.81289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.62188%,1:43.37812%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.42617%,1:17.57383%]
[INFO] ** dst-192.168.1.40:[0:81.76914%,1:18.23086%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9957%,0:0.0043%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.92812%,1:26.07188%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42578%,1:17.57422%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76875%,1:18.23125%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.88242%,1:38.11758%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99609%,1:0.00391%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69531%,1:17.30469%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.92891%,1:26.07109%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.18711%,1:20.81289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42656%,1:17.57344%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76953%,1:18.23047%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 6, 'type-alert': 2, 'type-log': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2831 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2062 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-8960000-9216000
[INFO] processing batch 9216000-9472000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:61876 (24.17031%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.1332%,0.8139250565:20.83086%,0.8029830673999999:18.15234%,0.8149336757:17.59102%,0.8137722355:17.29141%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:72.04688%,Single Stage Multi Point:27.95312%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86602%,1:26.13398%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.40898%,1:17.59102%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.87773%,1:38.12227%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.16914%,1:20.83086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.57539%,1:43.42461%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.40859%,1:17.59141%]
[INFO] ** dst-192.168.1.40:[0:81.84766%,1:18.15234%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86602%,1:26.13398%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.40898%,1:17.59102%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.87773%,1:38.12227%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.70859%,1:17.29141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86719%,1:26.13281%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16953%,1:20.83047%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.40898%,1:17.59102%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84805%,1:18.15195%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([ 46464,  46465,  46466, ..., 163814, 163816, 163819]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.  71560.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.  71560.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.  71560.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.4353 - tp: 120440.0000 - fp: 71560.0000 - tn: 696440.0000 - fn: 71560.0000 - accuracy: 0.8509 - precision: 0.6273 - recall: 0.6273 - auc: 0.7650 - val_loss: 0.2406 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-9216000-9472000
[INFO] processing batch 9472000-9728000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00547%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.13047%,0.8139250565:20.83359%,0.8029830673999999:18.22422%,0.8149336757:17.54023%,0.8137722355:17.26289%,0.0:0.00547%,0.814841983:0.00078%,0.9715599976:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:83.99258%,Single Stage Multi Point:16.00742%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_name-eth1:[1:99.99453%,0:0.00547%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99453%,1:0.00547%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86875%,1:26.13125%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.45859%,1:17.54141%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77578%,1:18.22422%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.90352%,1:38.09648%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99453%,1:0.00547%]
[INFO] ** dst-192.168.1.10:[0:79.16641%,1:20.83359%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.60664%,1:43.39336%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.45977%,1:17.54023%]
[INFO] ** dst-192.168.1.40:[0:81.775%,1:18.225%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99453%,1:0.00547%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99453%,1:0.00547%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86875%,1:26.13125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.45859%,1:17.54141%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77578%,1:18.22422%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90352%,1:38.09648%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99023%,1:0.00977%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7375%,1:17.2625%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86992%,1:26.13008%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16641%,1:20.83359%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.46016%,1:17.53984%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77578%,1:18.22422%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([ 25270,  25279,  25287, ..., 249670, 249676, 249686]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.  40979.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.  40979.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.  40979.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7338 - tp: 161553.0000 - fp: 30447.0000 - tn: 737553.0000 - fn: 30447.0000 - accuracy: 0.9366 - precision: 0.8414 - recall: 0.8414 - auc: 0.9011 - val_loss: 0.6961 - val_tp: 53468.0000 - val_fp: 10532.0000 - val_tn: 245468.0000 - val_fn: 10532.0000 - val_accuracy: 0.9342 - val_precision: 0.8354 - val_recall: 0.8354 - val_auc: 0.8766
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-9472000-9728000
[INFO] processing batch 9728000-9984000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:63091 (24.64492%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.09727%,0.8139250565:20.87695%,0.8029830673999999:18.14492%,0.8149336757:17.58789%,0.8137722355:17.28906%,0.8030136315999999:0.00078%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90195%,1:26.09805%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41172%,1:17.58828%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85391%,1:18.14609%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.83398%,1:38.16602%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.12305%,1:20.87695%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61328%,1:43.38672%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.41172%,1:17.58828%]
[INFO] ** dst-192.168.1.40:[0:81.85508%,1:18.14492%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90195%,1:26.09805%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41172%,1:17.58828%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85391%,1:18.14609%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.83398%,1:38.16602%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71094%,1:17.28906%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90312%,1:26.09688%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.12344%,1:20.87656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4125%,1:17.5875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85508%,1:18.14492%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2852 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2282 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-9728000-9984000
[INFO] processing batch 9984000-10240000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:58560 (22.875%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.002116286:0.00117%,0.0012540954:0.00039%]
[INFO] ** s_port:[0.834280824:25.95625%,0.8139250565:21.02656%,0.8029830673999999:18.18047%,0.8149336757:17.49258%,0.8137722355:17.33984%,0.8059172320999999:0.00117%,0.8030136315999999:0.00039%,0.7918882572:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8985420868999999:0.00039%,0.9339660126:0.00039%,0.7788831836:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04258%,1:25.95742%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50742%,1:17.49258%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.81914%,1:18.18086%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.63359%,1:38.36641%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97344%,1:21.02656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70391%,1:43.29609%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50703%,1:17.49297%]
[INFO] ** dst-192.168.1.40:[0:81.81914%,1:18.18086%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04258%,1:25.95742%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50742%,1:17.49258%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.81914%,1:18.18086%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63359%,1:38.36641%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04453%,1:25.95547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97344%,1:21.02656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50781%,1:17.49219%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.81953%,1:18.18047%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.2649 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2046 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-9984000-10240000
[INFO] processing batch 10240000-10496000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0:0.00273%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.01641%,0.8139250565:20.95156%,0.8029830673999999:18.13867%,0.8149336757:17.55234%,0.8137722355:17.33281%,0.0:0.00273%,0.7414573018:0.00156%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.8935448376999999:0.00039%,0.0290360046:0.00039%,0.0020936488:0.00039%]
[INFO] ** classification:[normal:87.29883%,Multi Stage Single Point:12.70117%]
[INFO] ** orig-192.168.1.48:[1:99.99727%,0:0.00273%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.98359%,1:26.01641%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44687%,1:17.55313%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86094%,1:18.13906%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.71562%,1:38.28437%]
[INFO] ** src-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.04688%,1:20.95312%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65078%,1:43.34922%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.44766%,1:17.55234%]
[INFO] ** dst-192.168.1.40:[0:81.86133%,1:18.13867%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99453%,0:0.00547%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.98359%,1:26.01641%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44687%,1:17.55313%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86094%,1:18.13906%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.71562%,1:38.28437%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99102%,1:0.00898%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66719%,1:17.33281%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98359%,1:26.01641%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.04883%,1:20.95117%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44766%,1:17.55234%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86172%,1:18.13828%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [223485.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [223485.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [223485.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([186683, 186685, 186690, ..., 255994, 255995, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [223485.      0.      0.  32515.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [223485.      0.      0.  32515.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2948 - tp: 189510.0000 - fp: 2490.0000 - tn: 765510.0000 - fn: 2490.0000 - accuracy: 0.9948 - precision: 0.9870 - recall: 0.9870 - auc: 0.9894 - val_loss: 1.9533 - val_tp: 33975.0000 - val_fp: 30025.0000 - val_tn: 225975.0000 - val_fn: 30025.0000 - val_accuracy: 0.8123 - val_precision: 0.5309 - val_recall: 0.5309 - val_auc: 0.5308
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-10240000-10496000
[INFO] processing batch 10496000-10752000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:705 (0.27539%)
[INFO] ** modbus_function_code:[0.9743589744:99.99219%,0.0:0.00781%]
[INFO] ** modbus_transaction_id:60618 (23.67891%)
[INFO] ** service:[0.7025755984000001:99.99219%,0.0:0.00664%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.97539%,0.8139250565:21.02148%,0.8029830673999999:18.08672%,0.8149336757:17.56211%,0.8137722355:17.34375%,0.0:0.00664%,0.9004676325:0.00078%,0.8343113882:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:53.00195%,Multi Stage Single Point:46.99805%]
[INFO] ** orig-192.168.1.48:[1:99.99492%,0:0.00508%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99766%,1:0.00234%]
[INFO] ** type-log:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_name-eth1:[1:99.99336%,0:0.00664%]
[INFO] ** i/f_name-geod daemon:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-inbound:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_dir-outbound:[1:99.99375%,0:0.00625%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02344%,1:25.97656%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.63477%,1:38.36523%]
[INFO] ** src-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** dst-0:[0:99.99336%,1:0.00664%]
[INFO] ** dst-192.168.1.10:[0:78.97852%,1:21.02148%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.68086%,1:43.31914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43789%,1:17.56211%]
[INFO] ** dst-192.168.1.40:[0:81.9125%,1:18.0875%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99336%,1:0.00664%]
[INFO] ** proto-tcp:[1:99.99297%,0:0.00703%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99336%,1:0.00664%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99219%,0:0.00781%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99336%,1:0.00664%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02344%,1:25.97656%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63477%,1:38.36523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99219%,1:0.00781%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98828%,1:0.01172%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65625%,1:17.34375%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02539%,1:25.97461%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97852%,1:21.02148%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43828%,1:17.56172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91328%,1:18.08672%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_name-geod daemon': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      4,      5, ..., 255995, 255996, 255997]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [135685.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [135685.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [135685.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     0,      1,      3, ..., 255992, 255998, 255999]),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [135685.      0.      0. 120315.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [135685.      0.      0. 120315.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.8879 - tp: 101670.0000 - fp: 90330.0000 - tn: 677670.0000 - fn: 90330.0000 - accuracy: 0.8118 - precision: 0.5295 - recall: 0.5295 - auc: 0.6206 - val_loss: 1.7014 - val_tp: 34015.0000 - val_fp: 29985.0000 - val_tn: 226015.0000 - val_fn: 29985.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.5315
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-10496000-10752000
[INFO] processing batch 10752000-11008000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:702 (0.27422%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00508%]
[INFO] ** modbus_transaction_id:49732 (19.42656%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0:0.00469%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.95898%,0.8139250565:21.05586%,0.8029830673999999:18.11641%,0.8149336757:17.46875%,0.8137722355:17.39375%,0.0:0.00469%,0.0818051226:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:61.98516%,Multi Stage Single Point:38.01484%]
[INFO] ** orig-192.168.1.48:[1:99.99648%,0:0.00352%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_name-eth1:[1:99.99531%,0:0.00469%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04023%,1:25.95977%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53086%,1:17.46914%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55039%,1:38.44961%]
[INFO] ** src-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** dst-0:[0:99.99531%,1:0.00469%]
[INFO] ** dst-192.168.1.10:[0:78.94414%,1:21.05586%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64727%,1:43.35273%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53086%,1:17.46914%]
[INFO] ** dst-192.168.1.40:[0:81.88359%,1:18.11641%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99531%,1:0.00469%]
[INFO] ** proto-tcp:[1:99.99492%,0:0.00508%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99531%,1:0.00469%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99531%,1:0.00469%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04023%,1:25.95977%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53086%,1:17.46914%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55039%,1:38.44961%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99492%,1:0.00508%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60625%,1:17.39375%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04102%,1:25.95898%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94453%,1:21.05547%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53164%,1:17.46836%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88398%,1:18.11602%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      5,      6, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     0,      1,      3, ..., 206898, 206899, 206901]),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.  97318.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.  97318.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 1.6417 - tp: 101693.0000 - fp: 90307.0000 - tn: 677693.0000 - fn: 90307.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.6470 - val_loss: 0.5762 - val_tp: 56989.0000 - val_fp: 7011.0000 - val_tn: 248989.0000 - val_fn: 7011.0000 - val_accuracy: 0.9562 - val_precision: 0.8905 - val_recall: 0.8905 - val_auc: 0.8905
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-10752000-11008000
[INFO] processing batch 11008000-11264000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:46761 (18.26602%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.97266%,0.8139250565:21.02031%,0.8029830673999999:18.12383%,0.8149336757:17.52305%,0.8137722355:17.35781%,0.8059172320999999:0.00117%,0.8030136315999999:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02734%,1:25.97266%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47695%,1:17.52305%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87539%,1:18.12461%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.62188%,1:38.37813%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.97969%,1:21.02031%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66914%,1:43.33086%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47695%,1:17.52305%]
[INFO] ** dst-192.168.1.40:[0:81.87617%,1:18.12383%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02734%,1:25.97266%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47695%,1:17.52305%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87539%,1:18.12461%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.62188%,1:38.37813%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64258%,1:17.35742%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02773%,1:25.97227%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97969%,1:21.02031%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47695%,1:17.52305%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87617%,1:18.12383%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 12s - loss: 0.3025 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2700 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-11008000-11264000
[INFO] processing batch 11264000-11520000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:56871 (22.21523%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00078%]
[INFO] ** s_port:[0.834280824:26.01133%,0.8139250565:20.98555%,0.8029830673999999:18.14258%,0.8149336757:17.52539%,0.8137722355:17.33125%,0.8166299895999999:0.00078%,0.8147502904:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9875%,1:26.0125%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.47344%,1:17.52656%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85703%,1:18.14297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.6832%,1:38.3168%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.01406%,1:20.98594%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65742%,1:43.34258%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47422%,1:17.52578%]
[INFO] ** dst-192.168.1.40:[0:81.85625%,1:18.14375%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9875%,1:26.0125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47344%,1:17.52656%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85703%,1:18.14297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.6832%,1:38.3168%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00195%,0:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66914%,1:17.33086%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98906%,1:26.01094%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01445%,1:20.98555%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.475%,1:17.525%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85742%,1:18.14258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2793 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2429 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-11264000-11520000
[INFO] processing batch 11520000-11776000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.98789%,0.0:0.01094%,0.9871794872:0.00039%,1.0:0.00039%,0.9615384615000001:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99023%,0.0:0.00586%,0.0021633145999999997:0.00117%,0.0297847659:0.00078%,0.08394601119999999:0.00078%,0.08391465880000001:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.95625%,0.8139250565:21.00703%,0.8029830673999999:18.13984%,0.8149336757:17.50117%,0.8137722355:17.38242%,0.0:0.00586%,0.7077908184999999:0.00156%,0.0021089309:0.00117%,0.45597224770000006:0.00078%,0.0818051226:0.00078%,0.8343113882:0.00039%,0.814841983:0.00039%,0.9034629256000001:0.00039%,0.9715599976:0.00039%,0.0020936488:0.00039%,0.0290360046:0.00039%,0.8059172320999999:0.00039%,0.9535729568000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99922%,1:0.00078%]
[INFO] ** type-control:[0:99.99883%,1:0.00117%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** i/f_name-eth1:[1:99.99414%,0:0.00586%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_dir-outbound:[1:99.99453%,0:0.00547%]
[INFO] ** src-0:[0:99.99414%,1:0.00586%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04336%,1:25.95664%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49844%,1:17.50156%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86016%,1:18.13984%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.61055%,1:38.38945%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99414%,1:0.00586%]
[INFO] ** dst-192.168.1.10:[0:78.99297%,1:21.00703%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66133%,1:43.33867%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.49648%,1:17.50352%]
[INFO] ** dst-192.168.1.40:[0:81.86016%,1:18.13984%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99414%,1:0.00586%]
[INFO] ** proto-tcp:[1:99.99023%,0:0.00977%]
[INFO] ** proto-udp:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** appi_name-CIP_func75:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98789%,0:0.01211%]
[INFO] ** appi_name-CIP_write_tag_service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99414%,1:0.00586%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04336%,1:25.95664%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49844%,1:17.50156%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86016%,1:18.13984%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.61055%,1:38.38945%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.98906%,1:0.01094%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00664%,1:49.99336%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Write Tag Service:[0:99.99961%,1:0.00039%]
[INFO] ** scada_tag-0:[0:99.98594%,1:0.01406%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61758%,1:17.38242%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04414%,1:25.95586%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.99297%,1:21.00703%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49883%,1:17.50117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86055%,1:18.13945%]
[INFO] columns with count within 2-10 {'modbus_function_code': 5, 'service': 7, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_func75': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-CIP_write_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'modbus_function_description-Unknown Function Code': 2, 'modbus_function_description-Write Tag Service': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2567 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2194 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-11520000-11776000
[INFO] processing batch 11776000-12032000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:65188 (25.46406%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00156%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.99336%,0.8139250565:21.06289%,0.8029830673999999:18.05547%,0.8149336757:17.50742%,0.8137722355:17.37539%,0.0:0.00156%,0.8059172320999999:0.00078%,0.905082829:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:77.16641%,Multi Stage Single Point:22.83359%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00547%,1:25.99453%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49219%,1:17.50781%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.94414%,1:18.05586%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.56172%,1:38.43828%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:78.93711%,1:21.06289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.63125%,1:43.36875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49219%,1:17.50781%]
[INFO] ** dst-192.168.1.40:[0:81.94414%,1:18.05586%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00547%,1:25.99453%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49219%,1:17.50781%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.94414%,1:18.05586%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56172%,1:38.43828%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62461%,1:17.37539%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00664%,1:25.99336%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93711%,1:21.06289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49336%,1:17.50664%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.94453%,1:18.05547%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [197546.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [197546.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [197546.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([ 91957,  91958,  91961, ..., 255989, 255993, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [197546.      0.      0.  58454.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [197546.      0.      0.  58454.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7829 - tp: 156412.0000 - fp: 35588.0000 - tn: 732412.0000 - fn: 35588.0000 - accuracy: 0.9259 - precision: 0.8146 - recall: 0.8146 - auc: 0.8772 - val_loss: 1.2408 - val_tp: 41134.0000 - val_fp: 22866.0000 - val_tn: 233134.0000 - val_fn: 22866.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.7320
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-11776000-12032000
[INFO] processing batch 12032000-12288000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00508%]
[INFO] ** modbus_transaction_id:62510 (24.41797%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0208806885:0.00156%,0.0021476384:0.00117%,0.0:0.00078%,0.08394601119999999:0.00039%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.95039%,0.8139250565:21.01641%,0.8029830673999999:18.12734%,0.8149336757:17.51797%,0.8137722355:17.38125%,0.0020936488:0.00117%,0.0:0.00078%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.8147502904:0.00039%,0.8059172320999999:0.00039%,0.8876612262000001:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.8030136315999999:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:64.35391%,Multi Stage Single Point:35.64609%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04961%,1:25.95039%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.48164%,1:17.51836%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87188%,1:18.12812%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.60234%,1:38.39766%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.98359%,1:21.01641%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66797%,1:43.33203%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.48203%,1:17.51797%]
[INFO] ** dst-192.168.1.40:[0:81.87227%,1:18.12773%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04961%,1:25.95039%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48164%,1:17.51836%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87188%,1:18.12812%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.60234%,1:38.39766%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99492%,1:0.00508%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9918%,1:0.0082%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61914%,1:17.38086%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.05039%,1:25.94961%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.98398%,1:21.01602%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.48203%,1:17.51797%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87266%,1:18.12734%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 8, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     4,      5,      7, ..., 255993, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.  91254.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.  91254.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.2302 - tp: 123527.0000 - fp: 68473.0000 - tn: 699527.0000 - fn: 68473.0000 - accuracy: 0.8573 - precision: 0.6434 - recall: 0.6434 - auc: 0.7909 - val_loss: 1.1724 - val_tp: 41219.0000 - val_fp: 22781.0000 - val_tn: 233219.0000 - val_fn: 22781.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.8665
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-12032000-12288000
[INFO] processing batch 12288000-12544000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:61654 (24.08359%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00117%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.93789%,0.8139250565:21.06484%,0.8029830673999999:18.15703%,0.8149336757:17.45625%,0.8137722355:17.3793%,0.814841983:0.00117%,0.0:0.00117%,0.2528119078:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.8465523565:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.38594%,Multi Stage Single Point:28.27344%,Single Stage Single Point:7.34063%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06133%,1:25.93867%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54258%,1:17.45742%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55586%,1:38.44414%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.93438%,1:21.06562%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68281%,1:43.31719%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54336%,1:17.45664%]
[INFO] ** dst-192.168.1.40:[0:81.84297%,1:18.15703%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06133%,1:25.93867%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54258%,1:17.45742%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55586%,1:38.44414%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6207%,1:17.3793%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06211%,1:25.93789%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93516%,1:21.06484%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54375%,1:17.45625%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84336%,1:18.15664%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 3, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([203060, 203067, 203071, ..., 255992, 255993, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     1,      2,      5, ..., 203055, 203056, 203057]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.  72380.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.  72380.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.1608 - tp: 123560.0000 - fp: 68440.0000 - tn: 699560.0000 - fn: 68440.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.8131 - val_loss: 1.1587 - val_tp: 41268.0000 - val_fp: 22732.0000 - val_tn: 233268.0000 - val_fn: 22732.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.8378
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-12288000-12544000
[INFO] processing batch 12544000-12800000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:63248 (24.70625%)
[INFO] ** service:[0.7025755984000001:99.99805%,0.002116286:0.00117%,0.0012540954:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.9293%,0.8139250565:21.08945%,0.8029830673999999:18.1125%,0.8149336757:17.48984%,0.8137722355:17.37539%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.9802707989:0.00039%,0.9054801638:0.00039%,0.9502261752:0.00039%,0.7788831836:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.39727%,Single Stage Single Point:35.60273%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06992%,1:25.93008%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.51016%,1:17.48984%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88711%,1:18.11289%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.53516%,1:38.46484%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91055%,1:21.08945%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69492%,1:43.30508%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.51016%,1:17.48984%]
[INFO] ** dst-192.168.1.40:[0:81.88711%,1:18.11289%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06992%,1:25.93008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51016%,1:17.48984%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88711%,1:18.11289%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.53516%,1:38.46484%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62461%,1:17.37539%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.07148%,1:25.92852%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91055%,1:21.08945%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51055%,1:17.48945%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8875%,1:18.1125%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      4,      5, ..., 255992, 255994, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.1654 - tp: 123588.0000 - fp: 68412.0000 - tn: 699588.0000 - fn: 68412.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.8046 - val_loss: 1.1285 - val_tp: 41269.0000 - val_fp: 22731.0000 - val_tn: 233269.0000 - val_fn: 22731.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.8668
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-12544000-12800000
[INFO] processing batch 12800000-13056000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:59778 (23.35078%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0:0.00078%]
[INFO] ** s_port:[0.834280824:25.93711%,0.8139250565:21.04336%,0.8029830673999999:18.1625%,0.8149336757:17.49609%,0.8137722355:17.35859%,0.8059172320999999:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:64.34062%,Single Stage Single Point:35.65937%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0625%,1:25.9375%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.83711%,1:18.16289%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.59805%,1:38.40195%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.95664%,1:21.04336%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.7043%,1:43.2957%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50352%,1:17.49648%]
[INFO] ** dst-192.168.1.40:[0:81.8375%,1:18.1625%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0625%,1:25.9375%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.83711%,1:18.16289%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59805%,1:38.40195%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6418%,1:17.3582%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06289%,1:25.93711%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95664%,1:21.04336%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50391%,1:17.49609%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8375%,1:18.1625%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      4, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164712.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      6, ..., 255990, 255992, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 1.1198 - tp: 123531.0000 - fp: 68469.0000 - tn: 699531.0000 - fn: 68469.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.8424 - val_loss: 1.0900 - val_tp: 41181.0000 - val_fp: 22819.0000 - val_tn: 233181.0000 - val_fn: 22819.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-12800000-13056000
[INFO] processing batch 13056000-13312000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:59589 (23.27695%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.92344%,0.8139250565:21.10312%,0.8029830673999999:18.15703%,0.8149336757:17.46484%,0.8137722355:17.34961%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:64.37773%,Single Stage Single Point:35.62227%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.07578%,1:25.92422%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53477%,1:17.46523%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54727%,1:38.45273%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.89687%,1:21.10312%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.72695%,1:43.27305%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53516%,1:17.46484%]
[INFO] ** dst-192.168.1.40:[0:81.84219%,1:18.15781%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.07578%,1:25.92422%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53477%,1:17.46523%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54727%,1:38.45273%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00156%,0:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65039%,1:17.34961%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.07695%,1:25.92305%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.89727%,1:21.10273%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53555%,1:17.46445%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84336%,1:18.15664%]
[INFO] columns with count within 2-10 {'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      6, ..., 255992, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.0792 - tp: 123615.0000 - fp: 68385.0000 - tn: 699615.0000 - fn: 68385.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.8744 - val_loss: 1.0545 - val_tp: 41192.0000 - val_fp: 22808.0000 - val_tn: 233192.0000 - val_fn: 22808.0000 - val_accuracy: 0.8575 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-13056000-13312000
[INFO] processing batch 13312000-13568000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99062%,0.0:0.00938%]
[INFO] ** modbus_transaction_id:59423 (23.21211%)
[INFO] ** service:[0.7025755984000001:99.99062%,0.0208806885:0.00156%,0.002116286:0.00156%,0.0021476384:0.00156%,0.0021633145999999997:0.00117%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.09248953609999999:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.96484%,0.8139250565:20.99258%,0.8029830673999999:18.22031%,0.8149336757:17.47617%,0.8137722355:17.33555%,0.0020936488:0.00156%,0.0:0.00117%,0.0021089309:0.00117%,0.814841983:0.00078%,0.9502261752:0.00039%,0.9834647595:0.00039%,0.8030441959000001:0.00039%,0.7788831836:0.00039%,0.8465523565:0.00039%,0.9715599976:0.00039%,0.9054801638:0.00039%,0.9802707989:0.00039%,0.8411730545999999:0.00039%,0.15240846019999998:0.00039%,0.0818051226:0.00039%,0.15243902439999998:0.00039%,0.9344397579000001:0.00039%,0.315972859:0.00039%,0.9535729568000001:0.00039%]
[INFO] ** classification:[normal:64.30313%,Single Stage Single Point:35.69688%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03516%,1:25.96484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52305%,1:17.47695%]
[INFO] ** src-192.168.1.200:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.7793%,1:18.2207%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** src-192.168.1.88:[0:99.99844%,1:0.00156%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.00742%,1:20.99258%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69922%,1:43.30078%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.255:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.30:[0:82.52383%,1:17.47617%]
[INFO] ** dst-192.168.1.40:[0:81.77969%,1:18.22031%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99453%,0:0.00547%]
[INFO] ** proto-udp:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99062%,0:0.00938%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03516%,1:25.96484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52305%,1:17.47695%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.7793%,1:18.2207%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-0:[0:99.99062%,1:0.00938%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98867%,1:0.01133%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66445%,1:17.33555%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03555%,1:25.96445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.00742%,1:20.99258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52422%,1:17.47578%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77969%,1:18.22031%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255994, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164616.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      5,      7, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.0477 - tp: 123437.0000 - fp: 68563.0000 - tn: 699437.0000 - fn: 68563.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.8883 - val_loss: 1.0242 - val_tp: 41179.0000 - val_fp: 22821.0000 - val_tn: 233179.0000 - val_fn: 22821.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-13312000-13568000
[INFO] processing batch 13568000-13824000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:65533 (25.59883%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.08394601119999999:0.00195%,0.0208806885:0.00039%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.93906%,0.8139250565:21.07109%,0.8029830673999999:18.15859%,0.8149336757:17.48516%,0.8137722355:17.3418%,0.8166299895999999:0.00156%,0.8059172320999999:0.00039%,0.7593068036:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.35586%,Single Stage Single Point:35.64414%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06055%,1:25.93945%]
[INFO] ** src-192.168.1.134:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.20:[0:82.51484%,1:17.48516%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84141%,1:18.15859%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58711%,1:38.41289%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.92891%,1:21.07109%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71914%,1:43.28086%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.51445%,1:17.48555%]
[INFO] ** dst-192.168.1.40:[0:81.84141%,1:18.15859%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99805%,1:0.00195%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06055%,1:25.93945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51484%,1:17.48516%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84141%,1:18.15859%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58711%,1:38.41289%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65859%,1:17.34141%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06133%,1:25.93867%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92891%,1:21.07109%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51484%,1:17.48516%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84141%,1:18.15859%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255994, 255996, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164751.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      4,      7, ..., 255995, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.0168 - tp: 123539.0000 - fp: 68461.0000 - tn: 699539.0000 - fn: 68461.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9076 - val_loss: 0.9960 - val_tp: 41212.0000 - val_fp: 22788.0000 - val_tn: 233212.0000 - val_fn: 22788.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-13568000-13824000
[INFO] processing batch 13824000-14080000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.95586%,0.8139250565:21.03906%,0.8029830673999999:18.17891%,0.8149336757:17.47344%,0.8137722355:17.35%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.34727%,Single Stage Single Point:35.65273%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04414%,1:25.95586%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52578%,1:17.47422%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.61094%,1:38.38906%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96094%,1:21.03906%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69414%,1:43.30586%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.52656%,1:17.47344%]
[INFO] ** dst-192.168.1.40:[0:81.8207%,1:18.1793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04414%,1:25.95586%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52578%,1:17.47422%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.61094%,1:38.38906%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65%,1:17.35%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04453%,1:25.95547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96133%,1:21.03867%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52695%,1:17.47305%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82148%,1:18.17852%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      5, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      4, ..., 255992, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9903 - tp: 123556.0000 - fp: 68444.0000 - tn: 699556.0000 - fn: 68444.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.9111 - val_loss: 0.9725 - val_tp: 41173.0000 - val_fp: 22827.0000 - val_tn: 233173.0000 - val_fn: 22827.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-13824000-14080000
[INFO] processing batch 14080000-14336000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:62632 (24.46562%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.09248953609999999:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.93789%,0.8139250565:21.06602%,0.8029830673999999:18.12578%,0.8149336757:17.45859%,0.8137722355:17.40898%,0.8343113882:0.00078%,0.8345253376999999:0.00039%,0.1074484993:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.41484%,Single Stage Single Point:35.58516%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.54141%,1:17.45859%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87383%,1:18.12617%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.525%,1:38.475%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.93359%,1:21.06641%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65273%,1:43.34727%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54102%,1:17.45898%]
[INFO] ** dst-192.168.1.40:[0:81.87422%,1:18.12578%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54141%,1:17.45859%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87383%,1:18.12617%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.525%,1:38.475%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.59102%,1:17.40898%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0625%,1:25.9375%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93398%,1:21.06602%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5418%,1:17.4582%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87422%,1:18.12578%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - success': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      6, ..., 255993, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9660 - tp: 123681.0000 - fp: 68319.0000 - tn: 699681.0000 - fn: 68319.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9109 - val_loss: 0.9489 - val_tp: 41221.0000 - val_fp: 22779.0000 - val_tn: 233221.0000 - val_fn: 22779.0000 - val_accuracy: 0.8576 - val_precision: 0.6441 - val_recall: 0.6441 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-14080000-14336000
[INFO] processing batch 14336000-14592000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:58803 (22.96992%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.99727%,0.8139250565:21.03086%,0.8029830673999999:18.15469%,0.8149336757:17.50117%,0.8137722355:17.31172%,0.0:0.00273%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%]
[INFO] ** classification:[normal:64.34375%,Single Stage Single Point:35.65625%]
[INFO] ** orig-192.168.1.48:[1:99.99883%,0:0.00117%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99844%,1:0.00156%]
[INFO] ** type-log:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00273%,1:25.99727%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.84492%,1:18.15508%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.65742%,1:38.34258%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:78.96914%,1:21.03086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69102%,1:43.30898%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49883%,1:17.50117%]
[INFO] ** dst-192.168.1.40:[0:81.84531%,1:18.15469%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00273%,1:25.99727%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84492%,1:18.15508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65742%,1:38.34258%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68867%,1:17.31133%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00273%,1:25.99727%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96914%,1:21.03086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49883%,1:17.50117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8457%,1:18.1543%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 's_port': 9, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255992, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9457 - tp: 123523.0000 - fp: 68477.0000 - tn: 699523.0000 - fn: 68477.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.9109 - val_loss: 0.9289 - val_tp: 41197.0000 - val_fp: 22803.0000 - val_tn: 233197.0000 - val_fn: 22803.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-14336000-14592000
[INFO] processing batch 14592000-14848000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:61358 (23.96797%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00078%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.98203%,0.8139250565:21.03906%,0.8029830673999999:18.13672%,0.8149336757:17.46211%,0.8137722355:17.37617%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.9344397579000001:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.4%,Single Stage Single Point:35.6%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01758%,1:25.98242%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.5375%,1:17.4625%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8625%,1:18.1375%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** src-192.168.1.88:[0:99.99844%,1:0.00156%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96055%,1:21.03945%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64141%,1:43.35859%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.5375%,1:17.4625%]
[INFO] ** dst-192.168.1.40:[0:81.86289%,1:18.13711%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01758%,1:25.98242%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.5375%,1:17.4625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8625%,1:18.1375%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62383%,1:17.37617%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01875%,1:25.98125%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96094%,1:21.03906%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53828%,1:17.46172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86328%,1:18.13672%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      7,      8, ..., 255989, 255993, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9247 - tp: 123652.0000 - fp: 68348.0000 - tn: 699652.0000 - fn: 68348.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9111 - val_loss: 0.9094 - val_tp: 41212.0000 - val_fp: 22788.0000 - val_tn: 233212.0000 - val_fn: 22788.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-14592000-14848000
[INFO] processing batch 14848000-15104000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:65530 (25.59766%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.01992%,0.8139250565:21.02656%,0.8029830673999999:18.12148%,0.8149336757:17.50391%,0.8137722355:17.32656%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.37461%,Single Stage Single Point:35.62539%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9793%,1:26.0207%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4957%,1:17.5043%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87852%,1:18.12148%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.64688%,1:38.35312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97344%,1:21.02656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65352%,1:43.34648%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49609%,1:17.50391%]
[INFO] ** dst-192.168.1.40:[0:81.87812%,1:18.12188%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9793%,1:26.0207%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4957%,1:17.5043%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87852%,1:18.12148%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.64688%,1:38.35312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99805%,1:0.00195%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67344%,1:17.32656%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98008%,1:26.01992%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97344%,1:21.02656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49648%,1:17.50352%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87852%,1:18.12148%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     4,      5,      6, ..., 255996, 255997, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      1,      2, ..., 255990, 255992, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9069 - tp: 123594.0000 - fp: 68406.0000 - tn: 699594.0000 - fn: 68406.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9111 - val_loss: 0.8918 - val_tp: 41205.0000 - val_fp: 22795.0000 - val_tn: 233205.0000 - val_fn: 22795.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-14848000-15104000
[INFO] processing batch 15104000-15360000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:55201 (21.56289%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.9457%,0.8139250565:21.08125%,0.8029830673999999:18.10352%,0.8149336757:17.49609%,0.8137722355:17.37188%,0.8030136315999999:0.00078%,0.8059172320999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.39961%,Single Stage Single Point:35.60039%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05391%,1:25.94609%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8957%,1:18.1043%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54688%,1:38.45312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91875%,1:21.08125%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68242%,1:43.31758%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50391%,1:17.49609%]
[INFO] ** dst-192.168.1.40:[0:81.89648%,1:18.10352%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05391%,1:25.94609%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8957%,1:18.1043%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54688%,1:38.45312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62852%,1:17.37148%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.05508%,1:25.94492%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91914%,1:21.08086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50391%,1:17.49609%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.89688%,1:18.10313%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     3,      4,      5, ..., 255993, 255995, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164863.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      1,      2, ..., 255996, 255997, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8898 - tp: 123629.0000 - fp: 68371.0000 - tn: 699629.0000 - fn: 68371.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.8747 - val_tp: 41234.0000 - val_fp: 22766.0000 - val_tn: 233234.0000 - val_fn: 22766.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-15104000-15360000
[INFO] processing batch 15360000-15616000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:52006 (20.31484%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.96992%,0.8139250565:21.05938%,0.8029830673999999:18.11211%,0.8149336757:17.47383%,0.8137722355:17.38203%,0.814841983:0.00117%,0.8345253376999999:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.41328%,Single Stage Single Point:35.58672%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52461%,1:17.47539%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8875%,1:18.1125%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.94062%,1:21.05938%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64766%,1:43.35234%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.52578%,1:17.47422%]
[INFO] ** dst-192.168.1.40:[0:81.8875%,1:18.1125%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52461%,1:17.47539%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8875%,1:18.1125%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61797%,1:17.38203%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03008%,1:25.96992%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94062%,1:21.05938%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52656%,1:17.47344%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88789%,1:18.11211%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255995, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      7,      8, ..., 255993, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8740 - tp: 123632.0000 - fp: 68368.0000 - tn: 699632.0000 - fn: 68368.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.9112 - val_loss: 0.8586 - val_tp: 41266.0000 - val_fp: 22734.0000 - val_tn: 233266.0000 - val_fn: 22734.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-15360000-15616000
[INFO] processing batch 15616000-15872000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99258%,0.0:0.00742%]
[INFO] ** modbus_transaction_id:52095 (20.34961%)
[INFO] ** service:[0.7025755984000001:99.99258%,0.0:0.00625%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.95977%,0.8139250565:21.03828%,0.8029830673999999:18.20312%,0.8149336757:17.45156%,0.8137722355:17.33906%,0.0:0.00625%,0.9715599976:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.34531%,Single Stage Single Point:35.65469%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_name-eth1:[1:99.99375%,0:0.00625%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99414%,1:0.00586%]
[INFO] ** i/f_dir-outbound:[1:99.99414%,0:0.00586%]
[INFO] ** src-0:[0:99.99375%,1:0.00625%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03945%,1:25.96055%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54844%,1:17.45156%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79688%,1:18.20312%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.62266%,1:38.37734%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99375%,1:0.00625%]
[INFO] ** dst-192.168.1.10:[0:78.96172%,1:21.03828%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70117%,1:43.29883%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.54844%,1:17.45156%]
[INFO] ** dst-192.168.1.40:[0:81.79648%,1:18.20352%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99375%,1:0.00625%]
[INFO] ** proto-tcp:[1:99.99258%,0:0.00742%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99258%,0:0.00742%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99375%,1:0.00625%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03945%,1:25.96055%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54844%,1:17.45156%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79688%,1:18.20312%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.62266%,1:38.37734%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99258%,1:0.00742%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00391%,1:49.99609%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66094%,1:17.33906%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04063%,1:25.95938%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96211%,1:21.03789%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54883%,1:17.45117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79688%,1:18.20312%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      4, ..., 255996, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      5, ..., 255992, 255993, 255997]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8602 - tp: 123527.0000 - fp: 68473.0000 - tn: 699527.0000 - fn: 68473.0000 - accuracy: 0.8573 - precision: 0.6434 - recall: 0.6434 - auc: 0.9110 - val_loss: 0.8456 - val_tp: 41197.0000 - val_fp: 22803.0000 - val_tn: 233197.0000 - val_fn: 22803.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-15616000-15872000
[INFO] processing batch 15872000-16128000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:62931 (24.58242%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00078%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.97227%,0.8139250565:21.01094%,0.8029830673999999:18.15195%,0.8149336757:17.50937%,0.8137722355:17.35078%,0.8059172320999999:0.00117%,0.8030136315999999:0.00078%,0.0:0.00078%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.3375%,Single Stage Single Point:35.6625%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02695%,1:25.97305%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84727%,1:18.15273%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.63828%,1:38.36172%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.98906%,1:21.01094%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67695%,1:43.32305%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.49023%,1:17.50977%]
[INFO] ** dst-192.168.1.40:[0:81.84805%,1:18.15195%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02695%,1:25.97305%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84727%,1:18.15273%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63828%,1:38.36172%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64922%,1:17.35078%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02812%,1:25.97188%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.98906%,1:21.01094%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49062%,1:17.50937%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84844%,1:18.15156%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255995, 255997, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164704.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      6,      7, ..., 255994, 255996, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8468 - tp: 123531.0000 - fp: 68469.0000 - tn: 699531.0000 - fn: 68469.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9108 - val_loss: 0.8325 - val_tp: 41173.0000 - val_fp: 22827.0000 - val_tn: 233173.0000 - val_fn: 22827.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-15872000-16128000
[INFO] processing batch 16128000-16384000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00508%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0208806885:0.00156%,0.0:0.00156%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.96602%,0.8139250565:21.09766%,0.8029830673999999:18.07891%,0.8149336757:17.47734%,0.8137722355:17.37344%,0.0:0.00156%,0.0020936488:0.00078%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8147502904:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.8344030809:0.00039%,0.15243902439999998:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:64.44375%,Single Stage Single Point:35.55625%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0332%,1:25.9668%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52227%,1:17.47773%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.92109%,1:18.07891%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.52891%,1:38.47109%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:78.90234%,1:21.09766%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66055%,1:43.33945%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.52266%,1:17.47734%]
[INFO] ** dst-192.168.1.40:[0:81.92031%,1:18.07969%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0332%,1:25.9668%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52227%,1:17.47773%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.92109%,1:18.07891%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.52891%,1:38.47109%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99492%,1:0.00508%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62656%,1:17.37344%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03438%,1:25.96562%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90234%,1:21.09766%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52305%,1:17.47695%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.92109%,1:18.07891%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      7, ..., 255993, 255994, 255995]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8325 - tp: 123781.0000 - fp: 68219.0000 - tn: 699781.0000 - fn: 68219.0000 - accuracy: 0.8579 - precision: 0.6447 - recall: 0.6447 - auc: 0.9112 - val_loss: 0.8194 - val_tp: 41195.0000 - val_fp: 22805.0000 - val_tn: 233195.0000 - val_fn: 22805.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-16128000-16384000
[INFO] processing batch 16384000-16640000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:63141 (24.66445%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.002116286:0.00117%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.95469%,0.8139250565:21.07812%,0.8029830673999999:18.19219%,0.8149336757:17.43789%,0.8137722355:17.33281%,0.814841983:0.00078%,0.7825203251999999:0.00039%,0.9802707989:0.00039%,0.9054801638:0.00039%,0.8345253376999999:0.00039%,0.9502261752:0.00039%,0.2528119078:0.00039%,0.7788831836:0.00039%,0.0020936488:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.36953%,Single Stage Single Point:35.63047%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04492%,1:25.95508%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.56133%,1:17.43867%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.58906%,1:38.41094%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.92148%,1:21.07852%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.7125%,1:43.2875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.56172%,1:17.43828%]
[INFO] ** dst-192.168.1.40:[0:81.80781%,1:18.19219%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04492%,1:25.95508%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56133%,1:17.43867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58906%,1:38.41094%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66719%,1:17.33281%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0457%,1:25.9543%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92227%,1:21.07773%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5625%,1:17.4375%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80781%,1:18.19219%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      4,      6, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      3, ..., 255992, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8217 - tp: 123621.0000 - fp: 68379.0000 - tn: 699621.0000 - fn: 68379.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.8081 - val_tp: 41165.0000 - val_fp: 22835.0000 - val_tn: 233165.0000 - val_fn: 22835.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-16384000-16640000
[INFO] processing batch 16640000-16896000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.95664%,0.8139250565:21.02539%,0.8029830673999999:18.1918%,0.8149336757:17.4918%,0.8137722355:17.33242%,0.8030136315999999:0.00078%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.31523%,Single Stage Single Point:35.68477%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04297%,1:25.95703%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50781%,1:17.49219%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80703%,1:18.19297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.64219%,1:38.35781%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97461%,1:21.02539%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71055%,1:43.28945%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.5082%,1:17.4918%]
[INFO] ** dst-192.168.1.40:[0:81.8082%,1:18.1918%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04297%,1:25.95703%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50781%,1:17.49219%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80703%,1:18.19297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.64219%,1:38.35781%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66797%,1:17.33203%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04375%,1:25.95625%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97461%,1:21.02539%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5082%,1:17.4918%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80859%,1:18.19141%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      3,      5, ..., 255991, 255995, 255996]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8118 - tp: 123417.0000 - fp: 68583.0000 - tn: 699417.0000 - fn: 68583.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.9108 - val_loss: 0.7960 - val_tp: 41230.0000 - val_fp: 22770.0000 - val_tn: 233230.0000 - val_fn: 22770.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-16640000-16896000
[INFO] processing batch 16896000-17152000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99805%,0.0:0.00195%]
[INFO] ** s_port:[0.834280824:25.93984%,0.8139250565:21.03945%,0.8029830673999999:18.1543%,0.8149336757:17.47109%,0.8137722355:17.39023%,0.0:0.00195%,0.8059172320999999:0.00117%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.37422%,Single Stage Single Point:35.62578%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99805%,1:0.00195%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05898%,1:25.94102%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52812%,1:17.47188%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8457%,1:18.1543%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.57031%,1:38.42969%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:78.96055%,1:21.03945%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66992%,1:43.33008%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.52852%,1:17.47148%]
[INFO] ** dst-192.168.1.40:[0:81.84492%,1:18.15508%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05898%,1:25.94102%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52812%,1:17.47188%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8457%,1:18.1543%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.57031%,1:38.42969%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00156%,0:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60977%,1:17.39023%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06055%,1:25.93945%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96055%,1:21.03945%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5293%,1:17.4707%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8457%,1:18.1543%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255996, 255997, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164798.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      5, ..., 255992, 255995, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8007 - tp: 123600.0000 - fp: 68400.0000 - tn: 699600.0000 - fn: 68400.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9110 - val_loss: 0.7862 - val_tp: 41198.0000 - val_fp: 22802.0000 - val_tn: 233198.0000 - val_fn: 22802.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-16896000-17152000
[INFO] processing batch 17152000-17408000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99961%,0.8139250565:21.05%,0.8029830673999999:18.12773%,0.8149336757:17.46641%,0.8137722355:17.35547%,0.8059172320999999:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.40586%,Single Stage Single Point:35.59414%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00039%,1:25.99961%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53359%,1:17.46641%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87227%,1:18.12773%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.59453%,1:38.40547%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.95%,1:21.05%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64492%,1:43.35508%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53359%,1:17.46641%]
[INFO] ** dst-192.168.1.40:[0:81.87227%,1:18.12773%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00039%,1:25.99961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53359%,1:17.46641%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87227%,1:18.12773%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59453%,1:38.40547%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99844%,1:0.00156%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64453%,1:17.35547%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00078%,1:25.99922%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95%,1:21.05%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53398%,1:17.46602%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87227%,1:18.12773%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255995, 255996, 255997]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164879.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      6, ..., 255992, 255998, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.7908 - tp: 123711.0000 - fp: 68289.0000 - tn: 699711.0000 - fn: 68289.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.9111 - val_loss: 0.7772 - val_tp: 41168.0000 - val_fp: 22832.0000 - val_tn: 233168.0000 - val_fn: 22832.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-17152000-17408000
[INFO] processing batch 17408000-17664000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.97344%,0.8139250565:21.04922%,0.8029830673999999:18.15234%,0.8149336757:17.46406%,0.8137722355:17.35703%,0.8030136315999999:0.00078%,0.814841983:0.00078%,0.0:0.00078%,0.0818051226:0.00039%,0.8344030809:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.38242%,Single Stage Single Point:35.61758%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02578%,1:25.97422%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53516%,1:17.46484%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84648%,1:18.15352%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.59375%,1:38.40625%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.95078%,1:21.04922%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66914%,1:43.33086%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53594%,1:17.46406%]
[INFO] ** dst-192.168.1.40:[0:81.84727%,1:18.15273%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02578%,1:25.97422%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53516%,1:17.46484%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84648%,1:18.15352%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59375%,1:38.40625%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64336%,1:17.35664%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02656%,1:25.97344%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95117%,1:21.04883%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53594%,1:17.46406%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84805%,1:18.15195%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255995, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164819.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      6, ..., 255993, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7825 - tp: 123701.0000 - fp: 68299.0000 - tn: 699701.0000 - fn: 68299.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.9110 - val_loss: 0.7691 - val_tp: 41118.0000 - val_fp: 22882.0000 - val_tn: 233118.0000 - val_fn: 22882.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-17408000-17664000
[INFO] processing batch 17664000-17920000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.08394601119999999:0.00078%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.9793%,0.8139250565:20.98828%,0.8029830673999999:18.18008%,0.8149336757:17.50898%,0.8137722355:17.33984%,0.8166299895999999:0.00078%,0.814841983:0.00078%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.31055%,Single Stage Single Point:35.68945%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01992%,1:25.98008%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.48984%,1:17.51016%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.81992%,1:18.18008%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.01133%,1:20.98867%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68086%,1:43.31914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49062%,1:17.50937%]
[INFO] ** dst-192.168.1.40:[0:81.81953%,1:18.18047%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01992%,1:25.98008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48984%,1:17.51016%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.81992%,1:18.18008%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02148%,1:25.97852%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01172%,1:20.98828%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49141%,1:17.50859%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.81992%,1:18.18008%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     4,      5,      8, ..., 255991, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7752 - tp: 123546.0000 - fp: 68454.0000 - tn: 699546.0000 - fn: 68454.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.9109 - val_loss: 0.7614 - val_tp: 41089.0000 - val_fp: 22911.0000 - val_tn: 233089.0000 - val_fn: 22911.0000 - val_accuracy: 0.8568 - val_precision: 0.6420 - val_recall: 0.6420 - val_auc: 0.9105
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-17664000-17920000
[INFO] processing batch 17920000-18176000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.00352%,0.8139250565:21.07344%,0.8029830673999999:18.11914%,0.8149336757:17.46094%,0.8137722355:17.34063%,0.8059172320999999:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.0021089309:0.00039%]
[INFO] ** classification:[normal:64.41953%,Single Stage Single Point:35.58047%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.99648%,1:26.00352%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53906%,1:17.46094%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88047%,1:18.11953%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58594%,1:38.41406%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.92656%,1:21.07344%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65586%,1:43.34414%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.53906%,1:17.46094%]
[INFO] ** dst-192.168.1.40:[0:81.88086%,1:18.11914%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.99648%,1:26.00352%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53906%,1:17.46094%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88047%,1:18.11953%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58594%,1:38.41406%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65938%,1:17.34063%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.99648%,1:26.00352%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92656%,1:21.07344%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53906%,1:17.46094%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88125%,1:18.11875%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      4, ..., 255995, 255996, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      3,      5, ..., 255994, 255997, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 12s - loss: 0.7673 - tp: 123681.0000 - fp: 68319.0000 - tn: 699681.0000 - fn: 68319.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9111 - val_loss: 0.7520 - val_tp: 41233.0000 - val_fp: 22767.0000 - val_tn: 233233.0000 - val_fn: 22767.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-17920000-18176000
[INFO] processing batch 18176000-18432000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:55800 (21.79688%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.98555%,0.8139250565:21.06953%,0.8029830673999999:18.08633%,0.8149336757:17.48359%,0.8137722355:17.37188%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:64.42891%,Single Stage Single Point:35.57109%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01367%,1:25.98633%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.51641%,1:17.48359%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.93047%,1:21.06953%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64219%,1:43.35781%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.51602%,1:17.48398%]
[INFO] ** dst-192.168.1.40:[0:81.91328%,1:18.08672%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01367%,1:25.98633%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51641%,1:17.48359%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62852%,1:17.37148%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01523%,1:25.98477%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93047%,1:21.06953%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51641%,1:17.48359%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91367%,1:18.08633%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255996, 255997, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164938.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      6,      9, ..., 255992, 255995, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.7610 - tp: 123640.0000 - fp: 68360.0000 - tn: 699640.0000 - fn: 68360.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9110 - val_loss: 0.7444 - val_tp: 41298.0000 - val_fp: 22702.0000 - val_tn: 233298.0000 - val_fn: 22702.0000 - val_accuracy: 0.8581 - val_precision: 0.6453 - val_recall: 0.6453 - val_auc: 0.9113
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-18176000-18432000
[INFO] processing batch 18432000-18688000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:53869 (21.04258%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08391465880000001:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.95781%,0.8139250565:21.05938%,0.8029830673999999:18.11641%,0.8149336757:17.48984%,0.8137722355:17.37461%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.39375%,Single Stage Single Point:35.60625%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0418%,1:25.9582%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50937%,1:17.49063%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.56602%,1:38.43398%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.94062%,1:21.05938%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66758%,1:43.33242%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.51016%,1:17.48984%]
[INFO] ** dst-192.168.1.40:[0:81.8832%,1:18.1168%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0418%,1:25.9582%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50937%,1:17.49063%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56602%,1:38.43398%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62539%,1:17.37461%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04219%,1:25.95781%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94062%,1:21.05938%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51055%,1:17.48945%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88359%,1:18.11641%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      7, ..., 255993, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7553 - tp: 123615.0000 - fp: 68385.0000 - tn: 699615.0000 - fn: 68385.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.7390 - val_tp: 41233.0000 - val_fp: 22767.0000 - val_tn: 233233.0000 - val_fn: 22767.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-18432000-18688000
[INFO] processing batch 18688000-18944000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:54033 (21.10664%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.94609%,0.8139250565:21.09766%,0.8029830673999999:18.11172%,0.8149336757:17.50117%,0.8137722355:17.33984%,0.814841983:0.00078%,0.9344397579000001:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.38633%,Single Stage Single Point:35.61367%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05273%,1:25.94727%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88789%,1:18.11211%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.5625%,1:38.4375%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.90195%,1:21.09805%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71367%,1:43.28633%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.49844%,1:17.50156%]
[INFO] ** dst-192.168.1.40:[0:81.88789%,1:18.11211%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05273%,1:25.94727%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88789%,1:18.11211%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5625%,1:38.4375%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0543%,1:25.9457%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90273%,1:21.09727%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49883%,1:17.50117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88867%,1:18.11133%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      5,      7, ..., 255992, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7497 - tp: 123645.0000 - fp: 68355.0000 - tn: 699645.0000 - fn: 68355.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9110 - val_loss: 0.7340 - val_tp: 41184.0000 - val_fp: 22816.0000 - val_tn: 233184.0000 - val_fn: 22816.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-18688000-18944000
[INFO] processing batch 18944000-19200000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:64214 (25.08359%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.98281%,0.8139250565:21.08516%,0.8029830673999999:18.06875%,0.8149336757:17.45547%,0.8137722355:17.40664%,0.8059172320999999:0.00078%,0.8030136315999999:0.00039%]
[INFO] ** classification:[normal:64.47539%,Single Stage Single Point:35.52461%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01719%,1:25.98281%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54453%,1:17.45547%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.93086%,1:18.06914%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91484%,1:21.08516%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61055%,1:43.38945%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54453%,1:17.45547%]
[INFO] ** dst-192.168.1.40:[0:81.93125%,1:18.06875%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01719%,1:25.98281%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54453%,1:17.45547%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.93086%,1:18.06914%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99805%,1:0.00195%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.59375%,1:17.40625%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01758%,1:25.98242%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91484%,1:21.08516%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54453%,1:17.45547%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.93125%,1:18.06875%]
[INFO] columns with count within 2-10 {'s_port': 7, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      5,      6, ..., 255990, 255994, 255996]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7439 - tp: 123888.0000 - fp: 68112.0000 - tn: 699888.0000 - fn: 68112.0000 - accuracy: 0.8581 - precision: 0.6453 - recall: 0.6453 - auc: 0.9113 - val_loss: 0.7290 - val_tp: 41169.0000 - val_fp: 22831.0000 - val_tn: 233169.0000 - val_fn: 22831.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-18944000-19200000
[INFO] processing batch 19200000-19456000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.91523%,0.8139250565:21.08711%,0.8029830673999999:18.23672%,0.8149336757:17.43164%,0.8137722355:17.32812%,0.8059172320999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:64.33164%,Single Stage Single Point:35.66836%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.08438%,1:25.91562%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.56797%,1:17.43203%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76328%,1:18.23672%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91289%,1:21.08711%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.75664%,1:43.24336%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.56836%,1:17.43164%]
[INFO] ** dst-192.168.1.40:[0:81.76289%,1:18.23711%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.08438%,1:25.91562%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56797%,1:17.43203%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76328%,1:18.23672%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67188%,1:17.32812%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.08516%,1:25.91484%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91289%,1:21.08711%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56914%,1:17.43086%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76328%,1:18.23672%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164689.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      9, ..., 255994, 255995, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7414 - tp: 123500.0000 - fp: 68500.0000 - tn: 699500.0000 - fn: 68500.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.9109 - val_loss: 0.7241 - val_tp: 41189.0000 - val_fp: 22811.0000 - val_tn: 233189.0000 - val_fn: 22811.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-19200000-19456000
[INFO] processing batch 19456000-19712000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00586%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.98398%,0.8139250565:21.0457%,0.8029830673999999:18.14141%,0.8149336757:17.46133%,0.8137722355:17.35859%,0.0:0.00586%,0.8343113882:0.00078%,0.9715599976:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.8345253376999999:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.39648%,Single Stage Single Point:35.60352%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99883%,1:0.00117%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** i/f_name-eth1:[1:99.99414%,0:0.00586%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_dir-outbound:[1:99.99453%,0:0.00547%]
[INFO] ** src-0:[0:99.99414%,1:0.00586%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01445%,1:25.98555%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53828%,1:17.46172%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8582%,1:18.1418%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.5957%,1:38.4043%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99414%,1:0.00586%]
[INFO] ** dst-192.168.1.10:[0:78.9543%,1:21.0457%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65742%,1:43.34258%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53828%,1:17.46172%]
[INFO] ** dst-192.168.1.40:[0:81.8582%,1:18.1418%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99414%,1:0.00586%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99414%,1:0.00586%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01445%,1:25.98555%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53828%,1:17.46172%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8582%,1:18.1418%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5957%,1:38.4043%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64141%,1:17.35859%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01641%,1:25.98359%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95469%,1:21.04531%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53867%,1:17.46133%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85898%,1:18.14102%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      9,     11, ..., 255990, 255992, 255994]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7366 - tp: 123689.0000 - fp: 68311.0000 - tn: 699689.0000 - fn: 68311.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9111 - val_loss: 0.7200 - val_tp: 41166.0000 - val_fp: 22834.0000 - val_tn: 233166.0000 - val_fn: 22834.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-19456000-19712000
[INFO] processing batch 19712000-19968000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:56152 (21.93437%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00195%,1.0:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.98945%,0.8139250565:20.99453%,0.8029830673999999:18.17266%,0.8149336757:17.51328%,0.8137722355:17.32656%,0.0:0.00195%,0.814841983:0.00078%,0.0021089309:0.00039%,0.0818356868:0.00039%]
[INFO] ** classification:[normal:64.31406%,Single Stage Single Point:35.68594%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99805%,1:0.00195%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01055%,1:25.98945%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.48594%,1:17.51406%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.67891%,1:38.32109%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:79.00547%,1:20.99453%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68398%,1:43.31602%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.48672%,1:17.51328%]
[INFO] ** dst-192.168.1.40:[0:81.82734%,1:18.17266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01055%,1:25.98945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48594%,1:17.51406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.67891%,1:38.32109%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67383%,1:17.32617%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01094%,1:25.98906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.00547%,1:20.99453%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.48672%,1:17.51328%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82734%,1:18.17266%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 's_port': 9, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DNP3 Protocol - initialize data to defaults': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      6, ..., 255994, 255997, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      4, ..., 255995, 255996, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7339 - tp: 123402.0000 - fp: 68598.0000 - tn: 699402.0000 - fn: 68598.0000 - accuracy: 0.8571 - precision: 0.6427 - recall: 0.6427 - auc: 0.9107 - val_loss: 0.7152 - val_tp: 41242.0000 - val_fp: 22758.0000 - val_tn: 233242.0000 - val_fn: 22758.0000 - val_accuracy: 0.8578 - val_precision: 0.6444 - val_recall: 0.6444 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-19712000-19968000
[INFO] processing batch 19968000-20224000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:58822 (22.97734%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.0021476384:0.00156%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.91172%,0.8139250565:21.07344%,0.8029830673999999:18.17578%,0.8149336757:17.45547%,0.8137722355:17.37695%,0.0020936488:0.00156%,0.7586191087:0.00039%,0.8147502904:0.00039%,0.0021089309:0.00039%,0.8345253376999999:0.00039%,0.8059172320999999:0.00039%,0.8411730545999999:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.8344030809:0.00039%,0.15243902439999998:0.00039%,0.8030136315999999:0.00039%,0.315972859:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.36797%,Single Stage Single Point:35.63203%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0875%,1:25.9125%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.20:[0:82.54414%,1:17.45586%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82383%,1:18.17617%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.92656%,1:21.07344%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71133%,1:43.28867%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.54414%,1:17.45586%]
[INFO] ** dst-192.168.1.40:[0:81.82344%,1:18.17656%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0875%,1:25.9125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54414%,1:17.45586%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82383%,1:18.17617%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99297%,1:0.00703%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62305%,1:17.37695%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.08828%,1:25.91172%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92656%,1:21.07344%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54492%,1:17.45508%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82422%,1:18.17578%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      9,     12, ..., 255991, 255993, 255995]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7302 - tp: 123541.0000 - fp: 68459.0000 - tn: 699541.0000 - fn: 68459.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9109 - val_loss: 0.7116 - val_tp: 41241.0000 - val_fp: 22759.0000 - val_tn: 233241.0000 - val_fn: 22759.0000 - val_accuracy: 0.8578 - val_precision: 0.6444 - val_recall: 0.6444 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-19968000-20224000
[INFO] processing batch 20224000-20480000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.98945%,0.0:0.01055%]
[INFO] ** modbus_transaction_id:63526 (24.81484%)
[INFO] ** service:[0.7025755984000001:99.98945%,0.08394601119999999:0.00195%,0.0208806885:0.00195%,0.002116286:0.00156%,0.0:0.00156%,0.0021476384:0.00117%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08543524949999999:0.00039%,0.09248953609999999:0.00039%,0.0021633145999999997:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.97188%,0.8139250565:21.05156%,0.8029830673999999:18.16094%,0.8149336757:17.44414%,0.8137722355:17.35977%,0.0:0.00156%,0.0020936488:0.00117%,0.8166299895999999:0.00078%,1.0:0.00039%,0.9535729568000001:0.00039%,0.315972859:0.00039%,0.9834647595:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.7788831836:0.00039%,0.0021089309:0.00039%,0.9502261752:0.00039%,0.9054801638:0.00039%,0.8030136315999999:0.00039%,0.15243902439999998:0.00039%,0.9802707989:0.00039%,0.8411730545999999:0.00039%,0.8059172320999999:0.00039%,0.7593068036:0.00039%,0.7825203251999999:0.00039%,0.9344397579000001:0.00039%,0.15240846019999998:0.00039%,0.0818051226:0.00039%,0.9715599976:0.00039%]
[INFO] ** classification:[normal:64.39414%,Single Stage Single Point:35.60586%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02812%,1:25.97188%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.20:[0:82.55586%,1:17.44414%]
[INFO] ** src-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.201:[0:99.99648%,1:0.00352%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.83828%,1:18.16172%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.60:[0:61.58867%,1:38.41133%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:78.94844%,1:21.05156%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66797%,1:43.33203%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.55586%,1:17.44414%]
[INFO] ** dst-192.168.1.40:[0:81.83906%,1:18.16094%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99805%,1:0.00195%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99414%,0:0.00586%]
[INFO] ** proto-udp:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98945%,0:0.01055%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99609%,1:0.00391%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02812%,1:25.97188%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.55586%,1:17.44414%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.83828%,1:18.16172%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58867%,1:38.41133%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.98945%,1:0.01055%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00625%,1:49.99375%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98711%,1:0.01289%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64023%,1:17.35977%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02891%,1:25.97109%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94844%,1:21.05156%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.55586%,1:17.44414%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.83945%,1:18.16055%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      5, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164849.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      4, ..., 255992, 255993, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7267 - tp: 123640.0000 - fp: 68360.0000 - tn: 699640.0000 - fn: 68360.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9110 - val_loss: 0.7086 - val_tp: 41209.0000 - val_fp: 22791.0000 - val_tn: 233209.0000 - val_fn: 22791.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-20224000-20480000
[INFO] processing batch 20480000-20736000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0021633145999999997:0.00117%,0.002116286:0.00117%,0.0012540954:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.93828%,0.8139250565:21.09258%,0.8029830673999999:18.17773%,0.8149336757:17.43398%,0.8137722355:17.35234%,0.0021089309:0.00117%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.9502261752:0.00039%,0.8212604682:0.00039%,0.7788831836:0.00039%,0.0020936488:0.00039%,0.9088575095999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.38789%,Single Stage Single Point:35.61211%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.56523%,1:17.43477%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82227%,1:18.17773%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.55508%,1:38.44492%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.90742%,1:21.09258%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70937%,1:43.29062%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.56562%,1:17.43438%]
[INFO] ** dst-192.168.1.40:[0:81.82227%,1:18.17773%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56523%,1:17.43477%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82227%,1:18.17773%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55508%,1:38.44492%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64805%,1:17.35195%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06172%,1:25.93828%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90742%,1:21.09258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56602%,1:17.43398%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82227%,1:18.17773%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      3,      4, ..., 255995, 255997, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      1,      8, ..., 255993, 255996, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7241 - tp: 123598.0000 - fp: 68402.0000 - tn: 699598.0000 - fn: 68402.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9109 - val_loss: 0.7053 - val_tp: 41235.0000 - val_fp: 22765.0000 - val_tn: 233235.0000 - val_fn: 22765.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-20480000-20736000
[INFO] processing batch 20736000-20992000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0:0.00078%]
[INFO] ** s_port:[0.834280824:25.98789%,0.8139250565:21.075%,0.8029830673999999:18.09727%,0.8149336757:17.45625%,0.8137722355:17.38125%,0.8030136315999999:0.00078%,0.814841983:0.00078%,0.0:0.00078%]
[INFO] ** classification:[normal:64.4457%,Single Stage Single Point:35.5543%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01211%,1:25.98789%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54297%,1:17.45703%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.90195%,1:18.09805%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54375%,1:38.45625%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.925%,1:21.075%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63086%,1:43.36914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54375%,1:17.45625%]
[INFO] ** dst-192.168.1.40:[0:81.90273%,1:18.09727%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01211%,1:25.98789%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54297%,1:17.45703%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.90195%,1:18.09805%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54375%,1:38.45625%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61875%,1:17.38125%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01289%,1:25.98711%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92539%,1:21.07461%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54453%,1:17.45547%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.90273%,1:18.09727%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 8, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255989, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7205 - tp: 123769.0000 - fp: 68231.0000 - tn: 699769.0000 - fn: 68231.0000 - accuracy: 0.8579 - precision: 0.6446 - recall: 0.6446 - auc: 0.9111 - val_loss: 0.7026 - val_tp: 41212.0000 - val_fp: 22788.0000 - val_tn: 233212.0000 - val_fn: 22788.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-20736000-20992000
[INFO] processing batch 20992000-21248000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:64919 (25.35898%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.97148%,0.8139250565:21.03398%,0.8029830673999999:18.17773%,0.8149336757:17.49805%,0.8137722355:17.31641%,0.8059172320999999:0.00078%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.32344%,Single Stage Single Point:35.67656%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02773%,1:25.97227%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50156%,1:17.49844%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82188%,1:18.17813%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.64961%,1:38.35039%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.96602%,1:21.03398%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71172%,1:43.28828%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50156%,1:17.49844%]
[INFO] ** dst-192.168.1.40:[0:81.82188%,1:18.17813%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02773%,1:25.97227%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50156%,1:17.49844%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82188%,1:18.17813%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.64961%,1:38.35039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68359%,1:17.31641%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02852%,1:25.97148%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96602%,1:21.03398%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50195%,1:17.49805%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82266%,1:18.17734%]
[INFO] columns with count within 2-10 {'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      9, ..., 255991, 255992, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7193 - tp: 123459.0000 - fp: 68541.0000 - tn: 699459.0000 - fn: 68541.0000 - accuracy: 0.8572 - precision: 0.6430 - recall: 0.6430 - auc: 0.9108 - val_loss: 0.7000 - val_tp: 41209.0000 - val_fp: 22791.0000 - val_tn: 233209.0000 - val_fn: 22791.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-20992000-21248000
[INFO] processing batch 21248000-21504000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:65321 (25.51602%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00117%,0.08391465880000001:0.00078%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.92227%,0.8139250565:21.08281%,0.8029830673999999:18.1707%,0.8149336757:17.42852%,0.8137722355:17.3918%,0.0:0.00117%,0.0818051226:0.00078%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.0020936488:0.00039%,0.8683752063:0.00039%]
[INFO] ** classification:[normal:64.40078%,Single Stage Single Point:35.59922%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.07656%,1:25.92344%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.57148%,1:17.42852%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.8293%,1:18.1707%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.52539%,1:38.47461%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.91719%,1:21.08281%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68594%,1:43.31406%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.57148%,1:17.42852%]
[INFO] ** dst-192.168.1.40:[0:81.82891%,1:18.17109%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.07656%,1:25.92344%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.57148%,1:17.42852%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8293%,1:18.1707%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.52539%,1:38.47461%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60859%,1:17.39141%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.07812%,1:25.92188%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91719%,1:21.08281%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.57148%,1:17.42852%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8293%,1:18.1707%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      5, ..., 255993, 255994, 255995]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7163 - tp: 123683.0000 - fp: 68317.0000 - tn: 699683.0000 - fn: 68317.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9110 - val_loss: 0.6978 - val_tp: 41183.0000 - val_fp: 22817.0000 - val_tn: 233183.0000 - val_fn: 22817.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-21248000-21504000
[INFO] processing batch 21504000-21760000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:60727 (23.72148%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99648%,0.8139250565:21.01445%,0.8029830673999999:18.12266%,0.8149336757:17.49414%,0.8137722355:17.36992%,0.8030136315999999:0.00078%,0.8059172320999999:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.38203%,Single Stage Single Point:35.61797%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00352%,1:25.99648%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50547%,1:17.49453%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87617%,1:18.12383%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.61562%,1:38.38438%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.98555%,1:21.01445%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6332%,1:43.3668%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50586%,1:17.49414%]
[INFO] ** dst-192.168.1.40:[0:81.87734%,1:18.12266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00352%,1:25.99648%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50547%,1:17.49453%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87617%,1:18.12383%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.61562%,1:38.38438%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63008%,1:17.36992%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00391%,1:25.99609%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.98555%,1:21.01445%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50664%,1:17.49336%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87734%,1:18.12266%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255993, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255995, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7145 - tp: 123564.0000 - fp: 68436.0000 - tn: 699564.0000 - fn: 68436.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.9109 - val_loss: 0.6947 - val_tp: 41254.0000 - val_fp: 22746.0000 - val_tn: 233254.0000 - val_fn: 22746.0000 - val_accuracy: 0.8578 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-21504000-21760000
[INFO] processing batch 21760000-22016000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:56134 (21.92734%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00078%]
[INFO] ** s_port:[0.834280824:25.90469%,0.8139250565:21.12695%,0.8029830673999999:18.12656%,0.8149336757:17.425%,0.8137722355:17.41367%,0.814841983:0.00117%,0.8166299895999999:0.00078%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:64.44805%,Single Stage Single Point:35.55195%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09453%,1:25.90547%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.57344%,1:17.42656%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87344%,1:18.12656%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.45938%,1:38.54062%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.87305%,1:21.12695%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68164%,1:43.31836%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.57461%,1:17.42539%]
[INFO] ** dst-192.168.1.40:[0:81.87305%,1:18.12695%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09453%,1:25.90547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.57344%,1:17.42656%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87344%,1:18.12656%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.45938%,1:38.54062%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.58633%,1:17.41367%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0957%,1:25.9043%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.87305%,1:21.12695%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.575%,1:17.425%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87344%,1:18.12656%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      6, ..., 255994, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164987.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      4, ..., 255995, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7118 - tp: 123717.0000 - fp: 68283.0000 - tn: 699717.0000 - fn: 68283.0000 - accuracy: 0.8577 - precision: 0.6444 - recall: 0.6444 - auc: 0.9111 - val_loss: 0.6924 - val_tp: 41270.0000 - val_fp: 22730.0000 - val_tn: 233270.0000 - val_fn: 22730.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-21760000-22016000
[INFO] processing batch 22016000-22272000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65090 (25.42578%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00078%,0.09248953609999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.9543%,0.8139250565:21.04297%,0.8029830673999999:18.15234%,0.8149336757:17.475%,0.8137722355:17.37266%,0.8059172320999999:0.00078%,0.0:0.00078%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:64.37266%,Single Stage Single Point:35.62734%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04531%,1:25.95469%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.525%,1:17.475%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58438%,1:38.41562%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.95703%,1:21.04297%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67305%,1:43.32695%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.525%,1:17.475%]
[INFO] ** dst-192.168.1.40:[0:81.84766%,1:18.15234%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04531%,1:25.95469%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.525%,1:17.475%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58438%,1:38.41562%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62773%,1:17.37227%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04609%,1:25.95391%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95742%,1:21.04258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.525%,1:17.475%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84766%,1:18.15234%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255995, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164794.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      7, ..., 255992, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7099 - tp: 123690.0000 - fp: 68310.0000 - tn: 699690.0000 - fn: 68310.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9110 - val_loss: 0.6920 - val_tp: 41104.0000 - val_fp: 22896.0000 - val_tn: 233104.0000 - val_fn: 22896.0000 - val_accuracy: 0.8569 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-22016000-22272000
[INFO] processing batch 22272000-22528000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00234%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.97461%,0.8139250565:21.1%,0.8029830673999999:18.12305%,0.8149336757:17.45625%,0.8137722355:17.3418%,0.0:0.00234%,0.8059172320999999:0.00039%,0.0818051226:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.41992%,Single Stage Single Point:35.58008%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02461%,1:25.97539%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54375%,1:17.45625%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.87656%,1:18.12344%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.5582%,1:38.4418%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:78.9%,1:21.1%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6832%,1:43.3168%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54336%,1:17.45664%]
[INFO] ** dst-192.168.1.40:[0:81.87695%,1:18.12305%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02461%,1:25.97539%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54375%,1:17.45625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87656%,1:18.12344%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5582%,1:38.4418%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6582%,1:17.3418%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02578%,1:25.97422%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.9%,1:21.1%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54453%,1:17.45547%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87734%,1:18.12266%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255993, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255995, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7080 - tp: 123672.0000 - fp: 68328.0000 - tn: 699672.0000 - fn: 68328.0000 - accuracy: 0.8577 - precision: 0.6441 - recall: 0.6441 - auc: 0.9110 - val_loss: 0.6887 - val_tp: 41243.0000 - val_fp: 22757.0000 - val_tn: 233243.0000 - val_fn: 22757.0000 - val_accuracy: 0.8578 - val_precision: 0.6444 - val_recall: 0.6444 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-22272000-22528000
[INFO] processing batch 22528000-22784000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.96172%,0.8139250565:21.05625%,0.8029830673999999:18.09258%,0.8149336757:17.4875%,0.8137722355:17.40039%,0.8059172320999999:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.41992%,Single Stage Single Point:35.58008%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.51172%,1:17.48828%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.90742%,1:18.09258%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54336%,1:38.45664%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.94336%,1:21.05664%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63789%,1:43.36211%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.5125%,1:17.4875%]
[INFO] ** dst-192.168.1.40:[0:81.90703%,1:18.09297%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51172%,1:17.48828%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.90742%,1:18.09258%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54336%,1:38.45664%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99805%,1:0.00195%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.59961%,1:17.40039%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03828%,1:25.96172%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94414%,1:21.05586%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5125%,1:17.4875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.90742%,1:18.09258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 's_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      5,      7, ..., 255990, 255991, 255996]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7064 - tp: 123623.0000 - fp: 68377.0000 - tn: 699623.0000 - fn: 68377.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.6864 - val_tp: 41292.0000 - val_fp: 22708.0000 - val_tn: 233292.0000 - val_fn: 22708.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.9113
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-22528000-22784000
[INFO] processing batch 22784000-23040000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:56752 (22.16875%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.00898%,0.8139250565:21.04414%,0.8029830673999999:18.06172%,0.8149336757:17.50859%,0.8137722355:17.37383%,0.814841983:0.00117%,0.9344397579000001:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.4293%,Single Stage Single Point:35.5707%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.99023%,1:26.00977%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.93828%,1:18.06172%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58203%,1:38.41797%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.95586%,1:21.04414%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61719%,1:43.38281%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.49102%,1:17.50898%]
[INFO] ** dst-192.168.1.40:[0:81.93828%,1:18.06172%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.99023%,1:26.00977%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.93828%,1:18.06172%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58203%,1:38.41797%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62656%,1:17.37344%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9918%,1:26.0082%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95586%,1:21.04414%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49141%,1:17.50859%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.93828%,1:18.06172%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      6, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      4, ..., 255989, 255993, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7043 - tp: 123759.0000 - fp: 68241.0000 - tn: 699759.0000 - fn: 68241.0000 - accuracy: 0.8578 - precision: 0.6446 - recall: 0.6446 - auc: 0.9112 - val_loss: 0.6858 - val_tp: 41180.0000 - val_fp: 22820.0000 - val_tn: 233180.0000 - val_fn: 22820.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-22784000-23040000
[INFO] processing batch 23040000-23296000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:56178 (21.94453%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.86328%,0.8139250565:21.12305%,0.8029830673999999:18.19102%,0.8149336757:17.44766%,0.8137722355:17.37188%,0.8059172320999999:0.00078%,0.8030136315999999:0.00078%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.36016%,Single Stage Single Point:35.63984%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.13555%,1:25.86445%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.55234%,1:17.44766%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.50508%,1:38.49492%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.87695%,1:21.12305%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.76445%,1:43.23555%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.55234%,1:17.44766%]
[INFO] ** dst-192.168.1.40:[0:81.80859%,1:18.19141%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.13555%,1:25.86445%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.55234%,1:17.44766%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.50508%,1:38.49492%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00156%,0:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62812%,1:17.37188%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.13672%,1:25.86328%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.87734%,1:21.12266%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.55273%,1:17.44727%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80937%,1:18.19062%]
[INFO] columns with count within 2-10 {'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      5, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      4, ..., 255989, 255994, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7036 - tp: 123507.0000 - fp: 68493.0000 - tn: 699507.0000 - fn: 68493.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.9108 - val_loss: 0.6835 - val_tp: 41255.0000 - val_fp: 22745.0000 - val_tn: 233255.0000 - val_fn: 22745.0000 - val_accuracy: 0.8578 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-23040000-23296000
[INFO] processing batch 23296000-23552000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:56269 (21.98008%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.94531%,0.8139250565:21.08359%,0.8029830673999999:18.17734%,0.8149336757:17.44219%,0.8137722355:17.35078%,0.1074637814:0.00039%,0.8059172320999999:0.00039%]
[INFO] ** classification:[normal:64.38047%,Single Stage Single Point:35.61953%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05469%,1:25.94531%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.55781%,1:17.44219%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82266%,1:18.17734%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.56562%,1:38.43437%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91641%,1:21.08359%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70391%,1:43.29609%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.55781%,1:17.44219%]
[INFO] ** dst-192.168.1.40:[0:81.82266%,1:18.17734%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05469%,1:25.94531%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.55781%,1:17.44219%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82266%,1:18.17734%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56562%,1:38.43437%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99844%,1:0.00156%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64922%,1:17.35078%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.05547%,1:25.94453%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91641%,1:21.08359%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.55781%,1:17.44219%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82266%,1:18.17734%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 's_port': 7, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255995, 255996, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      7, ..., 255991, 255997, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7017 - tp: 123601.0000 - fp: 68399.0000 - tn: 699601.0000 - fn: 68399.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.6824 - val_tp: 41213.0000 - val_fp: 22787.0000 - val_tn: 233213.0000 - val_fn: 22787.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-23296000-23552000
[INFO] processing batch 23552000-23808000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:55508 (21.68281%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00547%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.96953%,0.8139250565:21.09688%,0.8029830673999999:18.04336%,0.8149336757:17.48633%,0.8137722355:17.39492%,0.0:0.00547%,0.9715599976:0.00039%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.9535729568000001:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.46914%,Single Stage Single Point:35.53086%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_name-eth1:[1:99.99453%,0:0.00547%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99453%,1:0.00547%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.51328%,1:17.48672%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.95586%,1:18.04414%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99453%,1:0.00547%]
[INFO] ** dst-192.168.1.10:[0:78.90312%,1:21.09688%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63516%,1:43.36484%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.51328%,1:17.48672%]
[INFO] ** dst-192.168.1.40:[0:81.95664%,1:18.04336%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99453%,1:0.00547%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99453%,1:0.00547%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51328%,1:17.48672%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.95586%,1:18.04414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60547%,1:17.39453%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03047%,1:25.96953%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90312%,1:21.09688%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51367%,1:17.48633%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.95664%,1:18.04336%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      3,      8, ..., 255990, 255994, 255995]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6997 - tp: 123749.0000 - fp: 68251.0000 - tn: 699749.0000 - fn: 68251.0000 - accuracy: 0.8578 - precision: 0.6445 - recall: 0.6445 - auc: 0.9111 - val_loss: 0.6801 - val_tp: 41292.0000 - val_fp: 22708.0000 - val_tn: 233292.0000 - val_fn: 22708.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.9113
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-23552000-23808000
[INFO] processing batch 23808000-24064000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:54330 (21.22266%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0:0.00078%]
[INFO] ** s_port:[0.834280824:25.92031%,0.8139250565:21.05508%,0.8029830673999999:18.13008%,0.8149336757:17.50703%,0.8137722355:17.38398%,0.814841983:0.00117%,0.8343113882:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%]
[INFO] ** classification:[normal:64.3625%,Single Stage Single Point:35.6375%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.07852%,1:25.92148%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4918%,1:17.5082%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86953%,1:18.13047%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.56094%,1:38.43906%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.94492%,1:21.05508%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6957%,1:43.3043%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49297%,1:17.50703%]
[INFO] ** dst-192.168.1.40:[0:81.86953%,1:18.13047%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.07852%,1:25.92148%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4918%,1:17.5082%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86953%,1:18.13047%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56094%,1:38.43906%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61602%,1:17.38398%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.08008%,1:25.91992%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94531%,1:21.05469%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49375%,1:17.50625%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87031%,1:18.12969%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      5, ..., 255995, 255996, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164768.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      4, ..., 255989, 255997, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6987 - tp: 123603.0000 - fp: 68397.0000 - tn: 699603.0000 - fn: 68397.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.6801 - val_tp: 41165.0000 - val_fp: 22835.0000 - val_tn: 233165.0000 - val_fn: 22835.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-23808000-24064000
[INFO] processing batch 24064000-24320000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:53384 (20.85312%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.0:0.00117%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.96133%,0.8139250565:21.07148%,0.8029830673999999:18.16055%,0.8149336757:17.4707%,0.8137722355:17.32969%,0.0:0.00117%,0.0020936488:0.00078%,0.8059172320999999:0.00078%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.15243902439999998:0.00039%,0.8147502904:0.00039%,0.7586191087:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:64.36836%,Single Stage Single Point:35.63164%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52891%,1:17.47109%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.83945%,1:18.16055%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.92852%,1:21.07148%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70898%,1:43.29102%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.52891%,1:17.47109%]
[INFO] ** dst-192.168.1.40:[0:81.83906%,1:18.16094%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52891%,1:17.47109%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.83945%,1:18.16055%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67031%,1:17.32969%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03906%,1:25.96094%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92852%,1:21.07148%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5293%,1:17.4707%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.83945%,1:18.16055%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255995, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      9, ..., 255993, 255996, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6974 - tp: 123599.0000 - fp: 68401.0000 - tn: 699599.0000 - fn: 68401.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9109 - val_loss: 0.6786 - val_tp: 41184.0000 - val_fp: 22816.0000 - val_tn: 233184.0000 - val_fn: 22816.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-24064000-24320000
[INFO] processing batch 24320000-24576000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:63855 (24.94336%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.002116286:0.00078%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90703%,0.8139250565:21.06953%,0.8029830673999999:18.22578%,0.8149336757:17.47305%,0.8137722355:17.3207%,0.0:0.00117%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,1.0:0.00039%,0.8344030809:0.00039%,0.8673054588:0.00039%,0.9088575095999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.30039%,Single Stage Single Point:35.69961%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09258%,1:25.90742%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52695%,1:17.47305%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77344%,1:18.22656%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.60977%,1:38.39023%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.93047%,1:21.06953%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.77188%,1:43.22812%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.52695%,1:17.47305%]
[INFO] ** dst-192.168.1.40:[0:81.77383%,1:18.22617%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09258%,1:25.90742%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52695%,1:17.47305%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77344%,1:18.22656%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.60977%,1:38.39023%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67969%,1:17.32031%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09336%,1:25.90664%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93086%,1:21.06914%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52695%,1:17.47305%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77422%,1:18.22578%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255994, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164609.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      6, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6967 - tp: 123440.0000 - fp: 68560.0000 - tn: 699440.0000 - fn: 68560.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.9108 - val_loss: 0.6775 - val_tp: 41169.0000 - val_fp: 22831.0000 - val_tn: 233169.0000 - val_fn: 22831.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-24320000-24576000
[INFO] processing batch 24576000-24832000/24819975
[33m[LOSS] 0.6774957432746888[0m
[33m[INFO] epoch 2/3[0m
[33m[INFO] loading file 1-50/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (24819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[33mencode_text_dummy orig[0m
[33mencode_text_dummy type[0m
[33mencode_text_dummy i/f_name[0m
[33mencode_text_dummy i/f_dir[0m
[33mencode_text_dummy src[0m
[33mencode_text_dummy dst[0m
[33mencode_text_dummy proto[0m
[33mencode_text_dummy appi_name[0m
[33mencode_text_dummy proxy_src_ip[0m
[33mencode_text_dummy modbus_function_description[0m
[33mencode_text_dummy scada_tag[0m
len(df.columns) 108
numFeatures 107
[INFO] columns: Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'orig-192.168.1.87',
       'orig-192.168.1.88', 'type-alert',
       ...
       'modbus_function_description-Read Tag Service',
       'modbus_function_description-Read Tag Service - Response',
       'modbus_function_description-Unknown Function Code',
       'modbus_function_description-Write Tag Service', 'scada_tag-0',
       'scada_tag-HMI_AIT202', 'scada_tag-HMI_FIT201', 'scada_tag-HMI_LIT101',
       'scada_tag-HMI_LIT301', 'scada_tag-HMI_LIT401'],
      dtype='object', length=108)
[INFO] analyze dataset: (24819975, 108)

[INFO] analyzing data
[INFO] 24819975 rows
[INFO] ** unixtime:67474 (0.27185%)
[INFO] ** modbus_function_code:[0.9743589744:99.99716%,0.0:0.0028%,1.0:4e-05%,0.9615384615000001:0.0%,0.9871794872:0.0%]
[INFO] ** modbus_transaction_id:65536 (0.26405%)
[INFO] ** service:[0.7025755984000001:99.99736%,0.0:0.00126%,0.08394601119999999:0.00023%,0.0021633145999999997:0.00021%,0.0021476384:0.00021%,0.0208806885:0.00017%,0.002116286:0.00017%,0.08391465880000001:0.00013%,0.0297847659:7e-05%,0.0021789908:5e-05%,0.0012540954:5e-05%,0.09248953609999999:4e-05%,0.08543524949999999:4e-05%,0.0348324999:1e-05%,1.0:0.0%]
[INFO] ** s_port:[0.834280824:26.01285%,0.8139250565:20.97143%,0.8029830673999999:18.17391%,0.8149336757:17.51381%,0.8137722355:17.32337%,0.0:0.00126%,0.814841983:0.00035%,0.8059172320999999:0.00033%,0.8343113882:0.00029%,0.8030136315999999:0.00025%,0.0020936488:0.00021%,0.0021089309:0.00021%,0.8345253376999999:0.00018%,0.8030441959000001:0.00014%,0.8344030809:0.00014%,0.0818051226:0.00013%,0.8147502904:0.00011%,0.8166299895999999:9e-05%,0.7788831836:4e-05%,0.8411730545999999:4e-05%,0.15240846019999998:4e-05%,0.7586191087:4e-05%,0.9834647595:4e-05%,0.9715599976:4e-05%,0.7593068036:4e-05%,0.15243902439999998:4e-05%,0.315972859:4e-05%,0.0290360046:3e-05%,0.2528119078:3e-05%,0.8876612262000001:3e-05%,0.9344397579000001:3e-05%,0.9535729568000001:3e-05%,0.1074484993:2e-05%,0.792988569:2e-05%,0.9502261752:2e-05%,0.7579772602:2e-05%,0.705452656:2e-05%,0.7414573018:2e-05%,0.7077908184999999:2e-05%,0.6970474968000001:2e-05%,0.8868054282:2e-05%,0.9802707989:2e-05%,0.9054801638:2e-05%,0.6452258696000001:2e-05%,0.8685433095:1e-05%,0.980989058:1e-05%,0.8465523565:1e-05%,0.9621003729000001:1e-05%,0.8831377224:1e-05%,0.9399107525:1e-05%,0.7825203251999999:1e-05%,0.9004676325:1e-05%,0.8212604682:1e-05%,0.9088575095999999:1e-05%,0.8738156367000001:1e-05%,0.8711259856999999:1e-05%,0.8643407299:1e-05%,0.8668928418999999:1e-05%,0.45597224770000006:1e-05%,0.7897640443:1e-05%,0.0339568433:1e-05%,0.905082829:1e-05%,0.8870957883:1e-05%,1.0:1e-05%,0.9156580476:0.0%,0.8683752063:0.0%,0.8935448376999999:0.0%,0.1074637814:0.0%,0.9339660126:0.0%,0.8591448133:0.0%,0.9842747112000001:0.0%,0.9034629256000001:0.0%,0.8262729995999999:0.0%,0.0818356868:0.0%,0.8881655358:0.0%,0.8916498562999999:0.0%,0.8985420868999999:0.0%,0.7673146279999999:0.0%,0.9765266826000001:0.0%,0.8673054588:0.0%,0.7918882572:0.0%,0.7891527599:0.0%,0.8431597286:0.0%,0.9104621309:0.0%]
[INFO] ** classification:[normal:75.94865%,Single Stage Single Point:20.68165%,Multi Stage Single Point:1.90264%,Single Stage Multi Point:0.95195%,Multi Stage Multi Point:0.5151%]
[INFO] ** orig-192.168.1.48:[1:99.9996%,0:0.0004%]
[INFO] ** orig-192.168.1.87:[0:99.99993%,1:7e-05%]
[INFO] ** orig-192.168.1.88:[0:99.99967%,1:0.00033%]
[INFO] ** type-alert:[0:99.99996%,1:4e-05%]
[INFO] ** type-control:[0:99.99975%,1:0.00025%]
[INFO] ** type-log:[1:99.99971%,0:0.00029%]
[INFO] ** i/f_name-0:[0:99.99875%,1:0.00125%]
[INFO] ** i/f_name-eth1:[1:99.99874%,0:0.00126%]
[INFO] ** i/f_name-geod daemon:[0:100.0%,1:0.0%]
[INFO] ** i/f_dir-inbound:[0:99.99885%,1:0.00115%]
[INFO] ** i/f_dir-outbound:[1:99.99885%,0:0.00115%]
[INFO] ** src-0:[0:99.99907%,1:0.00093%]
[INFO] ** src-10.15.51.65:[0:100.0%,1:0.0%]
[INFO] ** src-192.168.1.10:[0:73.98655%,1:26.01345%]
[INFO] ** src-192.168.1.134:[0:99.99995%,1:5e-05%]
[INFO] ** src-192.168.1.136:[0:99.99982%,1:0.00018%]
[INFO] ** src-192.168.1.19:[0:99.99978%,1:0.00022%]
[INFO] ** src-192.168.1.199:[0:99.99989%,1:0.00011%]
[INFO] ** src-192.168.1.20:[0:82.48573%,1:17.51427%]
[INFO] ** src-192.168.1.200:[0:99.99981%,1:0.00019%]
[INFO] ** src-192.168.1.201:[0:99.99966%,1:0.00034%]
[INFO] ** src-192.168.1.202:[0:99.99997%,1:3e-05%]
[INFO] ** src-192.168.1.30:[0:81.82569%,1:18.17431%]
[INFO] ** src-192.168.1.40:[0:99.99967%,1:0.00033%]
[INFO] ** src-192.168.1.49:[0:99.99973%,1:0.00027%]
[INFO] ** src-192.168.1.60:[0:61.7052%,1:38.2948%]
[INFO] ** src-192.168.1.88:[0:99.9995%,1:0.0005%]
[INFO] ** dst-0:[0:99.99874%,1:0.00126%]
[INFO] ** dst-192.168.1.10:[0:79.02848%,1:20.97152%]
[INFO] ** dst-192.168.1.100:[0:99.99996%,1:4e-05%]
[INFO] ** dst-192.168.1.19:[0:99.99996%,1:4e-05%]
[INFO] ** dst-192.168.1.20:[0:56.66363%,1:43.33637%]
[INFO] ** dst-192.168.1.200:[0:99.99993%,1:7e-05%]
[INFO] ** dst-192.168.1.201:[0:99.99973%,1:0.00027%]
[INFO] ** dst-192.168.1.255:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.30:[0:82.48595%,1:17.51405%]
[INFO] ** dst-192.168.1.40:[0:81.8258%,1:18.1742%]
[INFO] ** dst-192.168.1.49:[0:99.99998%,1:2e-05%]
[INFO] ** dst-192.168.1.50:[0:99.99902%,1:0.00098%]
[INFO] ** dst-192.168.1.60:[0:99.99975%,1:0.00025%]
[INFO] ** dst-192.168.1.88:[0:99.99991%,1:9e-05%]
[INFO] ** dst-224.0.0.251:[0:99.99987%,1:0.00013%]
[INFO] ** dst-224.0.0.252:[0:99.99977%,1:0.00023%]
[INFO] ** dst-239.192.4.191:[0:99.99999%,1:1e-05%]
[INFO] ** dst-239.255.255.250:[0:99.99993%,1:7e-05%]
[INFO] ** proto-0:[0:99.99874%,1:0.00126%]
[INFO] ** proto-tcp:[1:99.99788%,0:0.00212%]
[INFO] ** proto-udp:[0:99.99913%,1:0.00087%]
[INFO] ** appi_name-0:[0:99.99869%,1:0.00131%]
[INFO] ** appi_name-CIP_func75:[0:100.0%,1:0.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99996%,1:4e-05%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99716%,0:0.00284%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%,1:0.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99999%,1:1e-05%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99998%,1:2e-05%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99998%,1:2e-05%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%,1:0.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99984%,1:0.00016%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%,1:0.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99996%,1:4e-05%]
[INFO] ** appi_name-Google Chrome:[0:100.0%,1:0.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99979%,1:0.00021%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99987%,1:0.00013%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99979%,1:0.00021%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99998%,1:2e-05%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99996%,1:4e-05%]
[INFO] ** appi_name-SSDP:[0:99.99993%,1:7e-05%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99983%,1:0.00017%]
[INFO] ** appi_name-VNC:[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Web Browsing:[0:99.99996%,1:4e-05%]
[INFO] ** proxy_src_ip-0:[0:99.99869%,1:0.00131%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%,1:0.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.98655%,1:26.01345%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99996%,1:4e-05%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99978%,1:0.00022%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.9999%,1:0.0001%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48573%,1:17.51427%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99968%,1:0.00032%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99997%,1:3e-05%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82569%,1:18.17431%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99967%,1:0.00033%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99973%,1:0.00027%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.7052%,1:38.2948%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99983%,1:0.00017%]
[INFO] ** modbus_function_description-0:[0:99.9972%,1:0.0028%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99996%,1:4e-05%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00222%,1:49.99778%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00062%,1:49.99938%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%,1:0.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%,1:0.0%]
[INFO] ** scada_tag-0:[0:99.9944%,1:0.0056%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67675%,1:17.32325%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98751%,1:26.01249%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.02869%,1:20.97131%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.48643%,1:17.51357%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82621%,1:18.17379%]
[INFO] columns with count within 2-10 {'modbus_function_code': 5, 'classification': 5, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_name-geod daemon': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-10.15.51.65': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.192.4.191': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_func75': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-CIP_write_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-Common Industrial Protocol - success': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-DNP3 Protocol - initialize data to defaults': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Google Chrome': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-VNC': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-10.15.51.65': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'modbus_function_description-Unknown Function Code': 2, 'modbus_function_description-Write Tag Service': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
--------------AFTER DROPPING COLUMNS ----------------
df.columns Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'orig-192.168.1.87',
       'orig-192.168.1.88', 'type-alert',
       ...
       'modbus_function_description-Read Tag Service',
       'modbus_function_description-Read Tag Service - Response',
       'modbus_function_description-Unknown Function Code',
       'modbus_function_description-Write Tag Service', 'scada_tag-0',
       'scada_tag-HMI_AIT202', 'scada_tag-HMI_FIT201', 'scada_tag-HMI_LIT101',
       'scada_tag-HMI_LIT301', 'scada_tag-HMI_LIT401'],
      dtype='object', length=108) 108
          unixtime  modbus_function_code  modbus_transaction_id   service  \
0         0.000000              0.974359               0.105043  0.702576   
1         0.000000              0.974359               0.049699  0.702576   
2         0.000000              0.974359               0.760021  0.702576   
3         0.000000              0.974359               0.724208  0.702576   
4         0.000000              0.974359               0.099031  0.702576   
...            ...                   ...                    ...       ...   
24819970  0.587998              0.974359               0.724636  0.702576   
24819971  0.587998              0.974359               0.447852  0.702576   
24819972  0.587998              0.974359               0.724636  0.702576   
24819973  0.587998              0.974359               0.652247  0.702576   
24819974  0.587998              0.974359               0.004623  0.702576   

            s_port             classification  orig-192.168.1.48  \
0         0.813772                     normal                  1   
1         0.834281                     normal                  1   
2         0.802983                     normal                  1   
3         0.814934                     normal                  1   
4         0.813925                     normal                  1   
...            ...                        ...                ...   
24819970  0.813925                     normal                  1   
24819971  0.813772                     normal                  1   
24819972  0.813925                     normal                  1   
24819973  0.834281                     normal                  1   
24819974  0.814934  Single Stage Single Point                  1   

          orig-192.168.1.87  orig-192.168.1.88  type-alert  type-control  \
0                         0                  0           0             0   
1                         0                  0           0             0   
2                         0                  0           0             0   
3                         0                  0           0             0   
4                         0                  0           0             0   
...                     ...                ...         ...           ...   
24819970                  0                  0           0             0   
24819971                  0                  0           0             0   
24819972                  0                  0           0             0   
24819973                  0                  0           0             0   
24819974                  0                  0           0             0   

          type-log  i/f_name-0  i/f_name-eth1  i/f_name-geod daemon  \
0                1           0              1                     0   
1                1           0              1                     0   
2                1           0              1                     0   
3                1           0              1                     0   
4                1           0              1                     0   
...            ...         ...            ...                   ...   
24819970         1           0              1                     0   
24819971         1           0              1                     0   
24819972         1           0              1                     0   
24819973         1           0              1                     0   
24819974         1           0              1                     0   

          i/f_dir-inbound  i/f_dir-outbound  src-0  src-10.15.51.65  \
0                       0                 1      0                0   
1                       0                 1      0                0   
2                       0                 1      0                0   
3                       0                 1      0                0   
4                       0                 1      0                0   
...                   ...               ...    ...              ...   
24819970                0                 1      0                0   
24819971                0                 1      0                0   
24819972                0                 1      0                0   
24819973                0                 1      0                0   
24819974                0                 1      0                0   

          src-192.168.1.10  src-192.168.1.134  src-192.168.1.136  \
0                        0                  0                  0   
1                        1                  0                  0   
2                        0                  0                  0   
3                        0                  0                  0   
4                        0                  0                  0   
...                    ...                ...                ...   
24819970                 0                  0                  0   
24819971                 0                  0                  0   
24819972                 0                  0                  0   
24819973                 1                  0                  0   
24819974                 0                  0                  0   

          src-192.168.1.19  src-192.168.1.199  src-192.168.1.20  \
0                        0                  0                 0   
1                        0                  0                 0   
2                        0                  0                 0   
3                        0                  0                 1   
4                        0                  0                 0   
...                    ...                ...               ...   
24819970                 0                  0                 0   
24819971                 0                  0                 0   
24819972                 0                  0                 0   
24819973                 0                  0                 0   
24819974                 0                  0                 1   

          src-192.168.1.200  src-192.168.1.201  src-192.168.1.202  \
0                         0                  0                  0   
1                         0                  0                  0   
2                         0                  0                  0   
3                         0                  0                  0   
4                         0                  0                  0   
...                     ...                ...                ...   
24819970                  0                  0                  0   
24819971                  0                  0                  0   
24819972                  0                  0                  0   
24819973                  0                  0                  0   
24819974                  0                  0                  0   

          src-192.168.1.30  src-192.168.1.40  src-192.168.1.49  \
0                        0                 0                 0   
1                        0                 0                 0   
2                        1                 0                 0   
3                        0                 0                 0   
4                        0                 0                 0   
...                    ...               ...               ...   
24819970                 0                 0                 0   
24819971                 0                 0                 0   
24819972                 0                 0                 0   
24819973                 0                 0                 0   
24819974                 0                 0                 0   

          src-192.168.1.60  src-192.168.1.88  dst-0  dst-192.168.1.10  \
0                        1                 0      0                 0   
1                        0                 0      0                 0   
2                        0                 0      0                 0   
3                        0                 0      0                 0   
4                        1                 0      0                 1   
...                    ...               ...    ...               ...   
24819970                 1                 0      0                 1   
24819971                 1                 0      0                 0   
24819972                 1                 0      0                 1   
24819973                 0                 0      0                 0   
24819974                 0                 0      0                 0   

          dst-192.168.1.100  dst-192.168.1.19  dst-192.168.1.20  \
0                         0                 0                 1   
1                         0                 0                 1   
2                         0                 0                 0   
3                         0                 0                 0   
4                         0                 0                 0   
...                     ...               ...               ...   
24819970                  0                 0                 0   
24819971                  0                 0                 1   
24819972                  0                 0                 0   
24819973                  0                 0                 1   
24819974                  0                 0                 0   

          dst-192.168.1.200  dst-192.168.1.201  dst-192.168.1.255  \
0                         0                  0                  0   
1                         0                  0                  0   
2                         0                  0                  0   
3                         0                  0                  0   
4                         0                  0                  0   
...                     ...                ...                ...   
24819970                  0                  0                  0   
24819971                  0                  0                  0   
24819972                  0                  0                  0   
24819973                  0                  0                  0   
24819974                  0                  0                  0   

          dst-192.168.1.30  dst-192.168.1.40  dst-192.168.1.49  \
0                        0                 0                 0   
1                        0                 0                 0   
2                        0                 1                 0   
3                        1                 0                 0   
4                        0                 0                 0   
...                    ...               ...               ...   
24819970                 0                 0                 0   
24819971                 0                 0                 0   
24819972                 0                 0                 0   
24819973                 0                 0                 0   
24819974                 1                 0                 0   

          dst-192.168.1.50  dst-192.168.1.60  dst-192.168.1.88  \
0                        0                 0                 0   
1                        0                 0                 0   
2                        0                 0                 0   
3                        0                 0                 0   
4                        0                 0                 0   
...                    ...               ...               ...   
24819970                 0                 0                 0   
24819971                 0                 0                 0   
24819972                 0                 0                 0   
24819973                 0                 0                 0   
24819974                 0                 0                 0   

          dst-224.0.0.251  dst-224.0.0.252  dst-239.192.4.191  \
0                       0                0                  0   
1                       0                0                  0   
2                       0                0                  0   
3                       0                0                  0   
4                       0                0                  0   
...                   ...              ...                ...   
24819970                0                0                  0   
24819971                0                0                  0   
24819972                0                0                  0   
24819973                0                0                  0   
24819974                0                0                  0   

          dst-239.255.255.250  proto-0  proto-tcp  proto-udp  appi_name-0  \
0                           0        0          1          0            0   
1                           0        0          1          0            0   
2                           0        0          1          0            0   
3                           0        0          1          0            0   
4                           0        0          1          0            0   
...                       ...      ...        ...        ...          ...   
24819970                    0        0          1          0            0   
24819971                    0        0          1          0            0   
24819972                    0        0          1          0            0   
24819973                    0        0          1          0            0   
24819974                    0        0          1          0            0   

          appi_name-CIP_func75  appi_name-CIP_gen  \
0                            0                  0   
1                            0                  0   
2                            0                  0   
3                            0                  0   
4                            0                  0   
...                        ...                ...   
24819970                     0                  0   
24819971                     0                  0   
24819972                     0                  0   
24819973                     0                  0   
24819974                     0                  0   

          appi_name-CIP_read_tag_service  appi_name-CIP_write_tag_service  \
0                                      1                                0   
1                                      1                                0   
2                                      1                                0   
3                                      1                                0   
4                                      1                                0   
...                                  ...                              ...   
24819970                               1                                0   
24819971                               1                                0   
24819972                               1                                0   
24819973                               1                                0   
24819974                               1                                0   

          appi_name-Common Industrial Protocol  \
0                                            0   
1                                            0   
2                                            0   
3                                            0   
4                                            0   
...                                        ...   
24819970                                     0   
24819971                                     0   
24819972                                     0   
24819973                                     0   
24819974                                     0   

          appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)  \
0                                                         0                
1                                                         0                
2                                                         0                
3                                                         0                
4                                                         0                
...                                                     ...                
24819970                                                  0                
24819971                                                  0                
24819972                                                  0                
24819973                                                  0                
24819974                                                  0                

          appi_name-Common Industrial Protocol - get attribute all  \
0                                                         0          
1                                                         0          
2                                                         0          
3                                                         0          
4                                                         0          
...                                                     ...          
24819970                                                  0          
24819971                                                  0          
24819972                                                  0          
24819973                                                  0          
24819974                                                  0          

          appi_name-Common Industrial Protocol - get attribute single  \
0                                                         0             
1                                                         0             
2                                                         0             
3                                                         0             
4                                                         0             
...                                                     ...             
24819970                                                  0             
24819971                                                  0             
24819972                                                  0             
24819973                                                  0             
24819974                                                  0             

          appi_name-Common Industrial Protocol - multiple service packet  \
0                                                         0                
1                                                         0                
2                                                         0                
3                                                         0                
4                                                         0                
...                                                     ...                
24819970                                                  0                
24819971                                                  0                
24819972                                                  0                
24819973                                                  0                
24819974                                                  0                

          appi_name-Common Industrial Protocol - success  \
0                                                      0   
1                                                      0   
2                                                      0   
3                                                      0   
4                                                      0   
...                                                  ...   
24819970                                               0   
24819971                                               0   
24819972                                               0   
24819973                                               0   
24819974                                               0   

          appi_name-DCE-RPC Protocol  \
0                                  0   
1                                  0   
2                                  0   
3                                  0   
4                                  0   
...                              ...   
24819970                           0   
24819971                           0   
24819972                           0   
24819973                           0   
24819974                           0   

          appi_name-DNP3 Protocol - initialize data to defaults  \
0                                                         0       
1                                                         0       
2                                                         0       
3                                                         0       
4                                                         0       
...                                                     ...       
24819970                                                  0       
24819971                                                  0       
24819972                                                  0       
24819973                                                  0       
24819974                                                  0       

          appi_name-EtherNet/IP  appi_name-Google Chrome  \
0                             0                        0   
1                             0                        0   
2                             0                        0   
3                             0                        0   
4                             0                        0   
...                         ...                      ...   
24819970                      0                        0   
24819971                      0                        0   
24819972                      0                        0   
24819973                      0                        0   
24819974                      0                        0   

          appi_name-LLMNR Protocol  appi_name-Multicast DNS Protocol (mDNS)  \
0                                0                                        0   
1                                0                                        0   
2                                0                                        0   
3                                0                                        0   
4                                0                                        0   
...                            ...                                      ...   
24819970                         0                                        0   
24819971                         0                                        0   
24819972                         0                                        0   
24819973                         0                                        0   
24819974                         0                                        0   

          appi_name-NetBIOS Datagram Service  appi_name-NetBIOS Name Service  \
0                                          0                               0   
1                                          0                               0   
2                                          0                               0   
3                                          0                               0   
4                                          0                               0   
...                                      ...                             ...   
24819970                                   0                               0   
24819971                                   0                               0   
24819972                                   0                               0   
24819973                                   0                               0   
24819974                                   0                               0   

          appi_name-NetBIOS Session Service  appi_name-OSIsoft PI  \
0                                         0                     0   
1                                         0                     0   
2                                         0                     0   
3                                         0                     0   
4                                         0                     0   
...                                     ...                   ...   
24819970                                  0                     0   
24819971                                  0                     0   
24819972                                  0                     0   
24819973                                  0                     0   
24819974                                  0                     0   

          appi_name-SSDP  appi_name-Server Message Block (SMB)  \
0                      0                                     0   
1                      0                                     0   
2                      0                                     0   
3                      0                                     0   
4                      0                                     0   
...                  ...                                   ...   
24819970               0                                     0   
24819971               0                                     0   
24819972               0                                     0   
24819973               0                                     0   
24819974               0                                     0   

          appi_name-Unknown Traffic  appi_name-VNC  appi_name-Web Browsing  \
0                                 0              0                       0   
1                                 0              0                       0   
2                                 0              0                       0   
3                                 0              0                       0   
4                                 0              0                       0   
...                             ...            ...                     ...   
24819970                          0              0                       0   
24819971                          0              0                       0   
24819972                          0              0                       0   
24819973                          0              0                       0   
24819974                          0              0                       0   

          proxy_src_ip-0  proxy_src_ip-10.15.51.65  proxy_src_ip-192.168.1.10  \
0                      0                         0                          0   
1                      0                         0                          1   
2                      0                         0                          0   
3                      0                         0                          0   
4                      0                         0                          0   
...                  ...                       ...                        ...   
24819970               0                         0                          0   
24819971               0                         0                          0   
24819972               0                         0                          0   
24819973               0                         0                          1   
24819974               0                         0                          0   

          proxy_src_ip-192.168.1.134  proxy_src_ip-192.168.1.136  \
0                                  0                           0   
1                                  0                           0   
2                                  0                           0   
3                                  0                           0   
4                                  0                           0   
...                              ...                         ...   
24819970                           0                           0   
24819971                           0                           0   
24819972                           0                           0   
24819973                           0                           0   
24819974                           0                           0   

          proxy_src_ip-192.168.1.19  proxy_src_ip-192.168.1.199  \
0                                 0                           0   
1                                 0                           0   
2                                 0                           0   
3                                 0                           0   
4                                 0                           0   
...                             ...                         ...   
24819970                          0                           0   
24819971                          0                           0   
24819972                          0                           0   
24819973                          0                           0   
24819974                          0                           0   

          proxy_src_ip-192.168.1.20  proxy_src_ip-192.168.1.200  \
0                                 0                           0   
1                                 0                           0   
2                                 0                           0   
3                                 1                           0   
4                                 0                           0   
...                             ...                         ...   
24819970                          0                           0   
24819971                          0                           0   
24819972                          0                           0   
24819973                          0                           0   
24819974                          1                           0   

          proxy_src_ip-192.168.1.201  proxy_src_ip-192.168.1.202  \
0                                  0                           0   
1                                  0                           0   
2                                  0                           0   
3                                  0                           0   
4                                  0                           0   
...                              ...                         ...   
24819970                           0                           0   
24819971                           0                           0   
24819972                           0                           0   
24819973                           0                           0   
24819974                           0                           0   

          proxy_src_ip-192.168.1.30  proxy_src_ip-192.168.1.40  \
0                                 0                          0   
1                                 0                          0   
2                                 1                          0   
3                                 0                          0   
4                                 0                          0   
...                             ...                        ...   
24819970                          0                          0   
24819971                          0                          0   
24819972                          0                          0   
24819973                          0                          0   
24819974                          0                          0   

          proxy_src_ip-192.168.1.49  proxy_src_ip-192.168.1.60  \
0                                 0                          1   
1                                 0                          0   
2                                 0                          0   
3                                 0                          0   
4                                 0                          1   
...                             ...                        ...   
24819970                          0                          1   
24819971                          0                          1   
24819972                          0                          1   
24819973                          0                          0   
24819974                          0                          0   

          proxy_src_ip-192.168.1.88  modbus_function_description-0  \
0                                 0                              0   
1                                 0                              0   
2                                 0                              0   
3                                 0                              0   
4                                 0                              0   
...                             ...                            ...   
24819970                          0                              0   
24819971                          0                              0   
24819972                          0                              0   
24819973                          0                              0   
24819974                          0                              0   

          modbus_function_description-Forward Close - Response  \
0                                                         0      
1                                                         0      
2                                                         0      
3                                                         0      
4                                                         0      
...                                                     ...      
24819970                                                  0      
24819971                                                  0      
24819972                                                  0      
24819973                                                  0      
24819974                                                  0      

          modbus_function_description-Read Tag Service  \
0                                                    0   
1                                                    0   
2                                                    1   
3                                                    1   
4                                                    1   
...                                                ...   
24819970                                             1   
24819971                                             1   
24819972                                             0   
24819973                                             0   
24819974                                             1   

          modbus_function_description-Read Tag Service - Response  \
0                                                         1         
1                                                         1         
2                                                         0         
3                                                         0         
4                                                         0         
...                                                     ...         
24819970                                                  0         
24819971                                                  0         
24819972                                                  1         
24819973                                                  1         
24819974                                                  0         

          modbus_function_description-Unknown Function Code  \
0                                                         0   
1                                                         0   
2                                                         0   
3                                                         0   
4                                                         0   
...                                                     ...   
24819970                                                  0   
24819971                                                  0   
24819972                                                  0   
24819973                                                  0   
24819974                                                  0   

          modbus_function_description-Write Tag Service  scada_tag-0  \
0                                                     0            0   
1                                                     0            0   
2                                                     0            0   
3                                                     0            0   
4                                                     0            0   
...                                                 ...          ...   
24819970                                              0            0   
24819971                                              0            0   
24819972                                              0            0   
24819973                                              0            0   
24819974                                              0            0   

          scada_tag-HMI_AIT202  scada_tag-HMI_FIT201  scada_tag-HMI_LIT101  \
0                            1                     0                     0   
1                            0                     1                     0   
2                            0                     0                     0   
3                            0                     0                     0   
4                            0                     0                     1   
...                        ...                   ...                   ...   
24819970                     0                     0                     1   
24819971                     1                     0                     0   
24819972                     0                     0                     1   
24819973                     0                     1                     0   
24819974                     0                     0                     0   

          scada_tag-HMI_LIT301  scada_tag-HMI_LIT401  
0                            0                     0  
1                            0                     0  
2                            0                     1  
3                            1                     0  
4                            0                     0  
...                        ...                   ...  
24819970                     0                     0  
24819971                     0                     0  
24819972                     0                     0  
24819973                     0                     0  
24819974                     1                     0  

[24819975 rows x 108 columns]
[INFO] processing batch 0-256000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57548 (22.47969%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0021476384:0.00117%,0.0:0.00117%,0.0021789908:0.00078%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90586%,0.8139250565:21.04297%,0.8029830673999999:18.20469%,0.8149336757:17.47891%,0.8137722355:17.3582%,0.792988569:0.00156%,0.0:0.00117%,0.0020936488:0.00117%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00078%,0.7897640443:0.00078%,0.0818051226:0.00078%,0.0290360046:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.95547%,1:21.04453%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.73555%,1:43.26445%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.5207%,1:17.4793%]
[INFO] ** dst-192.168.1.40:[0:81.79531%,1:18.20469%]
[INFO] ** dst-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64219%,1:17.35781%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09453%,1:25.90547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95703%,1:21.04297%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52109%,1:17.47891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79531%,1:18.20469%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.4017 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.3090 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-0-256000
[INFO] processing batch 256000-512000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00703%]
[INFO] ** modbus_transaction_id:65264 (25.49375%)
[INFO] ** service:[0.7025755984000001:99.99297%,0.0208806885:0.00156%,0.002116286:0.00117%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0021789908:0.00078%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.89492%,0.8139250565:21.03672%,0.8029830673999999:18.12031%,0.8149336757:17.56719%,0.8137722355:17.37266%,0.0:0.00117%,0.0020936488:0.00078%,0.8685433095:0.00078%,0.8344030809:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.7593068036:0.00039%,0.9399107525:0.00039%,0.315972859:0.00039%,0.8668928418999999:0.00039%,0.8030136315999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8643407299:0.00039%,0.814841983:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:57.36133%,Single Stage Single Point:42.63867%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.10469%,1:25.89531%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.43242%,1:17.56758%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8793%,1:18.1207%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.60:[0:61.59062%,1:38.40938%]
[INFO] ** src-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.96328%,1:21.03672%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.73242%,1:43.26758%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.43281%,1:17.56719%]
[INFO] ** dst-192.168.1.40:[0:81.8793%,1:18.1207%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.10469%,1:25.89531%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43242%,1:17.56758%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8793%,1:18.1207%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59062%,1:38.40938%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-0:[0:99.99297%,1:0.00703%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00391%,1:49.99609%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62734%,1:17.37266%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.10508%,1:25.89492%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96367%,1:21.03633%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4332%,1:17.5668%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88008%,1:18.11992%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255994, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 23491,  23493,  23497, ..., 255995, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7789 - tp: 112918.0000 - fp: 79082.0000 - tn: 688918.0000 - fn: 79082.0000 - accuracy: 0.8352 - precision: 0.5881 - recall: 0.5881 - auc: 0.8969 - val_loss: 0.7981 - val_tp: 33927.0000 - val_fp: 30073.0000 - val_tn: 225927.0000 - val_fn: 30073.0000 - val_accuracy: 0.8120 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.8825
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-256000-512000
[INFO] processing batch 512000-768000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.95469%,0.8139250565:20.98125%,0.8029830673999999:18.17227%,0.8149336757:17.52461%,0.8137722355:17.36484%,0.8030136315999999:0.00039%,0.9621003729000001:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:78.25859%,Single Stage Single Point:21.74141%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04453%,1:25.95547%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47461%,1:17.52539%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.65391%,1:38.34609%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.01875%,1:20.98125%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68047%,1:43.31953%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.475%,1:17.525%]
[INFO] ** dst-192.168.1.40:[0:81.82734%,1:18.17266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04453%,1:25.95547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47461%,1:17.52539%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65391%,1:38.34609%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63516%,1:17.36484%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04609%,1:25.95391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01875%,1:20.98125%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47578%,1:17.52422%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82773%,1:18.17227%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255994, 255995, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      6, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6335 - tp: 138284.0000 - fp: 53716.0000 - tn: 714284.0000 - fn: 53716.0000 - accuracy: 0.8881 - precision: 0.7202 - recall: 0.7202 - auc: 0.9299 - val_loss: 0.3870 - val_tp: 62058.0000 - val_fp: 1942.0000 - val_tn: 254058.0000 - val_fn: 1942.0000 - val_accuracy: 0.9879 - val_precision: 0.9697 - val_recall: 0.9697 - val_auc: 0.9924
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-512000-768000
[INFO] processing batch 768000-1024000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:698 (0.27266%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.0043%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:63824 (24.93125%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.0208806885:0.00117%,0.0:0.00117%,0.0012540954:0.00078%,0.0348324999:0.00039%,0.0021633145999999997:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.96758%,0.8139250565:21.09844%,0.8029830673999999:18.08594%,0.8149336757:17.48789%,0.8137722355:17.35352%,0.0:0.00117%,0.7788831836:0.00078%,0.0020936488:0.00039%,0.814841983:0.00039%,0.8030441959000001:0.00039%,0.8147502904:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.792988569:0.00039%,0.8411730545999999:0.00039%,0.15240846019999998:0.00039%,0.0339568433:0.00039%,0.315972859:0.00039%,0.0021089309:0.00039%]
[INFO] ** classification:[normal:67.51602%,Single Stage Single Point:32.48398%]
[INFO] ** orig-192.168.1.48:[1:99.99961%,0:0.00039%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.51133%,1:17.48867%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91328%,1:18.08672%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.54805%,1:38.45195%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.90117%,1:21.09883%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67852%,1:43.32148%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.51211%,1:17.48789%]
[INFO] ** dst-192.168.1.40:[0:81.91367%,1:18.08633%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51133%,1:17.48867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91328%,1:18.08672%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54805%,1:38.45195%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.9957%,1:0.0043%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64687%,1:17.35312%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03242%,1:25.96758%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90156%,1:21.09844%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5125%,1:17.4875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91406%,1:18.08594%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-239.192.4.191': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      4, ..., 255995, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      7, ..., 255994, 255996, 255997]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7277 - tp: 117250.0000 - fp: 74750.0000 - tn: 693250.0000 - fn: 74750.0000 - accuracy: 0.8443 - precision: 0.6107 - recall: 0.6107 - auc: 0.9021 - val_loss: 0.4994 - val_tp: 55591.0000 - val_fp: 8409.0000 - val_tn: 247591.0000 - val_fn: 8409.0000 - val_accuracy: 0.9474 - val_precision: 0.8686 - val_recall: 0.8686 - val_auc: 0.9671
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-768000-1024000
[INFO] processing batch 1024000-1280000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.9875%,0.0:0.0125%]
[INFO] ** modbus_transaction_id:53455 (20.88086%)
[INFO] ** service:[0.7025755984000001:99.9875%,0.08394601119999999:0.00234%,0.0021633145999999997:0.00195%,0.0:0.00195%,0.002116286:0.00156%,0.0021476384:0.00156%,0.0297847659:0.00078%,0.0208806885:0.00078%,0.08391465880000001:0.00078%,0.08543524949999999:0.00039%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.9625%,0.8139250565:21.11836%,0.8029830673999999:18.14102%,0.8149336757:17.43203%,0.8137722355:17.33203%,0.0021089309:0.00195%,0.0:0.00195%,0.0020936488:0.00156%,0.8343113882:0.00078%,0.0818051226:0.00078%,0.8166299895999999:0.00078%,0.9765266826000001:0.00039%,0.9399107525:0.00039%,0.814841983:0.00039%,0.9834647595:0.00039%,0.8643407299:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8668928418999999:0.00039%,0.7593068036:0.00039%,0.9344397579000001:0.00039%,0.0290360046:0.00039%,0.8738156367000001:0.00039%,0.15243902439999998:0.00039%,0.9621003729000001:0.00039%,0.9715599976:0.00039%]
[INFO] ** classification:[normal:77.33086%,Single Stage Single Point:22.66914%]
[INFO] ** orig-192.168.1.48:[1:99.99805%,0:0.00195%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99805%,1:0.00195%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.10:[0:74.03672%,1:25.96328%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.56758%,1:17.43242%]
[INFO] ** src-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85859%,1:18.14141%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** src-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:78.88164%,1:21.11836%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70508%,1:43.29492%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99648%,1:0.00352%]
[INFO] ** dst-192.168.1.30:[0:82.56797%,1:17.43203%]
[INFO] ** dst-192.168.1.40:[0:81.85898%,1:18.14102%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99766%,1:0.00234%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99062%,0:0.00938%]
[INFO] ** proto-udp:[0:99.99258%,1:0.00742%]
[INFO] ** appi_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9875%,0:0.0125%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99648%,1:0.00352%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03672%,1:25.96328%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56758%,1:17.43242%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85859%,1:18.14141%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-0:[0:99.9875%,1:0.0125%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00703%,1:49.99297%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98477%,1:0.01523%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66836%,1:17.33164%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03789%,1:25.96211%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.88203%,1:21.11797%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56797%,1:17.43203%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85898%,1:18.14102%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-10.15.51.65': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-10.15.51.65': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      5, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      4, ..., 123216, 123217, 123220]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6517 - tp: 133967.0000 - fp: 58033.0000 - tn: 709967.0000 - fn: 58033.0000 - accuracy: 0.8791 - precision: 0.6977 - recall: 0.6977 - auc: 0.9242 - val_loss: 0.3943 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-1024000-1280000
[INFO] processing batch 1280000-1536000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:61506 (24.02578%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.08394601119999999:0.00117%,0.0:0.00078%,0.0021789908:0.00039%,0.0021633145999999997:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.96719%,0.8139250565:21.03398%,0.8029830673999999:18.2%,0.8149336757:17.47969%,0.8137722355:17.31445%,0.8166299895999999:0.00078%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8685433095:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.0020936488:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79961%,1:18.20039%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.65156%,1:38.34844%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96602%,1:21.03398%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.20:[0:56.71836%,1:43.28164%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.51992%,1:17.48008%]
[INFO] ** dst-192.168.1.40:[0:81.79961%,1:18.20039%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99883%,1:0.00117%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79961%,1:18.20039%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65156%,1:38.34844%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68555%,1:17.31445%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0332%,1:25.9668%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96602%,1:21.03398%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5207%,1:17.4793%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80039%,1:18.19961%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3654 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2939 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-1280000-1536000
[INFO] processing batch 1536000-1792000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65533 (25.59883%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99258%,0.8139250565:21.06133%,0.8029830673999999:18.11328%,0.8149336757:17.46836%,0.8137722355:17.36289%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:99.99961%,Single Stage Single Point:0.00039%]
[INFO] ** orig-192.168.1.48:[1:99.99961%,0:0.00039%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00742%,1:25.99258%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53125%,1:17.46875%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88633%,1:18.11367%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.57578%,1:38.42422%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.93867%,1:21.06133%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64453%,1:43.35547%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53164%,1:17.46836%]
[INFO] ** dst-192.168.1.40:[0:81.88672%,1:18.11328%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00742%,1:25.99258%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53125%,1:17.46875%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88633%,1:18.11367%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.57578%,1:38.42422%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63711%,1:17.36289%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00781%,1:25.99219%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93867%,1:21.06133%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53203%,1:17.46797%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88672%,1:18.11328%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [255999.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([103785]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2773 - tp: 191999.0000 - fp: 1.0000 - tn: 767999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2194 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-1536000-1792000
[INFO] processing batch 1792000-2048000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:707 (0.27617%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.0:0.00391%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.13906%,0.8139250565:20.75586%,0.8029830673999999:18.23828%,0.8149336757:17.6168%,0.8137722355:17.2418%,0.0:0.00391%,0.8343113882:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:80.53203%,Single Stage Single Point:19.46797%]
[INFO] ** orig-192.168.1.48:[1:99.99688%,0:0.00312%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** i/f_name-eth1:[1:99.99609%,0:0.00391%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99688%,1:0.00312%]
[INFO] ** i/f_dir-outbound:[1:99.99688%,0:0.00312%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85938%,1:26.14062%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38203%,1:17.61797%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76133%,1:18.23867%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:62.00234%,1:37.99766%]
[INFO] ** src-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** dst-0:[0:99.99609%,1:0.00391%]
[INFO] ** dst-192.168.1.10:[0:79.24375%,1:20.75625%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61875%,1:43.38125%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38281%,1:17.61719%]
[INFO] ** dst-192.168.1.40:[0:81.76094%,1:18.23906%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99609%,1:0.00391%]
[INFO] ** proto-tcp:[1:99.99609%,0:0.00391%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99609%,1:0.00391%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85938%,1:26.14062%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38203%,1:17.61797%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76133%,1:18.23867%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.00234%,1:37.99766%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75859%,1:17.24141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86094%,1:26.13906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.24453%,1:20.75547%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.3832%,1:17.6168%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76211%,1:18.23789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255995, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 74088,  74092,  74093, ..., 255994, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.5836 - tp: 148221.0000 - fp: 43779.0000 - tn: 724221.0000 - fn: 43779.0000 - accuracy: 0.9088 - precision: 0.7720 - recall: 0.7720 - auc: 0.9427 - val_loss: 0.3631 - val_tp: 57941.0000 - val_fp: 6059.0000 - val_tn: 249941.0000 - val_fn: 6059.0000 - val_accuracy: 0.9621 - val_precision: 0.9053 - val_recall: 0.9053 - val_auc: 0.9763
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-1792000-2048000
[INFO] processing batch 2048000-2304000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:704 (0.275%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.0012540954:0.00039%]
[INFO] ** s_port:[0.834280824:26.12969%,0.8139250565:20.76406%,0.8029830673999999:18.24258%,0.8149336757:17.61289%,0.8137722355:17.24648%,0.0:0.00273%,0.8030136315999999:0.00039%,0.8431597286:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:80.35703%,Single Stage Single Point:19.64297%]
[INFO] ** orig-192.168.1.48:[1:99.99766%,0:0.00234%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99766%,1:0.00234%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86992%,1:26.13008%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38672%,1:17.61328%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.75703%,1:18.24297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.98945%,1:38.01055%]
[INFO] ** src-192.168.1.88:[0:99.99766%,1:0.00234%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.23594%,1:20.76406%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.62383%,1:43.37617%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38711%,1:17.61289%]
[INFO] ** dst-192.168.1.40:[0:81.75742%,1:18.24258%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86992%,1:26.13008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38672%,1:17.61328%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75703%,1:18.24297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98945%,1:38.01055%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75352%,1:17.24648%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.87109%,1:26.12891%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.23594%,1:20.76406%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38711%,1:17.61289%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75742%,1:18.24258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Google Chrome': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      7, ..., 140271, 140272, 140276]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6241 - tp: 141714.0000 - fp: 50286.0000 - tn: 717714.0000 - fn: 50286.0000 - accuracy: 0.8952 - precision: 0.7381 - recall: 0.7381 - auc: 0.9342 - val_loss: 0.2502 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-2048000-2304000
[INFO] processing batch 2304000-2560000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0348324999:0.00039%,0.0021633145999999997:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.11992%,0.8139250565:20.79062%,0.8029830673999999:18.25898%,0.8149336757:17.61406%,0.8137722355:17.21367%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0339568433:0.00039%,0.0818051226:0.00039%,0.0021089309:0.00039%,0.2528119078:0.00039%,0.1074484993:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88008%,1:26.11992%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.38594%,1:17.61406%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.74023%,1:18.25977%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.9957%,1:38.0043%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.20859%,1:20.79141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66641%,1:43.33359%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.38594%,1:17.61406%]
[INFO] ** dst-192.168.1.40:[0:81.74102%,1:18.25898%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88008%,1:26.11992%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38594%,1:17.61406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74023%,1:18.25977%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.9957%,1:38.0043%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78633%,1:17.21367%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88008%,1:26.11992%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20977%,1:20.79023%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38633%,1:17.61367%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74102%,1:18.25898%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-239.192.4.191': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2530 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2066 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-2304000-2560000
[INFO] processing batch 2560000-2816000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65413 (25.55195%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.18945%,0.8139250565:20.77422%,0.8029830673999999:18.24023%,0.8149336757:17.56523%,0.8137722355:17.22891%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.80977%,1:26.19023%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43438%,1:17.56562%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.75938%,1:18.24062%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.99688%,1:38.00312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.22578%,1:20.77422%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.58125%,1:43.41875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.43438%,1:17.56562%]
[INFO] ** dst-192.168.1.40:[0:81.75938%,1:18.24062%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.80977%,1:26.19023%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43438%,1:17.56562%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75938%,1:18.24062%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.99688%,1:38.00312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.77109%,1:17.22891%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.81055%,1:26.18945%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22617%,1:20.77383%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43516%,1:17.56484%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75977%,1:18.24023%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2098 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1614 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-2560000-2816000
[INFO] processing batch 2816000-3072000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.98984%,0.0:0.01016%]
[INFO] ** modbus_transaction_id:64676 (25.26406%)
[INFO] ** service:[0.7025755984000001:99.98984%,0.0:0.00742%,0.0297847659:0.00078%,0.08394601119999999:0.00078%,0.0021476384:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.15078%,0.8139250565:20.64023%,0.8029830673999999:18.33633%,0.8149336757:17.66367%,0.8137722355:17.19766%,0.0:0.00742%,0.0020936488:0.00078%,0.9715599976:0.00039%,0.8059172320999999:0.00039%,0.980989058:0.00039%,0.0818051226:0.00039%,0.8738156367000001:0.00039%,0.0290360046:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:74.09414%,Single Stage Single Point:25.90586%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99258%,1:0.00742%]
[INFO] ** i/f_name-eth1:[1:99.99258%,0:0.00742%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99297%,1:0.00703%]
[INFO] ** i/f_dir-outbound:[1:99.99297%,0:0.00703%]
[INFO] ** src-0:[0:99.99258%,1:0.00742%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.84883%,1:26.15117%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.33594%,1:17.66406%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.66367%,1:18.33633%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:62.16211%,1:37.83789%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99258%,1:0.00742%]
[INFO] ** dst-192.168.1.10:[0:79.35977%,1:20.64023%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65156%,1:43.34844%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.33633%,1:17.66367%]
[INFO] ** dst-192.168.1.40:[0:81.66328%,1:18.33672%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99258%,1:0.00742%]
[INFO] ** proto-tcp:[1:99.98984%,0:0.01016%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:99.99258%,1:0.00742%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98984%,0:0.01016%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99258%,1:0.00742%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.84883%,1:26.15117%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.33594%,1:17.66406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.66367%,1:18.33633%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.16211%,1:37.83789%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.98984%,1:0.01016%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9875%,1:0.0125%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.80273%,1:17.19727%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.84961%,1:26.15039%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.35977%,1:20.64023%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.33633%,1:17.66367%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.66406%,1:18.33594%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255995, 255996, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [189681.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 71814,  71815,  71818, ..., 255993, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.5949 - tp: 148720.0000 - fp: 43280.0000 - tn: 724720.0000 - fn: 43280.0000 - accuracy: 0.9098 - precision: 0.7746 - recall: 0.7746 - auc: 0.9438 - val_loss: 0.7913 - val_tp: 40961.0000 - val_fp: 23039.0000 - val_tn: 232961.0000 - val_fn: 23039.0000 - val_accuracy: 0.8560 - val_precision: 0.6400 - val_recall: 0.6400 - val_auc: 0.9101
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-2816000-3072000
[INFO] processing batch 3072000-3328000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:54629 (21.33945%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00156%,0.0021633145999999997:0.00078%,0.0021476384:0.00078%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.14023%,0.8139250565:20.83086%,0.8029830673999999:18.17813%,0.8149336757:17.62773%,0.8137722355:17.21641%,0.0:0.00156%,0.8030136315999999:0.00078%,0.0021089309:0.00078%,0.0020936488:0.00078%,0.8343113882:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:76.36523%,Single Stage Single Point:23.63477%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8582%,1:26.1418%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.37188%,1:17.62812%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82109%,1:18.17891%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.95273%,1:38.04727%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:79.16914%,1:20.83086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64336%,1:43.35664%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.37188%,1:17.62812%]
[INFO] ** dst-192.168.1.40:[0:81.82148%,1:18.17852%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8582%,1:26.1418%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.37188%,1:17.62812%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82109%,1:18.17891%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.95273%,1:38.04727%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78359%,1:17.21641%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86016%,1:26.13984%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16914%,1:20.83086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.37266%,1:17.62734%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82188%,1:18.17813%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      6,      8, ..., 168921, 168922, 168923]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7204 - tp: 131495.0000 - fp: 60505.0000 - tn: 707495.0000 - fn: 60505.0000 - accuracy: 0.8739 - precision: 0.6849 - recall: 0.6849 - auc: 0.9209 - val_loss: 0.2213 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-3072000-3328000
[INFO] processing batch 3328000-3584000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:48170 (18.81641%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.08391465880000001:0.00078%,0.0:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.125%,0.8139250565:20.73086%,0.8029830673999999:18.2793%,0.8149336757:17.60469%,0.8137722355:17.25391%,0.0:0.00078%,0.0818051226:0.00078%,0.0020936488:0.00039%,0.814841983:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.0021089309:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.87461%,1:26.12539%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.39492%,1:17.60508%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.72031%,1:18.27969%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:62.01523%,1:37.98477%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.26914%,1:20.73086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6207%,1:43.3793%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.39531%,1:17.60469%]
[INFO] ** dst-192.168.1.40:[0:81.7207%,1:18.2793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.87461%,1:26.12539%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.39492%,1:17.60508%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72031%,1:18.27969%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.01523%,1:37.98477%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74609%,1:17.25391%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.87539%,1:26.12461%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.26914%,1:20.73086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.39531%,1:17.60469%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7207%,1:18.2793%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 8, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2291 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1919 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-3328000-3584000
[INFO] processing batch 3584000-3840000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00273%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00117%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.11992%,0.8139250565:20.84648%,0.8029830673999999:18.15625%,0.8149336757:17.56992%,0.8137722355:17.30234%,0.6452258696000001:0.00156%,0.0:0.00117%,0.8059172320999999:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.87969%,1:26.12031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42969%,1:17.57031%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.84336%,1:18.15664%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85117%,1:38.14883%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.15352%,1:20.84648%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.57773%,1:43.42227%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43008%,1:17.56992%]
[INFO] ** dst-192.168.1.40:[0:81.84219%,1:18.15781%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.87969%,1:26.12031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42969%,1:17.57031%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84336%,1:18.15664%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85117%,1:38.14883%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69766%,1:17.30234%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88086%,1:26.11914%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15352%,1:20.84648%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43047%,1:17.56953%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84375%,1:18.15625%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 3, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1951 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1569 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-3584000-3840000
[INFO] processing batch 3840000-4096000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.17852%,0.8139250565:20.77656%,0.8029830673999999:18.23789%,0.8149336757:17.56172%,0.8137722355:17.24063%,0.0:0.00117%,0.8711259856999999:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:81.93477%,Single Stage Single Point:18.06523%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8207%,1:26.1793%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76211%,1:18.23789%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.98281%,1:38.01719%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.22344%,1:20.77656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.58086%,1:43.41914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43789%,1:17.56211%]
[INFO] ** dst-192.168.1.40:[0:81.76133%,1:18.23867%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8207%,1:26.1793%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76211%,1:18.23789%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98281%,1:38.01719%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75977%,1:17.24023%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.82148%,1:26.17852%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22383%,1:20.77617%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43828%,1:17.56172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76211%,1:18.23789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([  2401,   2407,   2413, ..., 255980, 255989, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.5109 - tp: 157534.0000 - fp: 34466.0000 - tn: 733534.0000 - fn: 34466.0000 - accuracy: 0.9282 - precision: 0.8205 - recall: 0.8205 - auc: 0.9552 - val_loss: 0.4959 - val_tp: 52219.0000 - val_fp: 11781.0000 - val_tn: 244219.0000 - val_fn: 11781.0000 - val_accuracy: 0.9264 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.9540
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-3840000-4096000
[INFO] processing batch 4096000-4352000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:58132 (22.70781%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08391465880000001:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.11641%,0.8139250565:20.75781%,0.8029830673999999:18.28242%,0.8149336757:17.6%,0.8137722355:17.24141%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:99.29219%,Single Stage Single Point:0.70781%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8832%,1:26.1168%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.39961%,1:17.60039%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:62.00078%,1:37.99922%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.24219%,1:20.75781%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6418%,1:43.3582%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4%,1:17.6%]
[INFO] ** dst-192.168.1.40:[0:81.71758%,1:18.28242%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8832%,1:26.1168%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.39961%,1:17.60039%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.00078%,1:37.99922%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75859%,1:17.24141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88438%,1:26.11562%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.24219%,1:20.75781%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.40039%,1:17.59961%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71758%,1:18.28242%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([   4,    7,   13, ..., 9894, 9903, 9905]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.1939 - tp: 190188.0000 - fp: 1812.0000 - tn: 766188.0000 - fn: 1812.0000 - accuracy: 0.9962 - precision: 0.9906 - recall: 0.9906 - auc: 0.9976 - val_loss: 0.1433 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-4096000-4352000
[INFO] processing batch 4352000-4608000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:702 (0.27422%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00469%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:64698 (25.27266%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00234%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.14844%,0.8139250565:20.81289%,0.8029830673999999:18.23438%,0.8149336757:17.55586%,0.8137722355:17.24141%,0.0:0.00234%,0.6970474968000001:0.00156%,0.8166299895999999:0.00078%,0.8343113882:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_dir-outbound:[1:99.99766%,0:0.00234%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.44375%,1:17.55625%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76523%,1:18.23477%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.9457%,1:38.0543%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:79.18711%,1:20.81289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61016%,1:43.38984%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.44219%,1:17.55781%]
[INFO] ** dst-192.168.1.40:[0:81.76562%,1:18.23438%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44375%,1:17.55625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76523%,1:18.23477%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.9457%,1:38.0543%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99219%,1:0.00781%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75898%,1:17.24102%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85195%,1:26.14805%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.18711%,1:20.81289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44414%,1:17.55586%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76562%,1:18.23438%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 4, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1554 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1190 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-4352000-4608000
[INFO] processing batch 4608000-4864000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99609%,0.0:0.00391%]
[INFO] ** modbus_transaction_id:54680 (21.35938%)
[INFO] ** service:[0.7025755984000001:99.99609%,0.0:0.00234%,0.0021789908:0.00078%,0.08391465880000001:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.11484%,0.8139250565:20.79258%,0.8029830673999999:18.24414%,0.8149336757:17.55781%,0.8137722355:17.28555%,0.0:0.00234%,0.8831377224:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:88.0668%,Single Stage Single Point:11.9332%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4418%,1:17.5582%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.75547%,1:18.24453%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.92188%,1:38.07812%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:79.20742%,1:20.79258%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.59961%,1:43.40039%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44219%,1:17.55781%]
[INFO] ** dst-192.168.1.40:[0:81.75547%,1:18.24453%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99609%,0:0.00391%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4418%,1:17.5582%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75547%,1:18.24453%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.92188%,1:38.07812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99609%,1:0.00391%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71445%,1:17.28555%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88555%,1:26.11445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20742%,1:20.79258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44219%,1:17.55781%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75586%,1:18.24414%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 71810,  71813,  71819, ..., 157065, 157071, 157072]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.4838 - tp: 161451.0000 - fp: 30549.0000 - tn: 737451.0000 - fn: 30549.0000 - accuracy: 0.9364 - precision: 0.8409 - recall: 0.8409 - auc: 0.9601 - val_loss: 0.1297 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-4608000-4864000
[INFO] processing batch 4864000-5120000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:57519 (22.46836%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.1043%,0.8139250565:20.84141%,0.8029830673999999:18.19336%,0.8149336757:17.55039%,0.8137722355:17.30859%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89492%,1:26.10508%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44961%,1:17.55039%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80586%,1:18.19414%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85%,1:38.15%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.15859%,1:20.84141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.58672%,1:43.41328%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44922%,1:17.55078%]
[INFO] ** dst-192.168.1.40:[0:81.80625%,1:18.19375%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89492%,1:26.10508%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44961%,1:17.55039%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80586%,1:18.19414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85%,1:38.15%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69141%,1:17.30859%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89609%,1:26.10391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15898%,1:20.84102%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.45039%,1:17.54961%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80664%,1:18.19336%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1468 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1153 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-4864000-5120000
[INFO] processing batch 5120000-5376000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:62100 (24.25781%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.0957%,0.8139250565:20.8875%,0.8029830673999999:18.22148%,0.8149336757:17.5375%,0.8137722355:17.25469%,0.8059172320999999:0.00117%,0.814841983:0.00117%,0.8343113882:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90391%,1:26.09609%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.46133%,1:17.53867%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77852%,1:18.22148%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85781%,1:38.14219%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.1125%,1:20.8875%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64961%,1:43.35039%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4625%,1:17.5375%]
[INFO] ** dst-192.168.1.40:[0:81.77852%,1:18.22148%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90391%,1:26.09609%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.46133%,1:17.53867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77852%,1:18.22148%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85781%,1:38.14219%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7457%,1:17.2543%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90469%,1:26.09531%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.1125%,1:20.8875%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4625%,1:17.5375%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77891%,1:18.22109%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1312 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0968 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-5120000-5376000
[INFO] processing batch 5376000-5632000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.16484%,0.8139250565:20.91719%,0.8029830673999999:18.13555%,0.8149336757:17.49727%,0.8137722355:17.28086%,0.0:0.00117%,0.8166299895999999:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.83437%,1:26.16562%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.50195%,1:17.49805%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86406%,1:18.13594%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.80195%,1:38.19805%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.08281%,1:20.91719%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.5543%,1:43.4457%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.50234%,1:17.49766%]
[INFO] ** dst-192.168.1.40:[0:81.86367%,1:18.13633%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.83437%,1:26.16562%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50195%,1:17.49805%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86406%,1:18.13594%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.80195%,1:38.19805%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71914%,1:17.28086%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.83555%,1:26.16445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.08281%,1:20.91719%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50273%,1:17.49727%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86445%,1:18.13555%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1175 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0796 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-5376000-5632000
[INFO] processing batch 5632000-5888000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:704 (0.275%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.13164%,0.8139250565:20.83203%,0.8029830673999999:18.21758%,0.8149336757:17.55508%,0.8137722355:17.25898%,0.0:0.00273%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:85.86289%,Single Stage Single Point:14.13711%]
[INFO] ** orig-192.168.1.48:[1:99.99727%,0:0.00273%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86797%,1:26.13203%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44492%,1:17.55508%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.78164%,1:18.21836%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90898%,1:38.09102%]
[INFO] ** src-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.16797%,1:20.83203%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.60898%,1:43.39102%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44492%,1:17.55508%]
[INFO] ** dst-192.168.1.40:[0:81.78242%,1:18.21758%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86797%,1:26.13203%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44492%,1:17.55508%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.78164%,1:18.21836%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90898%,1:38.09102%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74102%,1:17.25898%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86875%,1:26.13125%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16797%,1:20.83203%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4457%,1:17.5543%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.78242%,1:18.21758%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 58699,  58701,  58705, ..., 159872, 159875, 159879]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.5747 - tp: 155809.0000 - fp: 36191.0000 - tn: 731809.0000 - fn: 36191.0000 - accuracy: 0.9246 - precision: 0.8115 - recall: 0.8115 - auc: 0.9527 - val_loss: 0.1053 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-5632000-5888000
[INFO] processing batch 5888000-6144000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99414%,0.0:0.00547%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:63474 (24.79453%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.08391465880000001:0.00117%,0.0021633145999999997:0.00078%,0.0021476384:0.00078%,0.0:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.09609%,0.8139250565:20.79141%,0.8029830673999999:18.28281%,0.8149336757:17.57773%,0.8137722355:17.2457%,0.705452656:0.00156%,0.0818051226:0.00117%,0.0021089309:0.00078%,0.0020936488:0.00078%,0.0:0.00078%,0.8345253376999999:0.00039%,0.0290360046:0.00039%,0.9842747112000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90352%,1:26.09648%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42227%,1:17.57773%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96289%,1:38.03711%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.20859%,1:20.79141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6582%,1:43.3418%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.42031%,1:17.57969%]
[INFO] ** dst-192.168.1.40:[0:81.71719%,1:18.28281%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99883%,1:0.00117%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.9957%,0:0.0043%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99414%,0:0.00586%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90352%,1:26.09648%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42227%,1:17.57773%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96289%,1:38.03711%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7543%,1:17.2457%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9043%,1:26.0957%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20859%,1:20.79141%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42227%,1:17.57773%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71719%,1:18.28281%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1241 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0975 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-5888000-6144000
[INFO] processing batch 6144000-6400000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.09102%,0.8139250565:20.84219%,0.8029830673999999:18.28203%,0.8149336757:17.53047%,0.8137722355:17.25%,0.8059172320999999:0.00117%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8876612262000001:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:84.0875%,Single Stage Single Point:15.9125%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9082%,1:26.0918%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.46875%,1:17.53125%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90781%,1:38.09219%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.15781%,1:20.84219%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65859%,1:43.34141%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.46953%,1:17.53047%]
[INFO] ** dst-192.168.1.40:[0:81.71758%,1:18.28242%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9082%,1:26.0918%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.46875%,1:17.53125%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90781%,1:38.09219%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75039%,1:17.24961%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90938%,1:26.09062%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15781%,1:20.84219%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.46953%,1:17.53047%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71797%,1:18.28203%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([142218, 142219, 142225, ..., 255993, 255994, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3369 - tp: 174156.0000 - fp: 17844.0000 - tn: 750156.0000 - fn: 17844.0000 - accuracy: 0.9628 - precision: 0.9071 - recall: 0.9071 - auc: 0.9769 - val_loss: 0.9399 - val_tp: 41108.0000 - val_fp: 22892.0000 - val_tn: 233108.0000 - val_fn: 22892.0000 - val_accuracy: 0.8569 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-6144000-6400000
[INFO] processing batch 6400000-6656000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.14219%,0.8139250565:20.80625%,0.8029830673999999:18.25117%,0.8149336757:17.57578%,0.8137722355:17.22266%,0.8166299895999999:0.00078%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:79.20547%,Single Stage Single Point:20.79453%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85781%,1:26.14219%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.42383%,1:17.57617%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74883%,1:18.25117%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97109%,1:38.02891%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.19375%,1:20.80625%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63516%,1:43.36484%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.42422%,1:17.57578%]
[INFO] ** dst-192.168.1.40:[0:81.74844%,1:18.25156%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85781%,1:26.14219%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42383%,1:17.57617%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74883%,1:18.25117%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97109%,1:38.02891%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.77734%,1:17.22266%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85781%,1:26.14219%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19414%,1:20.80586%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.425%,1:17.575%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74922%,1:18.25078%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      7, ..., 148577, 148583, 148584]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7465 - tp: 138766.0000 - fp: 53234.0000 - tn: 714766.0000 - fn: 53234.0000 - accuracy: 0.8891 - precision: 0.7227 - recall: 0.7227 - auc: 0.9309 - val_loss: 0.1259 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-6400000-6656000
[INFO] processing batch 6656000-6912000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65197 (25.46758%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.11367%,0.8139250565:20.77734%,0.8029830673999999:18.2707%,0.8149336757:17.58906%,0.8137722355:17.24609%,0.8030136315999999:0.00078%,0.8343113882:0.00078%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.72812%,1:18.27188%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97656%,1:38.02344%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.22266%,1:20.77734%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63984%,1:43.36016%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.41055%,1:17.58945%]
[INFO] ** dst-192.168.1.40:[0:81.7293%,1:18.2707%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72812%,1:18.27188%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97656%,1:38.02344%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75391%,1:17.24609%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88711%,1:26.11289%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22266%,1:20.77734%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41094%,1:17.58906%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7293%,1:18.2707%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1390 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1174 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-6656000-6912000
[INFO] processing batch 6912000-7168000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:59892 (23.39531%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.1043%,0.8139250565:20.79102%,0.8029830673999999:18.27422%,0.8149336757:17.5875%,0.8137722355:17.23945%,0.8059172320999999:0.00078%,0.8343113882:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8344030809:0.00039%]
[INFO] ** classification:[normal:99.99883%,Single Stage Single Point:0.00117%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89453%,1:26.10547%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4125%,1:17.5875%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.72539%,1:18.27461%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96953%,1:38.03047%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.20898%,1:20.79102%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65625%,1:43.34375%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4125%,1:17.5875%]
[INFO] ** dst-192.168.1.40:[0:81.72539%,1:18.27461%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89453%,1:26.10547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4125%,1:17.5875%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72539%,1:18.27461%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96953%,1:38.03047%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.76094%,1:17.23906%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89609%,1:26.10391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20898%,1:20.79102%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41328%,1:17.58672%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.72578%,1:18.27422%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [255997.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 90086, 134127, 239267]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1256 - tp: 191998.0000 - fp: 2.0000 - tn: 767998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1023 - val_tp: 63999.0000 - val_fp: 1.0000 - val_tn: 255999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-6912000-7168000
[INFO] processing batch 7168000-7424000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:706 (0.27578%)
[INFO] ** modbus_function_code:[0.9743589744:99.99453%,0.0:0.00547%]
[INFO] ** modbus_transaction_id:64992 (25.3875%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0:0.0043%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.03359%,0.8139250565:20.78242%,0.8029830673999999:18.34414%,0.8149336757:17.58828%,0.8137722355:17.24375%,0.0:0.0043%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.9344397579000001:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:92.32148%,Single Stage Multi Point:7.67812%,Single Stage Single Point:0.00039%]
[INFO] ** orig-192.168.1.48:[1:99.9957%,0:0.0043%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.9957%,1:0.0043%]
[INFO] ** i/f_name-eth1:[1:99.9957%,0:0.0043%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.9957%,1:0.0043%]
[INFO] ** i/f_dir-outbound:[1:99.9957%,0:0.0043%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.96562%,1:26.03437%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.65586%,1:18.34414%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97383%,1:38.02617%]
[INFO] ** src-192.168.1.88:[0:99.99492%,1:0.00508%]
[INFO] ** dst-0:[0:99.9957%,1:0.0043%]
[INFO] ** dst-192.168.1.10:[0:79.21719%,1:20.78281%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.72266%,1:43.27734%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.41133%,1:17.58867%]
[INFO] ** dst-192.168.1.40:[0:81.65508%,1:18.34492%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.9957%,1:0.0043%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99453%,0:0.00547%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.9957%,1:0.0043%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.96562%,1:26.03437%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.65586%,1:18.34414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97383%,1:38.02617%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9918%,1:0.0082%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75625%,1:17.24375%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9668%,1:26.0332%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.21758%,1:20.78242%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41172%,1:17.58828%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.65586%,1:18.34414%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 3, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255993, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [236343.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([849]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([213902, 213904, 213905, ..., 255995, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 1.96560e+04 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 1.96560e+04 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 1.96560e+04 0.00000e+00 0.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1133 - tp: 191999.0000 - fp: 1.0000 - tn: 767999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0111 - val_tp: 44344.0000 - val_fp: 19656.0000 - val_tn: 236344.0000 - val_fn: 19656.0000 - val_accuracy: 0.8772 - val_precision: 0.6929 - val_recall: 0.6929 - val_auc: 0.7697
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-7168000-7424000
[INFO] processing batch 7424000-7680000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:706 (0.27578%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:59138 (23.10078%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00352%]
[INFO] ** s_port:[0.834280824:26.08906%,0.8139250565:20.78789%,0.8029830673999999:18.26367%,0.8149336757:17.61172%,0.8137722355:17.24219%,0.0:0.00352%,0.8059172320999999:0.00078%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:59.34414%,Single Stage Multi Point:40.65586%]
[INFO] ** orig-192.168.1.48:[1:99.99648%,0:0.00352%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** i/f_name-eth1:[1:99.99648%,0:0.00352%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99648%,1:0.00352%]
[INFO] ** i/f_dir-outbound:[1:99.99648%,0:0.00352%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.91055%,1:26.08945%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38789%,1:17.61211%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.73594%,1:18.26406%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96992%,1:38.03008%]
[INFO] ** src-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** dst-0:[0:99.99648%,1:0.00352%]
[INFO] ** dst-192.168.1.10:[0:79.21211%,1:20.78789%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66836%,1:43.33164%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38828%,1:17.61172%]
[INFO] ** dst-192.168.1.40:[0:81.73633%,1:18.26367%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99648%,1:0.00352%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99648%,1:0.00352%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.91055%,1:26.08945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38789%,1:17.61211%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.73594%,1:18.26406%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96992%,1:38.03008%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7582%,1:17.2418%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.91094%,1:26.08906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.2125%,1:20.7875%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38828%,1:17.61172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.73672%,1:18.26328%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([     1,      4,      5, ..., 222071, 222075, 222076]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0. 104079.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0. 104079.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0. 104079.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 2.7639 - tp: 102062.0000 - fp: 89938.0000 - tn: 678062.0000 - fn: 89938.0000 - accuracy: 0.8126 - precision: 0.5316 - recall: 0.5316 - auc: 0.6561 - val_loss: 1.2442 - val_tp: 49859.0000 - val_fp: 14141.0000 - val_tn: 241859.0000 - val_fn: 14141.0000 - val_accuracy: 0.9116 - val_precision: 0.7790 - val_recall: 0.7790 - val_auc: 0.8619
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-7424000-7680000
[INFO] processing batch 7680000-7936000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:698 (0.27266%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:63218 (24.69453%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.09844%,0.8139250565:20.80234%,0.8029830673999999:18.25859%,0.8149336757:17.5832%,0.8137722355:17.25547%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90078%,1:26.09922%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41641%,1:17.58359%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74102%,1:18.25898%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.94219%,1:38.05781%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.19727%,1:20.80273%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64609%,1:43.35391%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.41641%,1:17.58359%]
[INFO] ** dst-192.168.1.40:[0:81.74141%,1:18.25859%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90078%,1:26.09922%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41641%,1:17.58359%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74102%,1:18.25898%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.94219%,1:38.05781%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74453%,1:17.25547%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90234%,1:26.09766%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19766%,1:20.80234%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41758%,1:17.58242%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74141%,1:18.25859%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1305 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1169 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-7680000-7936000
[INFO] processing batch 7936000-8192000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99414%,0.0:0.00547%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.002116286:0.00117%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.14844%,0.8139250565:20.83828%,0.8029830673999999:18.2082%,0.8149336757:17.56406%,0.8137722355:17.2332%,0.8868054282:0.00156%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.7673146279999999:0.00039%,0.8345253376999999:0.00039%,0.0290360046:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.7788831836:0.00039%,0.8870957883:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.9156580476:0.00039%,0.8881655358:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43594%,1:17.56406%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79102%,1:18.20898%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.92852%,1:38.07148%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.16172%,1:20.83828%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61797%,1:43.38203%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.43555%,1:17.56445%]
[INFO] ** dst-192.168.1.40:[0:81.78984%,1:18.21016%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99414%,0:0.00586%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43594%,1:17.56406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79102%,1:18.20898%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.92852%,1:38.07148%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99102%,1:0.00898%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7668%,1:17.2332%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85156%,1:26.14844%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16211%,1:20.83789%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43672%,1:17.56328%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7918%,1:18.2082%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1211 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1065 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-7936000-8192000
[INFO] processing batch 8192000-8448000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65522 (25.59453%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.08555%,0.8139250565:20.85859%,0.8029830673999999:18.1793%,0.8149336757:17.63516%,0.8137722355:17.23984%,0.8059172320999999:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:87.94922%,Multi Stage Multi Point:12.05078%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.91406%,1:26.08594%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.36445%,1:17.63555%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90156%,1:38.09844%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.14141%,1:20.85859%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67461%,1:43.32539%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.36484%,1:17.63516%]
[INFO] ** dst-192.168.1.40:[0:81.8207%,1:18.1793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.91406%,1:26.08594%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.36445%,1:17.63555%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90156%,1:38.09844%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.76016%,1:17.23984%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.91484%,1:26.08516%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.14141%,1:20.85859%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.36484%,1:17.63516%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82109%,1:18.17891%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([ 25682,  25685,  25695, ..., 195376, 195386, 195390]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.  30850.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9496 - tp: 161781.0000 - fp: 30219.0000 - tn: 737781.0000 - fn: 30219.0000 - accuracy: 0.9370 - precision: 0.8426 - recall: 0.8426 - auc: 0.8719 - val_loss: 0.1577 - val_tp: 63369.0000 - val_fp: 631.0000 - val_tn: 255369.0000 - val_fn: 631.0000 - val_accuracy: 0.9961 - val_precision: 0.9901 - val_recall: 0.9901 - val_auc: 0.9926
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-8192000-8448000
[INFO] processing batch 8448000-8704000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:56456 (22.05313%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.002116286:0.00117%,0.0:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.10742%,0.8139250565:20.80391%,0.8029830673999999:18.28828%,0.8149336757:17.5793%,0.8137722355:17.21602%,0.8030136315999999:0.00078%,0.0:0.00078%,0.9104621309:0.00039%,0.8591448133:0.00039%,0.8916498562999999:0.00039%,0.7788831836:0.00039%,0.7891527599:0.00039%,0.8870957883:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:63.66172%,Multi Stage Multi Point:36.33828%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89219%,1:26.10781%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42031%,1:17.57969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71094%,1:18.28906%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.98008%,1:38.01992%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.19609%,1:20.80391%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67656%,1:43.32344%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.4207%,1:17.5793%]
[INFO] ** dst-192.168.1.40:[0:81.71172%,1:18.28828%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89219%,1:26.10781%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42031%,1:17.57969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71094%,1:18.28906%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98008%,1:38.01992%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78398%,1:17.21602%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89258%,1:26.10742%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19648%,1:20.80352%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42109%,1:17.57891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71211%,1:18.28789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([ 11294,  11295,  11297, ..., 255992, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.  93026.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.8570 - tp: 123282.0000 - fp: 68718.0000 - tn: 699282.0000 - fn: 68718.0000 - accuracy: 0.8568 - precision: 0.6421 - recall: 0.6421 - auc: 0.7296 - val_loss: 1.8655 - val_tp: 39692.0000 - val_fp: 24308.0000 - val_tn: 231692.0000 - val_fn: 24308.0000 - val_accuracy: 0.8481 - val_precision: 0.6202 - val_recall: 0.6202 - val_auc: 0.7151
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-8448000-8704000
[INFO] processing batch 8704000-8960000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:63796 (24.92031%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.09102%,0.8139250565:20.85859%,0.8029830673999999:18.25273%,0.8149336757:17.52617%,0.8137722355:17.26953%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:98.44844%,Multi Stage Multi Point:1.55156%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90742%,1:26.09258%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47383%,1:17.52617%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74688%,1:18.25312%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.87188%,1:38.12813%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.14141%,1:20.85859%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63906%,1:43.36094%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47344%,1:17.52656%]
[INFO] ** dst-192.168.1.40:[0:81.74688%,1:18.25312%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90742%,1:26.09258%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47383%,1:17.52617%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74688%,1:18.25312%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.87188%,1:38.12813%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.73086%,1:17.26914%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90977%,1:26.09023%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.14141%,1:20.85859%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47383%,1:17.52617%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74727%,1:18.25273%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([    4,     6,     9, ..., 10386, 10388, 10391]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.   3972.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2208 - tp: 188028.0000 - fp: 3972.0000 - tn: 764028.0000 - fn: 3972.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9848 - val_loss: 0.1172 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-8704000-8960000
[INFO] processing batch 8960000-9216000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.9957%,0.0:0.00391%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57363 (22.40742%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.07148%,0.8139250565:20.81289%,0.8029830673999999:18.23047%,0.8149336757:17.57383%,0.8137722355:17.30469%,0.7579772602:0.00156%,0.8059172320999999:0.00078%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.8262729995999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.0290360046:0.00039%,0.0020936488:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.92812%,1:26.07188%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42578%,1:17.57422%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76875%,1:18.23125%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.88242%,1:38.11758%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.18711%,1:20.81289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.62188%,1:43.37812%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.42617%,1:17.57383%]
[INFO] ** dst-192.168.1.40:[0:81.76914%,1:18.23086%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9957%,0:0.0043%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.92812%,1:26.07188%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42578%,1:17.57422%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76875%,1:18.23125%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.88242%,1:38.11758%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99609%,1:0.00391%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69531%,1:17.30469%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.92891%,1:26.07109%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.18711%,1:20.81289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42656%,1:17.57344%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76953%,1:18.23047%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 6, 'type-alert': 2, 'type-log': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1191 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1080 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-8960000-9216000
[INFO] processing batch 9216000-9472000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:61876 (24.17031%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.1332%,0.8139250565:20.83086%,0.8029830673999999:18.15234%,0.8149336757:17.59102%,0.8137722355:17.29141%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:72.04688%,Single Stage Multi Point:27.95312%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86602%,1:26.13398%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.40898%,1:17.59102%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.87773%,1:38.12227%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.16914%,1:20.83086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.57539%,1:43.42461%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.40859%,1:17.59141%]
[INFO] ** dst-192.168.1.40:[0:81.84766%,1:18.15234%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86602%,1:26.13398%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.40898%,1:17.59102%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.87773%,1:38.12227%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.70859%,1:17.29141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86719%,1:26.13281%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16953%,1:20.83047%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.40898%,1:17.59102%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84805%,1:18.15195%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([ 46464,  46465,  46466, ..., 163814, 163816, 163819]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.  71560.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.  71560.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.  71560.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.8547 - tp: 120440.0000 - fp: 71560.0000 - tn: 696440.0000 - fn: 71560.0000 - accuracy: 0.8509 - precision: 0.6273 - recall: 0.6273 - auc: 0.7306 - val_loss: 0.1230 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-9216000-9472000
[INFO] processing batch 9472000-9728000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00547%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.13047%,0.8139250565:20.83359%,0.8029830673999999:18.22422%,0.8149336757:17.54023%,0.8137722355:17.26289%,0.0:0.00547%,0.814841983:0.00078%,0.9715599976:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:83.99258%,Single Stage Multi Point:16.00742%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_name-eth1:[1:99.99453%,0:0.00547%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99453%,1:0.00547%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86875%,1:26.13125%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.45859%,1:17.54141%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77578%,1:18.22422%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.90352%,1:38.09648%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99453%,1:0.00547%]
[INFO] ** dst-192.168.1.10:[0:79.16641%,1:20.83359%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.60664%,1:43.39336%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.45977%,1:17.54023%]
[INFO] ** dst-192.168.1.40:[0:81.775%,1:18.225%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99453%,1:0.00547%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99453%,1:0.00547%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86875%,1:26.13125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.45859%,1:17.54141%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77578%,1:18.22422%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90352%,1:38.09648%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99023%,1:0.00977%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7375%,1:17.2625%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86992%,1:26.13008%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16641%,1:20.83359%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.46016%,1:17.53984%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77578%,1:18.22422%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([ 25270,  25279,  25287, ..., 249670, 249676, 249686]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.  40979.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.  40979.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.  40979.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8111 - tp: 161553.0000 - fp: 30447.0000 - tn: 737553.0000 - fn: 30447.0000 - accuracy: 0.9366 - precision: 0.8414 - recall: 0.8414 - auc: 0.8878 - val_loss: 0.8206 - val_tp: 53468.0000 - val_fp: 10532.0000 - val_tn: 245468.0000 - val_fn: 10532.0000 - val_accuracy: 0.9342 - val_precision: 0.8354 - val_recall: 0.8354 - val_auc: 0.8971
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-9472000-9728000
[INFO] processing batch 9728000-9984000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:63091 (24.64492%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.09727%,0.8139250565:20.87695%,0.8029830673999999:18.14492%,0.8149336757:17.58789%,0.8137722355:17.28906%,0.8030136315999999:0.00078%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90195%,1:26.09805%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41172%,1:17.58828%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85391%,1:18.14609%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.83398%,1:38.16602%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.12305%,1:20.87695%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61328%,1:43.38672%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.41172%,1:17.58828%]
[INFO] ** dst-192.168.1.40:[0:81.85508%,1:18.14492%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90195%,1:26.09805%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41172%,1:17.58828%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85391%,1:18.14609%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.83398%,1:38.16602%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71094%,1:17.28906%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90312%,1:26.09688%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.12344%,1:20.87656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4125%,1:17.5875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85508%,1:18.14492%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1283 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1207 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-9728000-9984000
[INFO] processing batch 9984000-10240000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:58560 (22.875%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.002116286:0.00117%,0.0012540954:0.00039%]
[INFO] ** s_port:[0.834280824:25.95625%,0.8139250565:21.02656%,0.8029830673999999:18.18047%,0.8149336757:17.49258%,0.8137722355:17.33984%,0.8059172320999999:0.00117%,0.8030136315999999:0.00039%,0.7918882572:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8985420868999999:0.00039%,0.9339660126:0.00039%,0.7788831836:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04258%,1:25.95742%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50742%,1:17.49258%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.81914%,1:18.18086%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.63359%,1:38.36641%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97344%,1:21.02656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70391%,1:43.29609%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50703%,1:17.49297%]
[INFO] ** dst-192.168.1.40:[0:81.81914%,1:18.18086%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04258%,1:25.95742%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50742%,1:17.49258%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.81914%,1:18.18086%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63359%,1:38.36641%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04453%,1:25.95547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97344%,1:21.02656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50781%,1:17.49219%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.81953%,1:18.18047%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1195 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1116 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-9984000-10240000
[INFO] processing batch 10240000-10496000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0:0.00273%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.01641%,0.8139250565:20.95156%,0.8029830673999999:18.13867%,0.8149336757:17.55234%,0.8137722355:17.33281%,0.0:0.00273%,0.7414573018:0.00156%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.8935448376999999:0.00039%,0.0290360046:0.00039%,0.0020936488:0.00039%]
[INFO] ** classification:[normal:87.29883%,Multi Stage Single Point:12.70117%]
[INFO] ** orig-192.168.1.48:[1:99.99727%,0:0.00273%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.98359%,1:26.01641%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44687%,1:17.55313%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86094%,1:18.13906%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.71562%,1:38.28437%]
[INFO] ** src-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.04688%,1:20.95312%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65078%,1:43.34922%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.44766%,1:17.55234%]
[INFO] ** dst-192.168.1.40:[0:81.86133%,1:18.13867%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99453%,0:0.00547%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.98359%,1:26.01641%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44687%,1:17.55313%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86094%,1:18.13906%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.71562%,1:38.28437%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99102%,1:0.00898%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66719%,1:17.33281%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98359%,1:26.01641%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.04883%,1:20.95117%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44766%,1:17.55234%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86172%,1:18.13828%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [223485.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [223485.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [223485.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([186683, 186685, 186690, ..., 255994, 255995, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [223485.      0.      0.  32515.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [223485.      0.      0.  32515.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1729 - tp: 189510.0000 - fp: 2490.0000 - tn: 765510.0000 - fn: 2490.0000 - accuracy: 0.9948 - precision: 0.9870 - recall: 0.9870 - auc: 0.9892 - val_loss: 2.3346 - val_tp: 33975.0000 - val_fp: 30025.0000 - val_tn: 225975.0000 - val_fn: 30025.0000 - val_accuracy: 0.8123 - val_precision: 0.5309 - val_recall: 0.5309 - val_auc: 0.5895
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-10240000-10496000
[INFO] processing batch 10496000-10752000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:705 (0.27539%)
[INFO] ** modbus_function_code:[0.9743589744:99.99219%,0.0:0.00781%]
[INFO] ** modbus_transaction_id:60618 (23.67891%)
[INFO] ** service:[0.7025755984000001:99.99219%,0.0:0.00664%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.97539%,0.8139250565:21.02148%,0.8029830673999999:18.08672%,0.8149336757:17.56211%,0.8137722355:17.34375%,0.0:0.00664%,0.9004676325:0.00078%,0.8343113882:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:53.00195%,Multi Stage Single Point:46.99805%]
[INFO] ** orig-192.168.1.48:[1:99.99492%,0:0.00508%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99766%,1:0.00234%]
[INFO] ** type-log:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_name-eth1:[1:99.99336%,0:0.00664%]
[INFO] ** i/f_name-geod daemon:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-inbound:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_dir-outbound:[1:99.99375%,0:0.00625%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02344%,1:25.97656%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.63477%,1:38.36523%]
[INFO] ** src-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** dst-0:[0:99.99336%,1:0.00664%]
[INFO] ** dst-192.168.1.10:[0:78.97852%,1:21.02148%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.68086%,1:43.31914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43789%,1:17.56211%]
[INFO] ** dst-192.168.1.40:[0:81.9125%,1:18.0875%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99336%,1:0.00664%]
[INFO] ** proto-tcp:[1:99.99297%,0:0.00703%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99336%,1:0.00664%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99219%,0:0.00781%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99336%,1:0.00664%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02344%,1:25.97656%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63477%,1:38.36523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99219%,1:0.00781%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98828%,1:0.01172%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65625%,1:17.34375%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02539%,1:25.97461%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97852%,1:21.02148%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43828%,1:17.56172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91328%,1:18.08672%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_name-geod daemon': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      4,      5, ..., 255995, 255996, 255997]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [135685.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [135685.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [135685.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     0,      1,      3, ..., 255992, 255998, 255999]),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [135685.      0.      0. 120315.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [135685.      0.      0. 120315.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 2.2120 - tp: 101670.0000 - fp: 90330.0000 - tn: 677670.0000 - fn: 90330.0000 - accuracy: 0.8118 - precision: 0.5295 - recall: 0.5295 - auc: 0.6421 - val_loss: 2.0539 - val_tp: 34015.0000 - val_fp: 29985.0000 - val_tn: 226015.0000 - val_fn: 29985.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.5900
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-10496000-10752000
[INFO] processing batch 10752000-11008000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:702 (0.27422%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00508%]
[INFO] ** modbus_transaction_id:49732 (19.42656%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0:0.00469%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.95898%,0.8139250565:21.05586%,0.8029830673999999:18.11641%,0.8149336757:17.46875%,0.8137722355:17.39375%,0.0:0.00469%,0.0818051226:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:61.98516%,Multi Stage Single Point:38.01484%]
[INFO] ** orig-192.168.1.48:[1:99.99648%,0:0.00352%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_name-eth1:[1:99.99531%,0:0.00469%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04023%,1:25.95977%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53086%,1:17.46914%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55039%,1:38.44961%]
[INFO] ** src-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** dst-0:[0:99.99531%,1:0.00469%]
[INFO] ** dst-192.168.1.10:[0:78.94414%,1:21.05586%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64727%,1:43.35273%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53086%,1:17.46914%]
[INFO] ** dst-192.168.1.40:[0:81.88359%,1:18.11641%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99531%,1:0.00469%]
[INFO] ** proto-tcp:[1:99.99492%,0:0.00508%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99531%,1:0.00469%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99531%,1:0.00469%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04023%,1:25.95977%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53086%,1:17.46914%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55039%,1:38.44961%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99492%,1:0.00508%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60625%,1:17.39375%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04102%,1:25.95898%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94453%,1:21.05547%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53164%,1:17.46836%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88398%,1:18.11602%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      5,      6, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     0,      1,      3, ..., 206898, 206899, 206901]),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.  97318.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.  97318.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.9522 - tp: 101693.0000 - fp: 90307.0000 - tn: 677693.0000 - fn: 90307.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.7113 - val_loss: 0.5499 - val_tp: 56989.0000 - val_fp: 7011.0000 - val_tn: 248989.0000 - val_fn: 7011.0000 - val_accuracy: 0.9562 - val_precision: 0.8905 - val_recall: 0.8905 - val_auc: 0.9452
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-10752000-11008000
[INFO] processing batch 11008000-11264000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:46761 (18.26602%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.97266%,0.8139250565:21.02031%,0.8029830673999999:18.12383%,0.8149336757:17.52305%,0.8137722355:17.35781%,0.8059172320999999:0.00117%,0.8030136315999999:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02734%,1:25.97266%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47695%,1:17.52305%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87539%,1:18.12461%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.62188%,1:38.37813%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.97969%,1:21.02031%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66914%,1:43.33086%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47695%,1:17.52305%]
[INFO] ** dst-192.168.1.40:[0:81.87617%,1:18.12383%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02734%,1:25.97266%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47695%,1:17.52305%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87539%,1:18.12461%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.62188%,1:38.37813%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64258%,1:17.35742%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02773%,1:25.97227%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97969%,1:21.02031%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47695%,1:17.52305%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87617%,1:18.12383%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1551 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1505 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-11008000-11264000
[INFO] processing batch 11264000-11520000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:56871 (22.21523%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00078%]
[INFO] ** s_port:[0.834280824:26.01133%,0.8139250565:20.98555%,0.8029830673999999:18.14258%,0.8149336757:17.52539%,0.8137722355:17.33125%,0.8166299895999999:0.00078%,0.8147502904:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9875%,1:26.0125%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.47344%,1:17.52656%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85703%,1:18.14297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.6832%,1:38.3168%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.01406%,1:20.98594%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65742%,1:43.34258%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47422%,1:17.52578%]
[INFO] ** dst-192.168.1.40:[0:81.85625%,1:18.14375%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9875%,1:26.0125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47344%,1:17.52656%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85703%,1:18.14297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.6832%,1:38.3168%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00195%,0:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66914%,1:17.33086%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98906%,1:26.01094%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01445%,1:20.98555%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.475%,1:17.525%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85742%,1:18.14258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.1451 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1396 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-11264000-11520000
[INFO] processing batch 11520000-11776000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.98789%,0.0:0.01094%,0.9871794872:0.00039%,1.0:0.00039%,0.9615384615000001:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99023%,0.0:0.00586%,0.0021633145999999997:0.00117%,0.0297847659:0.00078%,0.08394601119999999:0.00078%,0.08391465880000001:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.95625%,0.8139250565:21.00703%,0.8029830673999999:18.13984%,0.8149336757:17.50117%,0.8137722355:17.38242%,0.0:0.00586%,0.7077908184999999:0.00156%,0.0021089309:0.00117%,0.45597224770000006:0.00078%,0.0818051226:0.00078%,0.8343113882:0.00039%,0.814841983:0.00039%,0.9034629256000001:0.00039%,0.9715599976:0.00039%,0.0020936488:0.00039%,0.0290360046:0.00039%,0.8059172320999999:0.00039%,0.9535729568000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99922%,1:0.00078%]
[INFO] ** type-control:[0:99.99883%,1:0.00117%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** i/f_name-eth1:[1:99.99414%,0:0.00586%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_dir-outbound:[1:99.99453%,0:0.00547%]
[INFO] ** src-0:[0:99.99414%,1:0.00586%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04336%,1:25.95664%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49844%,1:17.50156%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86016%,1:18.13984%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.61055%,1:38.38945%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99414%,1:0.00586%]
[INFO] ** dst-192.168.1.10:[0:78.99297%,1:21.00703%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66133%,1:43.33867%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.49648%,1:17.50352%]
[INFO] ** dst-192.168.1.40:[0:81.86016%,1:18.13984%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99414%,1:0.00586%]
[INFO] ** proto-tcp:[1:99.99023%,0:0.00977%]
[INFO] ** proto-udp:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** appi_name-CIP_func75:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98789%,0:0.01211%]
[INFO] ** appi_name-CIP_write_tag_service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99414%,1:0.00586%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04336%,1:25.95664%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49844%,1:17.50156%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86016%,1:18.13984%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.61055%,1:38.38945%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.98906%,1:0.01094%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00664%,1:49.99336%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Write Tag Service:[0:99.99961%,1:0.00039%]
[INFO] ** scada_tag-0:[0:99.98594%,1:0.01406%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61758%,1:17.38242%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04414%,1:25.95586%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.99297%,1:21.00703%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49883%,1:17.50117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86055%,1:18.13945%]
[INFO] columns with count within 2-10 {'modbus_function_code': 5, 'service': 7, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_func75': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-CIP_write_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'modbus_function_description-Unknown Function Code': 2, 'modbus_function_description-Write Tag Service': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.1349 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1299 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-11520000-11776000
[INFO] processing batch 11776000-12032000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:65188 (25.46406%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00156%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.99336%,0.8139250565:21.06289%,0.8029830673999999:18.05547%,0.8149336757:17.50742%,0.8137722355:17.37539%,0.0:0.00156%,0.8059172320999999:0.00078%,0.905082829:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:77.16641%,Multi Stage Single Point:22.83359%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00547%,1:25.99453%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49219%,1:17.50781%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.94414%,1:18.05586%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.56172%,1:38.43828%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:78.93711%,1:21.06289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.63125%,1:43.36875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49219%,1:17.50781%]
[INFO] ** dst-192.168.1.40:[0:81.94414%,1:18.05586%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00547%,1:25.99453%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49219%,1:17.50781%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.94414%,1:18.05586%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56172%,1:38.43828%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62461%,1:17.37539%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00664%,1:25.99336%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93711%,1:21.06289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49336%,1:17.50664%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.94453%,1:18.05547%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [197546.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [197546.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [197546.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([ 91957,  91958,  91961, ..., 255989, 255993, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [197546.      0.      0.  58454.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [197546.      0.      0.  58454.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8175 - tp: 156412.0000 - fp: 35588.0000 - tn: 732412.0000 - fn: 35588.0000 - accuracy: 0.9259 - precision: 0.8146 - recall: 0.8146 - auc: 0.9008 - val_loss: 1.4341 - val_tp: 41134.0000 - val_fp: 22866.0000 - val_tn: 233134.0000 - val_fn: 22866.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.8214
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-11776000-12032000
[INFO] processing batch 12032000-12288000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00508%]
[INFO] ** modbus_transaction_id:62510 (24.41797%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0208806885:0.00156%,0.0021476384:0.00117%,0.0:0.00078%,0.08394601119999999:0.00039%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.95039%,0.8139250565:21.01641%,0.8029830673999999:18.12734%,0.8149336757:17.51797%,0.8137722355:17.38125%,0.0020936488:0.00117%,0.0:0.00078%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.8147502904:0.00039%,0.8059172320999999:0.00039%,0.8876612262000001:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.8030136315999999:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:64.35391%,Multi Stage Single Point:35.64609%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04961%,1:25.95039%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.48164%,1:17.51836%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87188%,1:18.12812%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.60234%,1:38.39766%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.98359%,1:21.01641%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66797%,1:43.33203%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.48203%,1:17.51797%]
[INFO] ** dst-192.168.1.40:[0:81.87227%,1:18.12773%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04961%,1:25.95039%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48164%,1:17.51836%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87188%,1:18.12812%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.60234%,1:38.39766%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99492%,1:0.00508%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9918%,1:0.0082%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61914%,1:17.38086%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.05039%,1:25.94961%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.98398%,1:21.01602%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.48203%,1:17.51797%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87266%,1:18.12734%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 8, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     4,      5,      7, ..., 255993, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.  91254.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.  91254.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.3978 - tp: 123527.0000 - fp: 68473.0000 - tn: 699527.0000 - fn: 68473.0000 - accuracy: 0.8573 - precision: 0.6434 - recall: 0.6434 - auc: 0.8216 - val_loss: 1.3647 - val_tp: 41219.0000 - val_fp: 22781.0000 - val_tn: 233219.0000 - val_fn: 22781.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.8220
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-12032000-12288000
[INFO] processing batch 12288000-12544000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:61654 (24.08359%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00117%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.93789%,0.8139250565:21.06484%,0.8029830673999999:18.15703%,0.8149336757:17.45625%,0.8137722355:17.3793%,0.814841983:0.00117%,0.0:0.00117%,0.2528119078:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.8465523565:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.38594%,Multi Stage Single Point:28.27344%,Single Stage Single Point:7.34063%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06133%,1:25.93867%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54258%,1:17.45742%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55586%,1:38.44414%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.93438%,1:21.06562%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68281%,1:43.31719%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54336%,1:17.45664%]
[INFO] ** dst-192.168.1.40:[0:81.84297%,1:18.15703%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06133%,1:25.93867%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54258%,1:17.45742%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55586%,1:38.44414%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6207%,1:17.3793%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06211%,1:25.93789%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93516%,1:21.06484%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54375%,1:17.45625%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84336%,1:18.15664%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 3, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([203060, 203067, 203071, ..., 255992, 255993, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     1,      2,      5, ..., 203055, 203056, 203057]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.  72380.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.  72380.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.3422 - tp: 123560.0000 - fp: 68440.0000 - tn: 699560.0000 - fn: 68440.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.8218 - val_loss: 1.0748 - val_tp: 41268.0000 - val_fp: 22732.0000 - val_tn: 233268.0000 - val_fn: 22732.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.8958
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-12288000-12544000
[INFO] processing batch 12544000-12800000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:63248 (24.70625%)
[INFO] ** service:[0.7025755984000001:99.99805%,0.002116286:0.00117%,0.0012540954:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.9293%,0.8139250565:21.08945%,0.8029830673999999:18.1125%,0.8149336757:17.48984%,0.8137722355:17.37539%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.9802707989:0.00039%,0.9054801638:0.00039%,0.9502261752:0.00039%,0.7788831836:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.39727%,Single Stage Single Point:35.60273%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06992%,1:25.93008%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.51016%,1:17.48984%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88711%,1:18.11289%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.53516%,1:38.46484%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91055%,1:21.08945%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69492%,1:43.30508%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.51016%,1:17.48984%]
[INFO] ** dst-192.168.1.40:[0:81.88711%,1:18.11289%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06992%,1:25.93008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51016%,1:17.48984%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88711%,1:18.11289%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.53516%,1:38.46484%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62461%,1:17.37539%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.07148%,1:25.92852%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91055%,1:21.08945%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51055%,1:17.48945%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8875%,1:18.1125%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      4,      5, ..., 255992, 255994, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.0112 - tp: 123588.0000 - fp: 68412.0000 - tn: 699588.0000 - fn: 68412.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9109 - val_loss: 0.9868 - val_tp: 41269.0000 - val_fp: 22731.0000 - val_tn: 233269.0000 - val_fn: 22731.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-12544000-12800000
[INFO] processing batch 12800000-13056000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:59778 (23.35078%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0:0.00078%]
[INFO] ** s_port:[0.834280824:25.93711%,0.8139250565:21.04336%,0.8029830673999999:18.1625%,0.8149336757:17.49609%,0.8137722355:17.35859%,0.8059172320999999:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:64.34062%,Single Stage Single Point:35.65937%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0625%,1:25.9375%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.83711%,1:18.16289%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.59805%,1:38.40195%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.95664%,1:21.04336%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.7043%,1:43.2957%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50352%,1:17.49648%]
[INFO] ** dst-192.168.1.40:[0:81.8375%,1:18.1625%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0625%,1:25.9375%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.83711%,1:18.16289%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59805%,1:38.40195%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6418%,1:17.3582%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06289%,1:25.93711%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95664%,1:21.04336%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50391%,1:17.49609%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8375%,1:18.1625%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      4, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164712.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      6, ..., 255990, 255992, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9702 - tp: 123531.0000 - fp: 68469.0000 - tn: 699531.0000 - fn: 68469.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9108 - val_loss: 0.9503 - val_tp: 41181.0000 - val_fp: 22819.0000 - val_tn: 233181.0000 - val_fn: 22819.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-12800000-13056000
[INFO] processing batch 13056000-13312000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:59589 (23.27695%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.92344%,0.8139250565:21.10312%,0.8029830673999999:18.15703%,0.8149336757:17.46484%,0.8137722355:17.34961%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:64.37773%,Single Stage Single Point:35.62227%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.07578%,1:25.92422%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53477%,1:17.46523%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54727%,1:38.45273%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.89687%,1:21.10312%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.72695%,1:43.27305%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53516%,1:17.46484%]
[INFO] ** dst-192.168.1.40:[0:81.84219%,1:18.15781%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.07578%,1:25.92422%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53477%,1:17.46523%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54727%,1:38.45273%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00156%,0:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65039%,1:17.34961%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.07695%,1:25.92305%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.89727%,1:21.10273%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53555%,1:17.46445%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84336%,1:18.15664%]
[INFO] columns with count within 2-10 {'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      6, ..., 255992, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9327 - tp: 123615.0000 - fp: 68385.0000 - tn: 699615.0000 - fn: 68385.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9110 - val_loss: 0.9165 - val_tp: 41192.0000 - val_fp: 22808.0000 - val_tn: 233192.0000 - val_fn: 22808.0000 - val_accuracy: 0.8575 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-13056000-13312000
[INFO] processing batch 13312000-13568000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99062%,0.0:0.00938%]
[INFO] ** modbus_transaction_id:59423 (23.21211%)
[INFO] ** service:[0.7025755984000001:99.99062%,0.0208806885:0.00156%,0.002116286:0.00156%,0.0021476384:0.00156%,0.0021633145999999997:0.00117%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.09248953609999999:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.96484%,0.8139250565:20.99258%,0.8029830673999999:18.22031%,0.8149336757:17.47617%,0.8137722355:17.33555%,0.0020936488:0.00156%,0.0:0.00117%,0.0021089309:0.00117%,0.814841983:0.00078%,0.9502261752:0.00039%,0.9834647595:0.00039%,0.8030441959000001:0.00039%,0.7788831836:0.00039%,0.8465523565:0.00039%,0.9715599976:0.00039%,0.9054801638:0.00039%,0.9802707989:0.00039%,0.8411730545999999:0.00039%,0.15240846019999998:0.00039%,0.0818051226:0.00039%,0.15243902439999998:0.00039%,0.9344397579000001:0.00039%,0.315972859:0.00039%,0.9535729568000001:0.00039%]
[INFO] ** classification:[normal:64.30313%,Single Stage Single Point:35.69688%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03516%,1:25.96484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52305%,1:17.47695%]
[INFO] ** src-192.168.1.200:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.7793%,1:18.2207%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** src-192.168.1.88:[0:99.99844%,1:0.00156%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.00742%,1:20.99258%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69922%,1:43.30078%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.255:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.30:[0:82.52383%,1:17.47617%]
[INFO] ** dst-192.168.1.40:[0:81.77969%,1:18.22031%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99453%,0:0.00547%]
[INFO] ** proto-udp:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99062%,0:0.00938%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03516%,1:25.96484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52305%,1:17.47695%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.7793%,1:18.2207%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-0:[0:99.99062%,1:0.00938%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98867%,1:0.01133%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66445%,1:17.33555%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03555%,1:25.96445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.00742%,1:20.99258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52422%,1:17.47578%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77969%,1:18.22031%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255994, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164616.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      5,      7, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9036 - tp: 123437.0000 - fp: 68563.0000 - tn: 699437.0000 - fn: 68563.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.9107 - val_loss: 0.8883 - val_tp: 41179.0000 - val_fp: 22821.0000 - val_tn: 233179.0000 - val_fn: 22821.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-13312000-13568000
[INFO] processing batch 13568000-13824000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:65533 (25.59883%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.08394601119999999:0.00195%,0.0208806885:0.00039%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.93906%,0.8139250565:21.07109%,0.8029830673999999:18.15859%,0.8149336757:17.48516%,0.8137722355:17.3418%,0.8166299895999999:0.00156%,0.8059172320999999:0.00039%,0.7593068036:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.35586%,Single Stage Single Point:35.64414%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06055%,1:25.93945%]
[INFO] ** src-192.168.1.134:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.20:[0:82.51484%,1:17.48516%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84141%,1:18.15859%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58711%,1:38.41289%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.92891%,1:21.07109%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71914%,1:43.28086%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.51445%,1:17.48555%]
[INFO] ** dst-192.168.1.40:[0:81.84141%,1:18.15859%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99805%,1:0.00195%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06055%,1:25.93945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51484%,1:17.48516%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84141%,1:18.15859%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58711%,1:38.41289%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65859%,1:17.34141%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06133%,1:25.93867%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92891%,1:21.07109%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51484%,1:17.48516%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84141%,1:18.15859%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255994, 255996, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164751.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      4,      7, ..., 255995, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8759 - tp: 123539.0000 - fp: 68461.0000 - tn: 699539.0000 - fn: 68461.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9109 - val_loss: 0.8628 - val_tp: 41212.0000 - val_fp: 22788.0000 - val_tn: 233212.0000 - val_fn: 22788.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-13568000-13824000
[INFO] processing batch 13824000-14080000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.95586%,0.8139250565:21.03906%,0.8029830673999999:18.17891%,0.8149336757:17.47344%,0.8137722355:17.35%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.34727%,Single Stage Single Point:35.65273%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04414%,1:25.95586%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52578%,1:17.47422%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.61094%,1:38.38906%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96094%,1:21.03906%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69414%,1:43.30586%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.52656%,1:17.47344%]
[INFO] ** dst-192.168.1.40:[0:81.8207%,1:18.1793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04414%,1:25.95586%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52578%,1:17.47422%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.61094%,1:38.38906%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65%,1:17.35%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04453%,1:25.95547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96133%,1:21.03867%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52695%,1:17.47305%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82148%,1:18.17852%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      5, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      4, ..., 255992, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8529 - tp: 123556.0000 - fp: 68444.0000 - tn: 699556.0000 - fn: 68444.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.9108 - val_loss: 0.8426 - val_tp: 41173.0000 - val_fp: 22827.0000 - val_tn: 233173.0000 - val_fn: 22827.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-13824000-14080000
[INFO] processing batch 14080000-14336000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:62632 (24.46562%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.09248953609999999:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.93789%,0.8139250565:21.06602%,0.8029830673999999:18.12578%,0.8149336757:17.45859%,0.8137722355:17.40898%,0.8343113882:0.00078%,0.8345253376999999:0.00039%,0.1074484993:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.41484%,Single Stage Single Point:35.58516%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.54141%,1:17.45859%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87383%,1:18.12617%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.525%,1:38.475%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.93359%,1:21.06641%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65273%,1:43.34727%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54102%,1:17.45898%]
[INFO] ** dst-192.168.1.40:[0:81.87422%,1:18.12578%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54141%,1:17.45859%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87383%,1:18.12617%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.525%,1:38.475%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.59102%,1:17.40898%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0625%,1:25.9375%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93398%,1:21.06602%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5418%,1:17.4582%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87422%,1:18.12578%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - success': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      6, ..., 255993, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8322 - tp: 123681.0000 - fp: 68319.0000 - tn: 699681.0000 - fn: 68319.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9110 - val_loss: 0.8233 - val_tp: 41221.0000 - val_fp: 22779.0000 - val_tn: 233221.0000 - val_fn: 22779.0000 - val_accuracy: 0.8576 - val_precision: 0.6441 - val_recall: 0.6441 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-14080000-14336000
[INFO] processing batch 14336000-14592000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:58803 (22.96992%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.99727%,0.8139250565:21.03086%,0.8029830673999999:18.15469%,0.8149336757:17.50117%,0.8137722355:17.31172%,0.0:0.00273%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%]
[INFO] ** classification:[normal:64.34375%,Single Stage Single Point:35.65625%]
[INFO] ** orig-192.168.1.48:[1:99.99883%,0:0.00117%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99844%,1:0.00156%]
[INFO] ** type-log:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00273%,1:25.99727%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.84492%,1:18.15508%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.65742%,1:38.34258%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:78.96914%,1:21.03086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69102%,1:43.30898%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49883%,1:17.50117%]
[INFO] ** dst-192.168.1.40:[0:81.84531%,1:18.15469%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00273%,1:25.99727%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84492%,1:18.15508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65742%,1:38.34258%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68867%,1:17.31133%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00273%,1:25.99727%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96914%,1:21.03086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49883%,1:17.50117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8457%,1:18.1543%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 's_port': 9, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255992, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8165 - tp: 123523.0000 - fp: 68477.0000 - tn: 699523.0000 - fn: 68477.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.9107 - val_loss: 0.8081 - val_tp: 41197.0000 - val_fp: 22803.0000 - val_tn: 233197.0000 - val_fn: 22803.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-14336000-14592000
[INFO] processing batch 14592000-14848000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:61358 (23.96797%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00078%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.98203%,0.8139250565:21.03906%,0.8029830673999999:18.13672%,0.8149336757:17.46211%,0.8137722355:17.37617%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.9344397579000001:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.4%,Single Stage Single Point:35.6%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01758%,1:25.98242%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.5375%,1:17.4625%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8625%,1:18.1375%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** src-192.168.1.88:[0:99.99844%,1:0.00156%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96055%,1:21.03945%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64141%,1:43.35859%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.5375%,1:17.4625%]
[INFO] ** dst-192.168.1.40:[0:81.86289%,1:18.13711%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01758%,1:25.98242%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.5375%,1:17.4625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8625%,1:18.1375%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62383%,1:17.37617%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01875%,1:25.98125%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96094%,1:21.03906%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53828%,1:17.46172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86328%,1:18.13672%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      7,      8, ..., 255989, 255993, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8009 - tp: 123652.0000 - fp: 68348.0000 - tn: 699652.0000 - fn: 68348.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9111 - val_loss: 0.7943 - val_tp: 41212.0000 - val_fp: 22788.0000 - val_tn: 233212.0000 - val_fn: 22788.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-14592000-14848000
[INFO] processing batch 14848000-15104000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:65530 (25.59766%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.01992%,0.8139250565:21.02656%,0.8029830673999999:18.12148%,0.8149336757:17.50391%,0.8137722355:17.32656%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.37461%,Single Stage Single Point:35.62539%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9793%,1:26.0207%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4957%,1:17.5043%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87852%,1:18.12148%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.64688%,1:38.35312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97344%,1:21.02656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65352%,1:43.34648%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49609%,1:17.50391%]
[INFO] ** dst-192.168.1.40:[0:81.87812%,1:18.12188%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9793%,1:26.0207%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4957%,1:17.5043%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87852%,1:18.12148%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.64688%,1:38.35312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99805%,1:0.00195%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67344%,1:17.32656%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98008%,1:26.01992%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97344%,1:21.02656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49648%,1:17.50352%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87852%,1:18.12148%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     4,      5,      6, ..., 255996, 255997, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      1,      2, ..., 255990, 255992, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7888 - tp: 123594.0000 - fp: 68406.0000 - tn: 699594.0000 - fn: 68406.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9110 - val_loss: 0.7828 - val_tp: 41205.0000 - val_fp: 22795.0000 - val_tn: 233205.0000 - val_fn: 22795.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-14848000-15104000
[INFO] processing batch 15104000-15360000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:55201 (21.56289%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.9457%,0.8139250565:21.08125%,0.8029830673999999:18.10352%,0.8149336757:17.49609%,0.8137722355:17.37188%,0.8030136315999999:0.00078%,0.8059172320999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.39961%,Single Stage Single Point:35.60039%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05391%,1:25.94609%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8957%,1:18.1043%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54688%,1:38.45312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91875%,1:21.08125%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68242%,1:43.31758%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50391%,1:17.49609%]
[INFO] ** dst-192.168.1.40:[0:81.89648%,1:18.10352%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05391%,1:25.94609%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8957%,1:18.1043%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54688%,1:38.45312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62852%,1:17.37148%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.05508%,1:25.94492%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91914%,1:21.08086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50391%,1:17.49609%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.89688%,1:18.10313%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     3,      4,      5, ..., 255993, 255995, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164863.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      1,      2, ..., 255996, 255997, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7777 - tp: 123629.0000 - fp: 68371.0000 - tn: 699629.0000 - fn: 68371.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.9109 - val_loss: 0.7722 - val_tp: 41234.0000 - val_fp: 22766.0000 - val_tn: 233234.0000 - val_fn: 22766.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-15104000-15360000
[INFO] processing batch 15360000-15616000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:52006 (20.31484%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.96992%,0.8139250565:21.05938%,0.8029830673999999:18.11211%,0.8149336757:17.47383%,0.8137722355:17.38203%,0.814841983:0.00117%,0.8345253376999999:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.41328%,Single Stage Single Point:35.58672%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52461%,1:17.47539%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8875%,1:18.1125%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.94062%,1:21.05938%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64766%,1:43.35234%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.52578%,1:17.47422%]
[INFO] ** dst-192.168.1.40:[0:81.8875%,1:18.1125%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52461%,1:17.47539%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8875%,1:18.1125%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61797%,1:17.38203%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03008%,1:25.96992%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94062%,1:21.05938%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52656%,1:17.47344%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88789%,1:18.11211%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255995, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      7,      8, ..., 255993, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7684 - tp: 123632.0000 - fp: 68368.0000 - tn: 699632.0000 - fn: 68368.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.7631 - val_tp: 41266.0000 - val_fp: 22734.0000 - val_tn: 233266.0000 - val_fn: 22734.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-15360000-15616000
[INFO] processing batch 15616000-15872000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99258%,0.0:0.00742%]
[INFO] ** modbus_transaction_id:52095 (20.34961%)
[INFO] ** service:[0.7025755984000001:99.99258%,0.0:0.00625%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.95977%,0.8139250565:21.03828%,0.8029830673999999:18.20312%,0.8149336757:17.45156%,0.8137722355:17.33906%,0.0:0.00625%,0.9715599976:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.34531%,Single Stage Single Point:35.65469%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_name-eth1:[1:99.99375%,0:0.00625%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99414%,1:0.00586%]
[INFO] ** i/f_dir-outbound:[1:99.99414%,0:0.00586%]
[INFO] ** src-0:[0:99.99375%,1:0.00625%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03945%,1:25.96055%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54844%,1:17.45156%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79688%,1:18.20312%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.62266%,1:38.37734%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99375%,1:0.00625%]
[INFO] ** dst-192.168.1.10:[0:78.96172%,1:21.03828%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70117%,1:43.29883%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.54844%,1:17.45156%]
[INFO] ** dst-192.168.1.40:[0:81.79648%,1:18.20352%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99375%,1:0.00625%]
[INFO] ** proto-tcp:[1:99.99258%,0:0.00742%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99258%,0:0.00742%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99375%,1:0.00625%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03945%,1:25.96055%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54844%,1:17.45156%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79688%,1:18.20312%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.62266%,1:38.37734%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99258%,1:0.00742%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00391%,1:49.99609%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66094%,1:17.33906%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04063%,1:25.95938%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96211%,1:21.03789%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54883%,1:17.45117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79688%,1:18.20312%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      4, ..., 255996, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      5, ..., 255992, 255993, 255997]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7610 - tp: 123527.0000 - fp: 68473.0000 - tn: 699527.0000 - fn: 68473.0000 - accuracy: 0.8573 - precision: 0.6434 - recall: 0.6434 - auc: 0.9108 - val_loss: 0.7568 - val_tp: 41197.0000 - val_fp: 22803.0000 - val_tn: 233197.0000 - val_fn: 22803.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-15616000-15872000
[INFO] processing batch 15872000-16128000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:62931 (24.58242%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00078%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.97227%,0.8139250565:21.01094%,0.8029830673999999:18.15195%,0.8149336757:17.50937%,0.8137722355:17.35078%,0.8059172320999999:0.00117%,0.8030136315999999:0.00078%,0.0:0.00078%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.3375%,Single Stage Single Point:35.6625%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02695%,1:25.97305%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84727%,1:18.15273%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.63828%,1:38.36172%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.98906%,1:21.01094%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67695%,1:43.32305%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.49023%,1:17.50977%]
[INFO] ** dst-192.168.1.40:[0:81.84805%,1:18.15195%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02695%,1:25.97305%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84727%,1:18.15273%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63828%,1:38.36172%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64922%,1:17.35078%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02812%,1:25.97188%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.98906%,1:21.01094%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49062%,1:17.50937%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84844%,1:18.15156%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255995, 255997, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164704.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      6,      7, ..., 255994, 255996, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7539 - tp: 123531.0000 - fp: 68469.0000 - tn: 699531.0000 - fn: 68469.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9108 - val_loss: 0.7508 - val_tp: 41173.0000 - val_fp: 22827.0000 - val_tn: 233173.0000 - val_fn: 22827.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-15872000-16128000
[INFO] processing batch 16128000-16384000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00508%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0208806885:0.00156%,0.0:0.00156%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.96602%,0.8139250565:21.09766%,0.8029830673999999:18.07891%,0.8149336757:17.47734%,0.8137722355:17.37344%,0.0:0.00156%,0.0020936488:0.00078%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8147502904:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.8344030809:0.00039%,0.15243902439999998:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:64.44375%,Single Stage Single Point:35.55625%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0332%,1:25.9668%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52227%,1:17.47773%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.92109%,1:18.07891%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.52891%,1:38.47109%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:78.90234%,1:21.09766%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66055%,1:43.33945%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.52266%,1:17.47734%]
[INFO] ** dst-192.168.1.40:[0:81.92031%,1:18.07969%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0332%,1:25.9668%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52227%,1:17.47773%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.92109%,1:18.07891%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.52891%,1:38.47109%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99492%,1:0.00508%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62656%,1:17.37344%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03438%,1:25.96562%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90234%,1:21.09766%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52305%,1:17.47695%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.92109%,1:18.07891%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      7, ..., 255993, 255994, 255995]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7466 - tp: 123781.0000 - fp: 68219.0000 - tn: 699781.0000 - fn: 68219.0000 - accuracy: 0.8579 - precision: 0.6447 - recall: 0.6447 - auc: 0.9112 - val_loss: 0.7449 - val_tp: 41195.0000 - val_fp: 22805.0000 - val_tn: 233195.0000 - val_fn: 22805.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-16128000-16384000
[INFO] processing batch 16384000-16640000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:63141 (24.66445%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.002116286:0.00117%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.95469%,0.8139250565:21.07812%,0.8029830673999999:18.19219%,0.8149336757:17.43789%,0.8137722355:17.33281%,0.814841983:0.00078%,0.7825203251999999:0.00039%,0.9802707989:0.00039%,0.9054801638:0.00039%,0.8345253376999999:0.00039%,0.9502261752:0.00039%,0.2528119078:0.00039%,0.7788831836:0.00039%,0.0020936488:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.36953%,Single Stage Single Point:35.63047%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04492%,1:25.95508%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.56133%,1:17.43867%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.58906%,1:38.41094%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.92148%,1:21.07852%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.7125%,1:43.2875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.56172%,1:17.43828%]
[INFO] ** dst-192.168.1.40:[0:81.80781%,1:18.19219%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04492%,1:25.95508%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56133%,1:17.43867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58906%,1:38.41094%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66719%,1:17.33281%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0457%,1:25.9543%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92227%,1:21.07773%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5625%,1:17.4375%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80781%,1:18.19219%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      4,      6, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      3, ..., 255992, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7423 - tp: 123621.0000 - fp: 68379.0000 - tn: 699621.0000 - fn: 68379.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.7405 - val_tp: 41165.0000 - val_fp: 22835.0000 - val_tn: 233165.0000 - val_fn: 22835.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-16384000-16640000
[INFO] processing batch 16640000-16896000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.95664%,0.8139250565:21.02539%,0.8029830673999999:18.1918%,0.8149336757:17.4918%,0.8137722355:17.33242%,0.8030136315999999:0.00078%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.31523%,Single Stage Single Point:35.68477%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04297%,1:25.95703%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50781%,1:17.49219%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80703%,1:18.19297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.64219%,1:38.35781%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97461%,1:21.02539%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71055%,1:43.28945%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.5082%,1:17.4918%]
[INFO] ** dst-192.168.1.40:[0:81.8082%,1:18.1918%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04297%,1:25.95703%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50781%,1:17.49219%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80703%,1:18.19297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.64219%,1:38.35781%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66797%,1:17.33203%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04375%,1:25.95625%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97461%,1:21.02539%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5082%,1:17.4918%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80859%,1:18.19141%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      3,      5, ..., 255991, 255995, 255996]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7387 - tp: 123417.0000 - fp: 68583.0000 - tn: 699417.0000 - fn: 68583.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.9107 - val_loss: 0.7353 - val_tp: 41230.0000 - val_fp: 22770.0000 - val_tn: 233230.0000 - val_fn: 22770.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-16640000-16896000
[INFO] processing batch 16896000-17152000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99805%,0.0:0.00195%]
[INFO] ** s_port:[0.834280824:25.93984%,0.8139250565:21.03945%,0.8029830673999999:18.1543%,0.8149336757:17.47109%,0.8137722355:17.39023%,0.0:0.00195%,0.8059172320999999:0.00117%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.37422%,Single Stage Single Point:35.62578%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99805%,1:0.00195%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05898%,1:25.94102%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52812%,1:17.47188%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8457%,1:18.1543%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.57031%,1:38.42969%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:78.96055%,1:21.03945%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66992%,1:43.33008%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.52852%,1:17.47148%]
[INFO] ** dst-192.168.1.40:[0:81.84492%,1:18.15508%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05898%,1:25.94102%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52812%,1:17.47188%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8457%,1:18.1543%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.57031%,1:38.42969%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00156%,0:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60977%,1:17.39023%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06055%,1:25.93945%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96055%,1:21.03945%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5293%,1:17.4707%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8457%,1:18.1543%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255996, 255997, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164798.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      5, ..., 255992, 255995, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7338 - tp: 123600.0000 - fp: 68400.0000 - tn: 699600.0000 - fn: 68400.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.7320 - val_tp: 41198.0000 - val_fp: 22802.0000 - val_tn: 233198.0000 - val_fn: 22802.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-16896000-17152000
[INFO] processing batch 17152000-17408000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99961%,0.8139250565:21.05%,0.8029830673999999:18.12773%,0.8149336757:17.46641%,0.8137722355:17.35547%,0.8059172320999999:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.40586%,Single Stage Single Point:35.59414%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00039%,1:25.99961%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53359%,1:17.46641%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87227%,1:18.12773%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.59453%,1:38.40547%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.95%,1:21.05%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64492%,1:43.35508%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53359%,1:17.46641%]
[INFO] ** dst-192.168.1.40:[0:81.87227%,1:18.12773%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00039%,1:25.99961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53359%,1:17.46641%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87227%,1:18.12773%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59453%,1:38.40547%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99844%,1:0.00156%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64453%,1:17.35547%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00078%,1:25.99922%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95%,1:21.05%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53398%,1:17.46602%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87227%,1:18.12773%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255995, 255996, 255997]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164879.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      6, ..., 255992, 255998, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7298 - tp: 123711.0000 - fp: 68289.0000 - tn: 699711.0000 - fn: 68289.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.9111 - val_loss: 0.7291 - val_tp: 41168.0000 - val_fp: 22832.0000 - val_tn: 233168.0000 - val_fn: 22832.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-17152000-17408000
[INFO] processing batch 17408000-17664000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.97344%,0.8139250565:21.04922%,0.8029830673999999:18.15234%,0.8149336757:17.46406%,0.8137722355:17.35703%,0.8030136315999999:0.00078%,0.814841983:0.00078%,0.0:0.00078%,0.0818051226:0.00039%,0.8344030809:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.38242%,Single Stage Single Point:35.61758%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02578%,1:25.97422%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53516%,1:17.46484%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84648%,1:18.15352%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.59375%,1:38.40625%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.95078%,1:21.04922%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66914%,1:43.33086%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53594%,1:17.46406%]
[INFO] ** dst-192.168.1.40:[0:81.84727%,1:18.15273%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02578%,1:25.97422%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53516%,1:17.46484%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84648%,1:18.15352%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59375%,1:38.40625%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64336%,1:17.35664%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02656%,1:25.97344%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95117%,1:21.04883%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53594%,1:17.46406%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84805%,1:18.15195%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255995, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164819.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      6, ..., 255993, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7268 - tp: 123701.0000 - fp: 68299.0000 - tn: 699701.0000 - fn: 68299.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.9111 - val_loss: 0.7268 - val_tp: 41118.0000 - val_fp: 22882.0000 - val_tn: 233118.0000 - val_fn: 22882.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-17408000-17664000
[INFO] processing batch 17664000-17920000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.08394601119999999:0.00078%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.9793%,0.8139250565:20.98828%,0.8029830673999999:18.18008%,0.8149336757:17.50898%,0.8137722355:17.33984%,0.8166299895999999:0.00078%,0.814841983:0.00078%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.31055%,Single Stage Single Point:35.68945%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01992%,1:25.98008%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.48984%,1:17.51016%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.81992%,1:18.18008%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.01133%,1:20.98867%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68086%,1:43.31914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49062%,1:17.50937%]
[INFO] ** dst-192.168.1.40:[0:81.81953%,1:18.18047%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01992%,1:25.98008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48984%,1:17.51016%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.81992%,1:18.18008%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02148%,1:25.97852%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01172%,1:20.98828%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49141%,1:17.50859%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.81992%,1:18.18008%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     4,      5,      8, ..., 255991, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7247 - tp: 123546.0000 - fp: 68454.0000 - tn: 699546.0000 - fn: 68454.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.9108 - val_loss: 0.7245 - val_tp: 41089.0000 - val_fp: 22911.0000 - val_tn: 233089.0000 - val_fn: 22911.0000 - val_accuracy: 0.8568 - val_precision: 0.6420 - val_recall: 0.6420 - val_auc: 0.9105
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-17664000-17920000
[INFO] processing batch 17920000-18176000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.00352%,0.8139250565:21.07344%,0.8029830673999999:18.11914%,0.8149336757:17.46094%,0.8137722355:17.34063%,0.8059172320999999:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.0021089309:0.00039%]
[INFO] ** classification:[normal:64.41953%,Single Stage Single Point:35.58047%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.99648%,1:26.00352%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53906%,1:17.46094%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88047%,1:18.11953%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58594%,1:38.41406%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.92656%,1:21.07344%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65586%,1:43.34414%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.53906%,1:17.46094%]
[INFO] ** dst-192.168.1.40:[0:81.88086%,1:18.11914%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.99648%,1:26.00352%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53906%,1:17.46094%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88047%,1:18.11953%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58594%,1:38.41406%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65938%,1:17.34063%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.99648%,1:26.00352%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92656%,1:21.07344%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53906%,1:17.46094%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88125%,1:18.11875%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      4, ..., 255995, 255996, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      3,      5, ..., 255994, 255997, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7216 - tp: 123681.0000 - fp: 68319.0000 - tn: 699681.0000 - fn: 68319.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9112 - val_loss: 0.7203 - val_tp: 41233.0000 - val_fp: 22767.0000 - val_tn: 233233.0000 - val_fn: 22767.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-17920000-18176000
[INFO] processing batch 18176000-18432000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:55800 (21.79688%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.98555%,0.8139250565:21.06953%,0.8029830673999999:18.08633%,0.8149336757:17.48359%,0.8137722355:17.37188%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:64.42891%,Single Stage Single Point:35.57109%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01367%,1:25.98633%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.51641%,1:17.48359%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.93047%,1:21.06953%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64219%,1:43.35781%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.51602%,1:17.48398%]
[INFO] ** dst-192.168.1.40:[0:81.91328%,1:18.08672%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01367%,1:25.98633%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51641%,1:17.48359%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62852%,1:17.37148%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01523%,1:25.98477%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93047%,1:21.06953%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51641%,1:17.48359%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91367%,1:18.08633%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255996, 255997, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164938.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      6,      9, ..., 255992, 255995, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7194 - tp: 123640.0000 - fp: 68360.0000 - tn: 699640.0000 - fn: 68360.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9110 - val_loss: 0.7173 - val_tp: 41298.0000 - val_fp: 22702.0000 - val_tn: 233298.0000 - val_fn: 22702.0000 - val_accuracy: 0.8581 - val_precision: 0.6453 - val_recall: 0.6453 - val_auc: 0.9113
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-18176000-18432000
[INFO] processing batch 18432000-18688000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:53869 (21.04258%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08391465880000001:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.95781%,0.8139250565:21.05938%,0.8029830673999999:18.11641%,0.8149336757:17.48984%,0.8137722355:17.37461%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.39375%,Single Stage Single Point:35.60625%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0418%,1:25.9582%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50937%,1:17.49063%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.56602%,1:38.43398%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.94062%,1:21.05938%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66758%,1:43.33242%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.51016%,1:17.48984%]
[INFO] ** dst-192.168.1.40:[0:81.8832%,1:18.1168%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0418%,1:25.9582%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50937%,1:17.49063%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56602%,1:38.43398%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62539%,1:17.37461%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04219%,1:25.95781%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94062%,1:21.05938%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51055%,1:17.48945%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88359%,1:18.11641%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      7, ..., 255993, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7174 - tp: 123615.0000 - fp: 68385.0000 - tn: 699615.0000 - fn: 68385.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.7160 - val_tp: 41233.0000 - val_fp: 22767.0000 - val_tn: 233233.0000 - val_fn: 22767.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-18432000-18688000
[INFO] processing batch 18688000-18944000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:54033 (21.10664%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.94609%,0.8139250565:21.09766%,0.8029830673999999:18.11172%,0.8149336757:17.50117%,0.8137722355:17.33984%,0.814841983:0.00078%,0.9344397579000001:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.38633%,Single Stage Single Point:35.61367%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05273%,1:25.94727%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88789%,1:18.11211%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.5625%,1:38.4375%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.90195%,1:21.09805%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71367%,1:43.28633%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.49844%,1:17.50156%]
[INFO] ** dst-192.168.1.40:[0:81.88789%,1:18.11211%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05273%,1:25.94727%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88789%,1:18.11211%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5625%,1:38.4375%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0543%,1:25.9457%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90273%,1:21.09727%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49883%,1:17.50117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88867%,1:18.11133%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      5,      7, ..., 255992, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.7153 - tp: 123645.0000 - fp: 68355.0000 - tn: 699645.0000 - fn: 68355.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9110 - val_loss: 0.7146 - val_tp: 41184.0000 - val_fp: 22816.0000 - val_tn: 233184.0000 - val_fn: 22816.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-18688000-18944000
[INFO] processing batch 18944000-19200000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:64214 (25.08359%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.98281%,0.8139250565:21.08516%,0.8029830673999999:18.06875%,0.8149336757:17.45547%,0.8137722355:17.40664%,0.8059172320999999:0.00078%,0.8030136315999999:0.00039%]
[INFO] ** classification:[normal:64.47539%,Single Stage Single Point:35.52461%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01719%,1:25.98281%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54453%,1:17.45547%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.93086%,1:18.06914%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91484%,1:21.08516%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61055%,1:43.38945%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54453%,1:17.45547%]
[INFO] ** dst-192.168.1.40:[0:81.93125%,1:18.06875%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01719%,1:25.98281%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54453%,1:17.45547%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.93086%,1:18.06914%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99805%,1:0.00195%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.59375%,1:17.40625%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01758%,1:25.98242%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91484%,1:21.08516%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54453%,1:17.45547%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.93125%,1:18.06875%]
[INFO] columns with count within 2-10 {'s_port': 7, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      5,      6, ..., 255990, 255994, 255996]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.7125 - tp: 123888.0000 - fp: 68112.0000 - tn: 699888.0000 - fn: 68112.0000 - accuracy: 0.8581 - precision: 0.6453 - recall: 0.6453 - auc: 0.9113 - val_loss: 0.7130 - val_tp: 41169.0000 - val_fp: 22831.0000 - val_tn: 233169.0000 - val_fn: 22831.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-18944000-19200000
[INFO] processing batch 19200000-19456000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.91523%,0.8139250565:21.08711%,0.8029830673999999:18.23672%,0.8149336757:17.43164%,0.8137722355:17.32812%,0.8059172320999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:64.33164%,Single Stage Single Point:35.66836%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.08438%,1:25.91562%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.56797%,1:17.43203%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76328%,1:18.23672%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91289%,1:21.08711%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.75664%,1:43.24336%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.56836%,1:17.43164%]
[INFO] ** dst-192.168.1.40:[0:81.76289%,1:18.23711%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.08438%,1:25.91562%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56797%,1:17.43203%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76328%,1:18.23672%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67188%,1:17.32812%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.08516%,1:25.91484%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91289%,1:21.08711%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56914%,1:17.43086%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76328%,1:18.23672%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164689.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      9, ..., 255994, 255995, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7122 - tp: 123500.0000 - fp: 68500.0000 - tn: 699500.0000 - fn: 68500.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.9108 - val_loss: 0.7111 - val_tp: 41189.0000 - val_fp: 22811.0000 - val_tn: 233189.0000 - val_fn: 22811.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-19200000-19456000
[INFO] processing batch 19456000-19712000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00586%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.98398%,0.8139250565:21.0457%,0.8029830673999999:18.14141%,0.8149336757:17.46133%,0.8137722355:17.35859%,0.0:0.00586%,0.8343113882:0.00078%,0.9715599976:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.8345253376999999:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.39648%,Single Stage Single Point:35.60352%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99883%,1:0.00117%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** i/f_name-eth1:[1:99.99414%,0:0.00586%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_dir-outbound:[1:99.99453%,0:0.00547%]
[INFO] ** src-0:[0:99.99414%,1:0.00586%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01445%,1:25.98555%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53828%,1:17.46172%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8582%,1:18.1418%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.5957%,1:38.4043%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99414%,1:0.00586%]
[INFO] ** dst-192.168.1.10:[0:78.9543%,1:21.0457%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65742%,1:43.34258%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53828%,1:17.46172%]
[INFO] ** dst-192.168.1.40:[0:81.8582%,1:18.1418%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99414%,1:0.00586%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99414%,1:0.00586%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01445%,1:25.98555%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53828%,1:17.46172%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8582%,1:18.1418%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5957%,1:38.4043%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64141%,1:17.35859%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01641%,1:25.98359%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95469%,1:21.04531%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53867%,1:17.46133%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85898%,1:18.14102%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      9,     11, ..., 255990, 255992, 255994]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7098 - tp: 123689.0000 - fp: 68311.0000 - tn: 699689.0000 - fn: 68311.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9111 - val_loss: 0.7097 - val_tp: 41166.0000 - val_fp: 22834.0000 - val_tn: 233166.0000 - val_fn: 22834.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-19456000-19712000
[INFO] processing batch 19712000-19968000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:56152 (21.93437%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00195%,1.0:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.98945%,0.8139250565:20.99453%,0.8029830673999999:18.17266%,0.8149336757:17.51328%,0.8137722355:17.32656%,0.0:0.00195%,0.814841983:0.00078%,0.0021089309:0.00039%,0.0818356868:0.00039%]
[INFO] ** classification:[normal:64.31406%,Single Stage Single Point:35.68594%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99805%,1:0.00195%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01055%,1:25.98945%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.48594%,1:17.51406%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.67891%,1:38.32109%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:79.00547%,1:20.99453%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68398%,1:43.31602%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.48672%,1:17.51328%]
[INFO] ** dst-192.168.1.40:[0:81.82734%,1:18.17266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01055%,1:25.98945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48594%,1:17.51406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.67891%,1:38.32109%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67383%,1:17.32617%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01094%,1:25.98906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.00547%,1:20.99453%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.48672%,1:17.51328%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82734%,1:18.17266%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 's_port': 9, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DNP3 Protocol - initialize data to defaults': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      6, ..., 255994, 255997, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      4, ..., 255995, 255996, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7092 - tp: 123402.0000 - fp: 68598.0000 - tn: 699402.0000 - fn: 68598.0000 - accuracy: 0.8571 - precision: 0.6427 - recall: 0.6427 - auc: 0.9106 - val_loss: 0.7073 - val_tp: 41242.0000 - val_fp: 22758.0000 - val_tn: 233242.0000 - val_fn: 22758.0000 - val_accuracy: 0.8578 - val_precision: 0.6444 - val_recall: 0.6444 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-19712000-19968000
[INFO] processing batch 19968000-20224000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:58822 (22.97734%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.0021476384:0.00156%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.91172%,0.8139250565:21.07344%,0.8029830673999999:18.17578%,0.8149336757:17.45547%,0.8137722355:17.37695%,0.0020936488:0.00156%,0.7586191087:0.00039%,0.8147502904:0.00039%,0.0021089309:0.00039%,0.8345253376999999:0.00039%,0.8059172320999999:0.00039%,0.8411730545999999:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.8344030809:0.00039%,0.15243902439999998:0.00039%,0.8030136315999999:0.00039%,0.315972859:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.36797%,Single Stage Single Point:35.63203%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0875%,1:25.9125%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.20:[0:82.54414%,1:17.45586%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82383%,1:18.17617%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.92656%,1:21.07344%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71133%,1:43.28867%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.54414%,1:17.45586%]
[INFO] ** dst-192.168.1.40:[0:81.82344%,1:18.17656%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0875%,1:25.9125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54414%,1:17.45586%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82383%,1:18.17617%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99297%,1:0.00703%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62305%,1:17.37695%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.08828%,1:25.91172%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92656%,1:21.07344%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54492%,1:17.45508%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82422%,1:18.17578%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      9,     12, ..., 255991, 255993, 255995]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7072 - tp: 123541.0000 - fp: 68459.0000 - tn: 699541.0000 - fn: 68459.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9109 - val_loss: 0.7058 - val_tp: 41241.0000 - val_fp: 22759.0000 - val_tn: 233241.0000 - val_fn: 22759.0000 - val_accuracy: 0.8578 - val_precision: 0.6444 - val_recall: 0.6444 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-19968000-20224000
[INFO] processing batch 20224000-20480000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.98945%,0.0:0.01055%]
[INFO] ** modbus_transaction_id:63526 (24.81484%)
[INFO] ** service:[0.7025755984000001:99.98945%,0.08394601119999999:0.00195%,0.0208806885:0.00195%,0.002116286:0.00156%,0.0:0.00156%,0.0021476384:0.00117%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08543524949999999:0.00039%,0.09248953609999999:0.00039%,0.0021633145999999997:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.97188%,0.8139250565:21.05156%,0.8029830673999999:18.16094%,0.8149336757:17.44414%,0.8137722355:17.35977%,0.0:0.00156%,0.0020936488:0.00117%,0.8166299895999999:0.00078%,1.0:0.00039%,0.9535729568000001:0.00039%,0.315972859:0.00039%,0.9834647595:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.7788831836:0.00039%,0.0021089309:0.00039%,0.9502261752:0.00039%,0.9054801638:0.00039%,0.8030136315999999:0.00039%,0.15243902439999998:0.00039%,0.9802707989:0.00039%,0.8411730545999999:0.00039%,0.8059172320999999:0.00039%,0.7593068036:0.00039%,0.7825203251999999:0.00039%,0.9344397579000001:0.00039%,0.15240846019999998:0.00039%,0.0818051226:0.00039%,0.9715599976:0.00039%]
[INFO] ** classification:[normal:64.39414%,Single Stage Single Point:35.60586%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02812%,1:25.97188%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.20:[0:82.55586%,1:17.44414%]
[INFO] ** src-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.201:[0:99.99648%,1:0.00352%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.83828%,1:18.16172%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.60:[0:61.58867%,1:38.41133%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:78.94844%,1:21.05156%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66797%,1:43.33203%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.55586%,1:17.44414%]
[INFO] ** dst-192.168.1.40:[0:81.83906%,1:18.16094%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99805%,1:0.00195%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99414%,0:0.00586%]
[INFO] ** proto-udp:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98945%,0:0.01055%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99609%,1:0.00391%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02812%,1:25.97188%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.55586%,1:17.44414%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.83828%,1:18.16172%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58867%,1:38.41133%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.98945%,1:0.01055%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00625%,1:49.99375%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98711%,1:0.01289%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64023%,1:17.35977%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02891%,1:25.97109%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94844%,1:21.05156%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.55586%,1:17.44414%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.83945%,1:18.16055%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      5, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164849.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      4, ..., 255992, 255993, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7054 - tp: 123640.0000 - fp: 68360.0000 - tn: 699640.0000 - fn: 68360.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9110 - val_loss: 0.7047 - val_tp: 41209.0000 - val_fp: 22791.0000 - val_tn: 233209.0000 - val_fn: 22791.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-20224000-20480000
[INFO] processing batch 20480000-20736000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0021633145999999997:0.00117%,0.002116286:0.00117%,0.0012540954:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.93828%,0.8139250565:21.09258%,0.8029830673999999:18.17773%,0.8149336757:17.43398%,0.8137722355:17.35234%,0.0021089309:0.00117%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.9502261752:0.00039%,0.8212604682:0.00039%,0.7788831836:0.00039%,0.0020936488:0.00039%,0.9088575095999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.38789%,Single Stage Single Point:35.61211%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.56523%,1:17.43477%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82227%,1:18.17773%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.55508%,1:38.44492%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.90742%,1:21.09258%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70937%,1:43.29062%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.56562%,1:17.43438%]
[INFO] ** dst-192.168.1.40:[0:81.82227%,1:18.17773%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56523%,1:17.43477%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82227%,1:18.17773%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55508%,1:38.44492%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64805%,1:17.35195%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06172%,1:25.93828%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90742%,1:21.09258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56602%,1:17.43398%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82227%,1:18.17773%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      3,      4, ..., 255995, 255997, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      1,      8, ..., 255993, 255996, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7041 - tp: 123598.0000 - fp: 68402.0000 - tn: 699598.0000 - fn: 68402.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9109 - val_loss: 0.7030 - val_tp: 41235.0000 - val_fp: 22765.0000 - val_tn: 233235.0000 - val_fn: 22765.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-20480000-20736000
[INFO] processing batch 20736000-20992000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0:0.00078%]
[INFO] ** s_port:[0.834280824:25.98789%,0.8139250565:21.075%,0.8029830673999999:18.09727%,0.8149336757:17.45625%,0.8137722355:17.38125%,0.8030136315999999:0.00078%,0.814841983:0.00078%,0.0:0.00078%]
[INFO] ** classification:[normal:64.4457%,Single Stage Single Point:35.5543%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01211%,1:25.98789%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54297%,1:17.45703%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.90195%,1:18.09805%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54375%,1:38.45625%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.925%,1:21.075%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63086%,1:43.36914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54375%,1:17.45625%]
[INFO] ** dst-192.168.1.40:[0:81.90273%,1:18.09727%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01211%,1:25.98789%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54297%,1:17.45703%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.90195%,1:18.09805%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54375%,1:38.45625%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61875%,1:17.38125%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01289%,1:25.98711%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92539%,1:21.07461%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54453%,1:17.45547%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.90273%,1:18.09727%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 8, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255989, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7022 - tp: 123769.0000 - fp: 68231.0000 - tn: 699769.0000 - fn: 68231.0000 - accuracy: 0.8579 - precision: 0.6446 - recall: 0.6446 - auc: 0.9112 - val_loss: 0.7019 - val_tp: 41212.0000 - val_fp: 22788.0000 - val_tn: 233212.0000 - val_fn: 22788.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-20736000-20992000
[INFO] processing batch 20992000-21248000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:64919 (25.35898%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.97148%,0.8139250565:21.03398%,0.8029830673999999:18.17773%,0.8149336757:17.49805%,0.8137722355:17.31641%,0.8059172320999999:0.00078%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.32344%,Single Stage Single Point:35.67656%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02773%,1:25.97227%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50156%,1:17.49844%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82188%,1:18.17813%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.64961%,1:38.35039%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.96602%,1:21.03398%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71172%,1:43.28828%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50156%,1:17.49844%]
[INFO] ** dst-192.168.1.40:[0:81.82188%,1:18.17813%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02773%,1:25.97227%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50156%,1:17.49844%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82188%,1:18.17813%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.64961%,1:38.35039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68359%,1:17.31641%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02852%,1:25.97148%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96602%,1:21.03398%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50195%,1:17.49805%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82266%,1:18.17734%]
[INFO] columns with count within 2-10 {'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      9, ..., 255991, 255992, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7019 - tp: 123459.0000 - fp: 68541.0000 - tn: 699459.0000 - fn: 68541.0000 - accuracy: 0.8572 - precision: 0.6430 - recall: 0.6430 - auc: 0.9108 - val_loss: 0.7007 - val_tp: 41209.0000 - val_fp: 22791.0000 - val_tn: 233209.0000 - val_fn: 22791.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-20992000-21248000
[INFO] processing batch 21248000-21504000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:65321 (25.51602%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00117%,0.08391465880000001:0.00078%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.92227%,0.8139250565:21.08281%,0.8029830673999999:18.1707%,0.8149336757:17.42852%,0.8137722355:17.3918%,0.0:0.00117%,0.0818051226:0.00078%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.0020936488:0.00039%,0.8683752063:0.00039%]
[INFO] ** classification:[normal:64.40078%,Single Stage Single Point:35.59922%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.07656%,1:25.92344%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.57148%,1:17.42852%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.8293%,1:18.1707%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.52539%,1:38.47461%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.91719%,1:21.08281%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68594%,1:43.31406%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.57148%,1:17.42852%]
[INFO] ** dst-192.168.1.40:[0:81.82891%,1:18.17109%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.07656%,1:25.92344%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.57148%,1:17.42852%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8293%,1:18.1707%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.52539%,1:38.47461%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60859%,1:17.39141%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.07812%,1:25.92188%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91719%,1:21.08281%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.57148%,1:17.42852%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8293%,1:18.1707%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      5, ..., 255993, 255994, 255995]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6998 - tp: 123683.0000 - fp: 68317.0000 - tn: 699683.0000 - fn: 68317.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9110 - val_loss: 0.6997 - val_tp: 41183.0000 - val_fp: 22817.0000 - val_tn: 233183.0000 - val_fn: 22817.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-21248000-21504000
[INFO] processing batch 21504000-21760000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:60727 (23.72148%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99648%,0.8139250565:21.01445%,0.8029830673999999:18.12266%,0.8149336757:17.49414%,0.8137722355:17.36992%,0.8030136315999999:0.00078%,0.8059172320999999:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.38203%,Single Stage Single Point:35.61797%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00352%,1:25.99648%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50547%,1:17.49453%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87617%,1:18.12383%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.61562%,1:38.38438%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.98555%,1:21.01445%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6332%,1:43.3668%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50586%,1:17.49414%]
[INFO] ** dst-192.168.1.40:[0:81.87734%,1:18.12266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00352%,1:25.99648%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50547%,1:17.49453%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87617%,1:18.12383%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.61562%,1:38.38438%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63008%,1:17.36992%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00391%,1:25.99609%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.98555%,1:21.01445%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50664%,1:17.49336%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87734%,1:18.12266%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255993, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255995, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6990 - tp: 123564.0000 - fp: 68436.0000 - tn: 699564.0000 - fn: 68436.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.9109 - val_loss: 0.6977 - val_tp: 41254.0000 - val_fp: 22746.0000 - val_tn: 233254.0000 - val_fn: 22746.0000 - val_accuracy: 0.8578 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-21504000-21760000
[INFO] processing batch 21760000-22016000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:56134 (21.92734%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00078%]
[INFO] ** s_port:[0.834280824:25.90469%,0.8139250565:21.12695%,0.8029830673999999:18.12656%,0.8149336757:17.425%,0.8137722355:17.41367%,0.814841983:0.00117%,0.8166299895999999:0.00078%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:64.44805%,Single Stage Single Point:35.55195%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09453%,1:25.90547%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.57344%,1:17.42656%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87344%,1:18.12656%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.45938%,1:38.54062%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.87305%,1:21.12695%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68164%,1:43.31836%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.57461%,1:17.42539%]
[INFO] ** dst-192.168.1.40:[0:81.87305%,1:18.12695%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09453%,1:25.90547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.57344%,1:17.42656%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87344%,1:18.12656%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.45938%,1:38.54062%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.58633%,1:17.41367%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0957%,1:25.9043%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.87305%,1:21.12695%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.575%,1:17.425%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87344%,1:18.12656%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      6, ..., 255994, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164987.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      4, ..., 255995, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6973 - tp: 123717.0000 - fp: 68283.0000 - tn: 699717.0000 - fn: 68283.0000 - accuracy: 0.8577 - precision: 0.6444 - recall: 0.6444 - auc: 0.9111 - val_loss: 0.6964 - val_tp: 41270.0000 - val_fp: 22730.0000 - val_tn: 233270.0000 - val_fn: 22730.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-21760000-22016000
[INFO] processing batch 22016000-22272000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65090 (25.42578%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00078%,0.09248953609999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.9543%,0.8139250565:21.04297%,0.8029830673999999:18.15234%,0.8149336757:17.475%,0.8137722355:17.37266%,0.8059172320999999:0.00078%,0.0:0.00078%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:64.37266%,Single Stage Single Point:35.62734%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04531%,1:25.95469%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.525%,1:17.475%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58438%,1:38.41562%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.95703%,1:21.04297%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67305%,1:43.32695%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.525%,1:17.475%]
[INFO] ** dst-192.168.1.40:[0:81.84766%,1:18.15234%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04531%,1:25.95469%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.525%,1:17.475%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58438%,1:38.41562%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62773%,1:17.37227%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04609%,1:25.95391%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95742%,1:21.04258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.525%,1:17.475%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84766%,1:18.15234%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255995, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164794.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      7, ..., 255992, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6962 - tp: 123690.0000 - fp: 68310.0000 - tn: 699690.0000 - fn: 68310.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9111 - val_loss: 0.6969 - val_tp: 41104.0000 - val_fp: 22896.0000 - val_tn: 233104.0000 - val_fn: 22896.0000 - val_accuracy: 0.8569 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-22016000-22272000
[INFO] processing batch 22272000-22528000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00234%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.97461%,0.8139250565:21.1%,0.8029830673999999:18.12305%,0.8149336757:17.45625%,0.8137722355:17.3418%,0.0:0.00234%,0.8059172320999999:0.00039%,0.0818051226:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.41992%,Single Stage Single Point:35.58008%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02461%,1:25.97539%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54375%,1:17.45625%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.87656%,1:18.12344%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.5582%,1:38.4418%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:78.9%,1:21.1%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6832%,1:43.3168%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54336%,1:17.45664%]
[INFO] ** dst-192.168.1.40:[0:81.87695%,1:18.12305%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02461%,1:25.97539%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54375%,1:17.45625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87656%,1:18.12344%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5582%,1:38.4418%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6582%,1:17.3418%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02578%,1:25.97422%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.9%,1:21.1%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54453%,1:17.45547%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87734%,1:18.12266%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255993, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255995, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6951 - tp: 123672.0000 - fp: 68328.0000 - tn: 699672.0000 - fn: 68328.0000 - accuracy: 0.8577 - precision: 0.6441 - recall: 0.6441 - auc: 0.9110 - val_loss: 0.6944 - val_tp: 41243.0000 - val_fp: 22757.0000 - val_tn: 233243.0000 - val_fn: 22757.0000 - val_accuracy: 0.8578 - val_precision: 0.6444 - val_recall: 0.6444 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-22272000-22528000
[INFO] processing batch 22528000-22784000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.96172%,0.8139250565:21.05625%,0.8029830673999999:18.09258%,0.8149336757:17.4875%,0.8137722355:17.40039%,0.8059172320999999:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.41992%,Single Stage Single Point:35.58008%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.51172%,1:17.48828%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.90742%,1:18.09258%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54336%,1:38.45664%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.94336%,1:21.05664%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63789%,1:43.36211%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.5125%,1:17.4875%]
[INFO] ** dst-192.168.1.40:[0:81.90703%,1:18.09297%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51172%,1:17.48828%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.90742%,1:18.09258%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54336%,1:38.45664%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99805%,1:0.00195%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.59961%,1:17.40039%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03828%,1:25.96172%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94414%,1:21.05586%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5125%,1:17.4875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.90742%,1:18.09258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 's_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      5,      7, ..., 255990, 255991, 255996]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6942 - tp: 123623.0000 - fp: 68377.0000 - tn: 699623.0000 - fn: 68377.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.6928 - val_tp: 41292.0000 - val_fp: 22708.0000 - val_tn: 233292.0000 - val_fn: 22708.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.9113
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-22528000-22784000
[INFO] processing batch 22784000-23040000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:56752 (22.16875%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.00898%,0.8139250565:21.04414%,0.8029830673999999:18.06172%,0.8149336757:17.50859%,0.8137722355:17.37383%,0.814841983:0.00117%,0.9344397579000001:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.4293%,Single Stage Single Point:35.5707%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.99023%,1:26.00977%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.93828%,1:18.06172%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58203%,1:38.41797%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.95586%,1:21.04414%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61719%,1:43.38281%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.49102%,1:17.50898%]
[INFO] ** dst-192.168.1.40:[0:81.93828%,1:18.06172%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.99023%,1:26.00977%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.93828%,1:18.06172%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58203%,1:38.41797%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62656%,1:17.37344%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9918%,1:26.0082%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95586%,1:21.04414%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49141%,1:17.50859%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.93828%,1:18.06172%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      6, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      4, ..., 255989, 255993, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6926 - tp: 123759.0000 - fp: 68241.0000 - tn: 699759.0000 - fn: 68241.0000 - accuracy: 0.8578 - precision: 0.6446 - recall: 0.6446 - auc: 0.9111 - val_loss: 0.6928 - val_tp: 41180.0000 - val_fp: 22820.0000 - val_tn: 233180.0000 - val_fn: 22820.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-22784000-23040000
[INFO] processing batch 23040000-23296000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:56178 (21.94453%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.86328%,0.8139250565:21.12305%,0.8029830673999999:18.19102%,0.8149336757:17.44766%,0.8137722355:17.37188%,0.8059172320999999:0.00078%,0.8030136315999999:0.00078%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.36016%,Single Stage Single Point:35.63984%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.13555%,1:25.86445%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.55234%,1:17.44766%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.50508%,1:38.49492%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.87695%,1:21.12305%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.76445%,1:43.23555%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.55234%,1:17.44766%]
[INFO] ** dst-192.168.1.40:[0:81.80859%,1:18.19141%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.13555%,1:25.86445%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.55234%,1:17.44766%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.50508%,1:38.49492%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00156%,0:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62812%,1:17.37188%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.13672%,1:25.86328%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.87734%,1:21.12266%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.55273%,1:17.44727%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80937%,1:18.19062%]
[INFO] columns with count within 2-10 {'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      5, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      4, ..., 255989, 255994, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6924 - tp: 123507.0000 - fp: 68493.0000 - tn: 699507.0000 - fn: 68493.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.9108 - val_loss: 0.6911 - val_tp: 41255.0000 - val_fp: 22745.0000 - val_tn: 233255.0000 - val_fn: 22745.0000 - val_accuracy: 0.8578 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-23040000-23296000
[INFO] processing batch 23296000-23552000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:56269 (21.98008%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.94531%,0.8139250565:21.08359%,0.8029830673999999:18.17734%,0.8149336757:17.44219%,0.8137722355:17.35078%,0.1074637814:0.00039%,0.8059172320999999:0.00039%]
[INFO] ** classification:[normal:64.38047%,Single Stage Single Point:35.61953%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05469%,1:25.94531%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.55781%,1:17.44219%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82266%,1:18.17734%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.56562%,1:38.43437%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91641%,1:21.08359%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70391%,1:43.29609%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.55781%,1:17.44219%]
[INFO] ** dst-192.168.1.40:[0:81.82266%,1:18.17734%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05469%,1:25.94531%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.55781%,1:17.44219%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82266%,1:18.17734%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56562%,1:38.43437%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99844%,1:0.00156%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64922%,1:17.35078%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.05547%,1:25.94453%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91641%,1:21.08359%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.55781%,1:17.44219%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82266%,1:18.17734%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 's_port': 7, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255995, 255996, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      7, ..., 255991, 255997, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6911 - tp: 123601.0000 - fp: 68399.0000 - tn: 699601.0000 - fn: 68399.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.6905 - val_tp: 41213.0000 - val_fp: 22787.0000 - val_tn: 233213.0000 - val_fn: 22787.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-23296000-23552000
[INFO] processing batch 23552000-23808000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:55508 (21.68281%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00547%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.96953%,0.8139250565:21.09688%,0.8029830673999999:18.04336%,0.8149336757:17.48633%,0.8137722355:17.39492%,0.0:0.00547%,0.9715599976:0.00039%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.9535729568000001:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.46914%,Single Stage Single Point:35.53086%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_name-eth1:[1:99.99453%,0:0.00547%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99453%,1:0.00547%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.51328%,1:17.48672%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.95586%,1:18.04414%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99453%,1:0.00547%]
[INFO] ** dst-192.168.1.10:[0:78.90312%,1:21.09688%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63516%,1:43.36484%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.51328%,1:17.48672%]
[INFO] ** dst-192.168.1.40:[0:81.95664%,1:18.04336%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99453%,1:0.00547%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99453%,1:0.00547%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51328%,1:17.48672%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.95586%,1:18.04414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60547%,1:17.39453%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03047%,1:25.96953%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90312%,1:21.09688%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51367%,1:17.48633%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.95664%,1:18.04336%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      3,      8, ..., 255990, 255994, 255995]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6896 - tp: 123749.0000 - fp: 68251.0000 - tn: 699749.0000 - fn: 68251.0000 - accuracy: 0.8578 - precision: 0.6445 - recall: 0.6445 - auc: 0.9111 - val_loss: 0.6887 - val_tp: 41292.0000 - val_fp: 22708.0000 - val_tn: 233292.0000 - val_fn: 22708.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.9113
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-23552000-23808000
[INFO] processing batch 23808000-24064000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:54330 (21.22266%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0:0.00078%]
[INFO] ** s_port:[0.834280824:25.92031%,0.8139250565:21.05508%,0.8029830673999999:18.13008%,0.8149336757:17.50703%,0.8137722355:17.38398%,0.814841983:0.00117%,0.8343113882:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%]
[INFO] ** classification:[normal:64.3625%,Single Stage Single Point:35.6375%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.07852%,1:25.92148%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4918%,1:17.5082%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86953%,1:18.13047%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.56094%,1:38.43906%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.94492%,1:21.05508%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6957%,1:43.3043%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49297%,1:17.50703%]
[INFO] ** dst-192.168.1.40:[0:81.86953%,1:18.13047%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.07852%,1:25.92148%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4918%,1:17.5082%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86953%,1:18.13047%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56094%,1:38.43906%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61602%,1:17.38398%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.08008%,1:25.91992%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94531%,1:21.05469%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49375%,1:17.50625%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87031%,1:18.12969%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      5, ..., 255995, 255996, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164768.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      4, ..., 255989, 255997, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6891 - tp: 123603.0000 - fp: 68397.0000 - tn: 699603.0000 - fn: 68397.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.6890 - val_tp: 41165.0000 - val_fp: 22835.0000 - val_tn: 233165.0000 - val_fn: 22835.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-23808000-24064000
[INFO] processing batch 24064000-24320000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:53384 (20.85312%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.0:0.00117%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.96133%,0.8139250565:21.07148%,0.8029830673999999:18.16055%,0.8149336757:17.4707%,0.8137722355:17.32969%,0.0:0.00117%,0.0020936488:0.00078%,0.8059172320999999:0.00078%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.15243902439999998:0.00039%,0.8147502904:0.00039%,0.7586191087:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:64.36836%,Single Stage Single Point:35.63164%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52891%,1:17.47109%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.83945%,1:18.16055%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.92852%,1:21.07148%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70898%,1:43.29102%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.52891%,1:17.47109%]
[INFO] ** dst-192.168.1.40:[0:81.83906%,1:18.16094%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52891%,1:17.47109%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.83945%,1:18.16055%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67031%,1:17.32969%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03906%,1:25.96094%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92852%,1:21.07148%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5293%,1:17.4707%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.83945%,1:18.16055%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255995, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      9, ..., 255993, 255996, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.6882 - tp: 123599.0000 - fp: 68401.0000 - tn: 699599.0000 - fn: 68401.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9109 - val_loss: 0.6879 - val_tp: 41184.0000 - val_fp: 22816.0000 - val_tn: 233184.0000 - val_fn: 22816.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-24064000-24320000
[INFO] processing batch 24320000-24576000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:63855 (24.94336%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.002116286:0.00078%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90703%,0.8139250565:21.06953%,0.8029830673999999:18.22578%,0.8149336757:17.47305%,0.8137722355:17.3207%,0.0:0.00117%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,1.0:0.00039%,0.8344030809:0.00039%,0.8673054588:0.00039%,0.9088575095999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.30039%,Single Stage Single Point:35.69961%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09258%,1:25.90742%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52695%,1:17.47305%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77344%,1:18.22656%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.60977%,1:38.39023%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.93047%,1:21.06953%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.77188%,1:43.22812%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.52695%,1:17.47305%]
[INFO] ** dst-192.168.1.40:[0:81.77383%,1:18.22617%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09258%,1:25.90742%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52695%,1:17.47305%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77344%,1:18.22656%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.60977%,1:38.39023%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67969%,1:17.32031%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09336%,1:25.90664%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93086%,1:21.06914%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52695%,1:17.47305%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77422%,1:18.22578%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255994, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164609.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      6, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.6878 - tp: 123440.0000 - fp: 68560.0000 - tn: 699440.0000 - fn: 68560.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.9107 - val_loss: 0.6871 - val_tp: 41169.0000 - val_fp: 22831.0000 - val_tn: 233169.0000 - val_fn: 22831.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-24320000-24576000
[INFO] processing batch 24576000-24832000/24819975
[33m[LOSS] 0.6871366300582886[0m
[33m[INFO] epoch 3/3[0m
[33m[INFO] loading file 1-50/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (24819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[33mencode_text_dummy orig[0m
[33mencode_text_dummy type[0m
[33mencode_text_dummy i/f_name[0m
[33mencode_text_dummy i/f_dir[0m
[33mencode_text_dummy src[0m
[33mencode_text_dummy dst[0m
[33mencode_text_dummy proto[0m
[33mencode_text_dummy appi_name[0m
[33mencode_text_dummy proxy_src_ip[0m
[33mencode_text_dummy modbus_function_description[0m
[33mencode_text_dummy scada_tag[0m
len(df.columns) 108
numFeatures 107
[INFO] columns: Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'orig-192.168.1.87',
       'orig-192.168.1.88', 'type-alert',
       ...
       'modbus_function_description-Read Tag Service',
       'modbus_function_description-Read Tag Service - Response',
       'modbus_function_description-Unknown Function Code',
       'modbus_function_description-Write Tag Service', 'scada_tag-0',
       'scada_tag-HMI_AIT202', 'scada_tag-HMI_FIT201', 'scada_tag-HMI_LIT101',
       'scada_tag-HMI_LIT301', 'scada_tag-HMI_LIT401'],
      dtype='object', length=108)
[INFO] analyze dataset: (24819975, 108)

[INFO] analyzing data
[INFO] 24819975 rows
[INFO] ** unixtime:67474 (0.27185%)
[INFO] ** modbus_function_code:[0.9743589744:99.99716%,0.0:0.0028%,1.0:4e-05%,0.9615384615000001:0.0%,0.9871794872:0.0%]
[INFO] ** modbus_transaction_id:65536 (0.26405%)
[INFO] ** service:[0.7025755984000001:99.99736%,0.0:0.00126%,0.08394601119999999:0.00023%,0.0021633145999999997:0.00021%,0.0021476384:0.00021%,0.0208806885:0.00017%,0.002116286:0.00017%,0.08391465880000001:0.00013%,0.0297847659:7e-05%,0.0021789908:5e-05%,0.0012540954:5e-05%,0.09248953609999999:4e-05%,0.08543524949999999:4e-05%,0.0348324999:1e-05%,1.0:0.0%]
[INFO] ** s_port:[0.834280824:26.01285%,0.8139250565:20.97143%,0.8029830673999999:18.17391%,0.8149336757:17.51381%,0.8137722355:17.32337%,0.0:0.00126%,0.814841983:0.00035%,0.8059172320999999:0.00033%,0.8343113882:0.00029%,0.8030136315999999:0.00025%,0.0020936488:0.00021%,0.0021089309:0.00021%,0.8345253376999999:0.00018%,0.8030441959000001:0.00014%,0.8344030809:0.00014%,0.0818051226:0.00013%,0.8147502904:0.00011%,0.8166299895999999:9e-05%,0.7788831836:4e-05%,0.8411730545999999:4e-05%,0.15240846019999998:4e-05%,0.7586191087:4e-05%,0.9834647595:4e-05%,0.9715599976:4e-05%,0.7593068036:4e-05%,0.15243902439999998:4e-05%,0.315972859:4e-05%,0.0290360046:3e-05%,0.2528119078:3e-05%,0.8876612262000001:3e-05%,0.9344397579000001:3e-05%,0.9535729568000001:3e-05%,0.1074484993:2e-05%,0.792988569:2e-05%,0.9502261752:2e-05%,0.7579772602:2e-05%,0.705452656:2e-05%,0.7414573018:2e-05%,0.7077908184999999:2e-05%,0.6970474968000001:2e-05%,0.8868054282:2e-05%,0.9802707989:2e-05%,0.9054801638:2e-05%,0.6452258696000001:2e-05%,0.8685433095:1e-05%,0.980989058:1e-05%,0.8465523565:1e-05%,0.9621003729000001:1e-05%,0.8831377224:1e-05%,0.9399107525:1e-05%,0.7825203251999999:1e-05%,0.9004676325:1e-05%,0.8212604682:1e-05%,0.9088575095999999:1e-05%,0.8738156367000001:1e-05%,0.8711259856999999:1e-05%,0.8643407299:1e-05%,0.8668928418999999:1e-05%,0.45597224770000006:1e-05%,0.7897640443:1e-05%,0.0339568433:1e-05%,0.905082829:1e-05%,0.8870957883:1e-05%,1.0:1e-05%,0.9156580476:0.0%,0.8683752063:0.0%,0.8935448376999999:0.0%,0.1074637814:0.0%,0.9339660126:0.0%,0.8591448133:0.0%,0.9842747112000001:0.0%,0.9034629256000001:0.0%,0.8262729995999999:0.0%,0.0818356868:0.0%,0.8881655358:0.0%,0.8916498562999999:0.0%,0.8985420868999999:0.0%,0.7673146279999999:0.0%,0.9765266826000001:0.0%,0.8673054588:0.0%,0.7918882572:0.0%,0.7891527599:0.0%,0.8431597286:0.0%,0.9104621309:0.0%]
[INFO] ** classification:[normal:75.94865%,Single Stage Single Point:20.68165%,Multi Stage Single Point:1.90264%,Single Stage Multi Point:0.95195%,Multi Stage Multi Point:0.5151%]
[INFO] ** orig-192.168.1.48:[1:99.9996%,0:0.0004%]
[INFO] ** orig-192.168.1.87:[0:99.99993%,1:7e-05%]
[INFO] ** orig-192.168.1.88:[0:99.99967%,1:0.00033%]
[INFO] ** type-alert:[0:99.99996%,1:4e-05%]
[INFO] ** type-control:[0:99.99975%,1:0.00025%]
[INFO] ** type-log:[1:99.99971%,0:0.00029%]
[INFO] ** i/f_name-0:[0:99.99875%,1:0.00125%]
[INFO] ** i/f_name-eth1:[1:99.99874%,0:0.00126%]
[INFO] ** i/f_name-geod daemon:[0:100.0%,1:0.0%]
[INFO] ** i/f_dir-inbound:[0:99.99885%,1:0.00115%]
[INFO] ** i/f_dir-outbound:[1:99.99885%,0:0.00115%]
[INFO] ** src-0:[0:99.99907%,1:0.00093%]
[INFO] ** src-10.15.51.65:[0:100.0%,1:0.0%]
[INFO] ** src-192.168.1.10:[0:73.98655%,1:26.01345%]
[INFO] ** src-192.168.1.134:[0:99.99995%,1:5e-05%]
[INFO] ** src-192.168.1.136:[0:99.99982%,1:0.00018%]
[INFO] ** src-192.168.1.19:[0:99.99978%,1:0.00022%]
[INFO] ** src-192.168.1.199:[0:99.99989%,1:0.00011%]
[INFO] ** src-192.168.1.20:[0:82.48573%,1:17.51427%]
[INFO] ** src-192.168.1.200:[0:99.99981%,1:0.00019%]
[INFO] ** src-192.168.1.201:[0:99.99966%,1:0.00034%]
[INFO] ** src-192.168.1.202:[0:99.99997%,1:3e-05%]
[INFO] ** src-192.168.1.30:[0:81.82569%,1:18.17431%]
[INFO] ** src-192.168.1.40:[0:99.99967%,1:0.00033%]
[INFO] ** src-192.168.1.49:[0:99.99973%,1:0.00027%]
[INFO] ** src-192.168.1.60:[0:61.7052%,1:38.2948%]
[INFO] ** src-192.168.1.88:[0:99.9995%,1:0.0005%]
[INFO] ** dst-0:[0:99.99874%,1:0.00126%]
[INFO] ** dst-192.168.1.10:[0:79.02848%,1:20.97152%]
[INFO] ** dst-192.168.1.100:[0:99.99996%,1:4e-05%]
[INFO] ** dst-192.168.1.19:[0:99.99996%,1:4e-05%]
[INFO] ** dst-192.168.1.20:[0:56.66363%,1:43.33637%]
[INFO] ** dst-192.168.1.200:[0:99.99993%,1:7e-05%]
[INFO] ** dst-192.168.1.201:[0:99.99973%,1:0.00027%]
[INFO] ** dst-192.168.1.255:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.30:[0:82.48595%,1:17.51405%]
[INFO] ** dst-192.168.1.40:[0:81.8258%,1:18.1742%]
[INFO] ** dst-192.168.1.49:[0:99.99998%,1:2e-05%]
[INFO] ** dst-192.168.1.50:[0:99.99902%,1:0.00098%]
[INFO] ** dst-192.168.1.60:[0:99.99975%,1:0.00025%]
[INFO] ** dst-192.168.1.88:[0:99.99991%,1:9e-05%]
[INFO] ** dst-224.0.0.251:[0:99.99987%,1:0.00013%]
[INFO] ** dst-224.0.0.252:[0:99.99977%,1:0.00023%]
[INFO] ** dst-239.192.4.191:[0:99.99999%,1:1e-05%]
[INFO] ** dst-239.255.255.250:[0:99.99993%,1:7e-05%]
[INFO] ** proto-0:[0:99.99874%,1:0.00126%]
[INFO] ** proto-tcp:[1:99.99788%,0:0.00212%]
[INFO] ** proto-udp:[0:99.99913%,1:0.00087%]
[INFO] ** appi_name-0:[0:99.99869%,1:0.00131%]
[INFO] ** appi_name-CIP_func75:[0:100.0%,1:0.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99996%,1:4e-05%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99716%,0:0.00284%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%,1:0.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99999%,1:1e-05%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99998%,1:2e-05%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99998%,1:2e-05%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%,1:0.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99984%,1:0.00016%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%,1:0.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99996%,1:4e-05%]
[INFO] ** appi_name-Google Chrome:[0:100.0%,1:0.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99979%,1:0.00021%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99987%,1:0.00013%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99979%,1:0.00021%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99998%,1:2e-05%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99996%,1:4e-05%]
[INFO] ** appi_name-SSDP:[0:99.99993%,1:7e-05%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99983%,1:0.00017%]
[INFO] ** appi_name-VNC:[0:99.99997%,1:3e-05%]
[INFO] ** appi_name-Web Browsing:[0:99.99996%,1:4e-05%]
[INFO] ** proxy_src_ip-0:[0:99.99869%,1:0.00131%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%,1:0.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.98655%,1:26.01345%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99996%,1:4e-05%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99978%,1:0.00022%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.9999%,1:0.0001%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48573%,1:17.51427%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99968%,1:0.00032%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99997%,1:3e-05%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82569%,1:18.17431%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99967%,1:0.00033%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99973%,1:0.00027%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.7052%,1:38.2948%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99983%,1:0.00017%]
[INFO] ** modbus_function_description-0:[0:99.9972%,1:0.0028%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99996%,1:4e-05%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00222%,1:49.99778%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00062%,1:49.99938%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%,1:0.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%,1:0.0%]
[INFO] ** scada_tag-0:[0:99.9944%,1:0.0056%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67675%,1:17.32325%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98751%,1:26.01249%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.02869%,1:20.97131%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.48643%,1:17.51357%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82621%,1:18.17379%]
[INFO] columns with count within 2-10 {'modbus_function_code': 5, 'classification': 5, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_name-geod daemon': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-10.15.51.65': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.192.4.191': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_func75': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-CIP_write_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-Common Industrial Protocol - success': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-DNP3 Protocol - initialize data to defaults': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Google Chrome': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-VNC': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-10.15.51.65': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'modbus_function_description-Unknown Function Code': 2, 'modbus_function_description-Write Tag Service': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
--------------AFTER DROPPING COLUMNS ----------------
df.columns Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'orig-192.168.1.87',
       'orig-192.168.1.88', 'type-alert',
       ...
       'modbus_function_description-Read Tag Service',
       'modbus_function_description-Read Tag Service - Response',
       'modbus_function_description-Unknown Function Code',
       'modbus_function_description-Write Tag Service', 'scada_tag-0',
       'scada_tag-HMI_AIT202', 'scada_tag-HMI_FIT201', 'scada_tag-HMI_LIT101',
       'scada_tag-HMI_LIT301', 'scada_tag-HMI_LIT401'],
      dtype='object', length=108) 108
          unixtime  modbus_function_code  modbus_transaction_id   service  \
0         0.000000              0.974359               0.105043  0.702576   
1         0.000000              0.974359               0.049699  0.702576   
2         0.000000              0.974359               0.760021  0.702576   
3         0.000000              0.974359               0.724208  0.702576   
4         0.000000              0.974359               0.099031  0.702576   
...            ...                   ...                    ...       ...   
24819970  0.587998              0.974359               0.724636  0.702576   
24819971  0.587998              0.974359               0.447852  0.702576   
24819972  0.587998              0.974359               0.724636  0.702576   
24819973  0.587998              0.974359               0.652247  0.702576   
24819974  0.587998              0.974359               0.004623  0.702576   

            s_port             classification  orig-192.168.1.48  \
0         0.813772                     normal                  1   
1         0.834281                     normal                  1   
2         0.802983                     normal                  1   
3         0.814934                     normal                  1   
4         0.813925                     normal                  1   
...            ...                        ...                ...   
24819970  0.813925                     normal                  1   
24819971  0.813772                     normal                  1   
24819972  0.813925                     normal                  1   
24819973  0.834281                     normal                  1   
24819974  0.814934  Single Stage Single Point                  1   

          orig-192.168.1.87  orig-192.168.1.88  type-alert  type-control  \
0                         0                  0           0             0   
1                         0                  0           0             0   
2                         0                  0           0             0   
3                         0                  0           0             0   
4                         0                  0           0             0   
...                     ...                ...         ...           ...   
24819970                  0                  0           0             0   
24819971                  0                  0           0             0   
24819972                  0                  0           0             0   
24819973                  0                  0           0             0   
24819974                  0                  0           0             0   

          type-log  i/f_name-0  i/f_name-eth1  i/f_name-geod daemon  \
0                1           0              1                     0   
1                1           0              1                     0   
2                1           0              1                     0   
3                1           0              1                     0   
4                1           0              1                     0   
...            ...         ...            ...                   ...   
24819970         1           0              1                     0   
24819971         1           0              1                     0   
24819972         1           0              1                     0   
24819973         1           0              1                     0   
24819974         1           0              1                     0   

          i/f_dir-inbound  i/f_dir-outbound  src-0  src-10.15.51.65  \
0                       0                 1      0                0   
1                       0                 1      0                0   
2                       0                 1      0                0   
3                       0                 1      0                0   
4                       0                 1      0                0   
...                   ...               ...    ...              ...   
24819970                0                 1      0                0   
24819971                0                 1      0                0   
24819972                0                 1      0                0   
24819973                0                 1      0                0   
24819974                0                 1      0                0   

          src-192.168.1.10  src-192.168.1.134  src-192.168.1.136  \
0                        0                  0                  0   
1                        1                  0                  0   
2                        0                  0                  0   
3                        0                  0                  0   
4                        0                  0                  0   
...                    ...                ...                ...   
24819970                 0                  0                  0   
24819971                 0                  0                  0   
24819972                 0                  0                  0   
24819973                 1                  0                  0   
24819974                 0                  0                  0   

          src-192.168.1.19  src-192.168.1.199  src-192.168.1.20  \
0                        0                  0                 0   
1                        0                  0                 0   
2                        0                  0                 0   
3                        0                  0                 1   
4                        0                  0                 0   
...                    ...                ...               ...   
24819970                 0                  0                 0   
24819971                 0                  0                 0   
24819972                 0                  0                 0   
24819973                 0                  0                 0   
24819974                 0                  0                 1   

          src-192.168.1.200  src-192.168.1.201  src-192.168.1.202  \
0                         0                  0                  0   
1                         0                  0                  0   
2                         0                  0                  0   
3                         0                  0                  0   
4                         0                  0                  0   
...                     ...                ...                ...   
24819970                  0                  0                  0   
24819971                  0                  0                  0   
24819972                  0                  0                  0   
24819973                  0                  0                  0   
24819974                  0                  0                  0   

          src-192.168.1.30  src-192.168.1.40  src-192.168.1.49  \
0                        0                 0                 0   
1                        0                 0                 0   
2                        1                 0                 0   
3                        0                 0                 0   
4                        0                 0                 0   
...                    ...               ...               ...   
24819970                 0                 0                 0   
24819971                 0                 0                 0   
24819972                 0                 0                 0   
24819973                 0                 0                 0   
24819974                 0                 0                 0   

          src-192.168.1.60  src-192.168.1.88  dst-0  dst-192.168.1.10  \
0                        1                 0      0                 0   
1                        0                 0      0                 0   
2                        0                 0      0                 0   
3                        0                 0      0                 0   
4                        1                 0      0                 1   
...                    ...               ...    ...               ...   
24819970                 1                 0      0                 1   
24819971                 1                 0      0                 0   
24819972                 1                 0      0                 1   
24819973                 0                 0      0                 0   
24819974                 0                 0      0                 0   

          dst-192.168.1.100  dst-192.168.1.19  dst-192.168.1.20  \
0                         0                 0                 1   
1                         0                 0                 1   
2                         0                 0                 0   
3                         0                 0                 0   
4                         0                 0                 0   
...                     ...               ...               ...   
24819970                  0                 0                 0   
24819971                  0                 0                 1   
24819972                  0                 0                 0   
24819973                  0                 0                 1   
24819974                  0                 0                 0   

          dst-192.168.1.200  dst-192.168.1.201  dst-192.168.1.255  \
0                         0                  0                  0   
1                         0                  0                  0   
2                         0                  0                  0   
3                         0                  0                  0   
4                         0                  0                  0   
...                     ...                ...                ...   
24819970                  0                  0                  0   
24819971                  0                  0                  0   
24819972                  0                  0                  0   
24819973                  0                  0                  0   
24819974                  0                  0                  0   

          dst-192.168.1.30  dst-192.168.1.40  dst-192.168.1.49  \
0                        0                 0                 0   
1                        0                 0                 0   
2                        0                 1                 0   
3                        1                 0                 0   
4                        0                 0                 0   
...                    ...               ...               ...   
24819970                 0                 0                 0   
24819971                 0                 0                 0   
24819972                 0                 0                 0   
24819973                 0                 0                 0   
24819974                 1                 0                 0   

          dst-192.168.1.50  dst-192.168.1.60  dst-192.168.1.88  \
0                        0                 0                 0   
1                        0                 0                 0   
2                        0                 0                 0   
3                        0                 0                 0   
4                        0                 0                 0   
...                    ...               ...               ...   
24819970                 0                 0                 0   
24819971                 0                 0                 0   
24819972                 0                 0                 0   
24819973                 0                 0                 0   
24819974                 0                 0                 0   

          dst-224.0.0.251  dst-224.0.0.252  dst-239.192.4.191  \
0                       0                0                  0   
1                       0                0                  0   
2                       0                0                  0   
3                       0                0                  0   
4                       0                0                  0   
...                   ...              ...                ...   
24819970                0                0                  0   
24819971                0                0                  0   
24819972                0                0                  0   
24819973                0                0                  0   
24819974                0                0                  0   

          dst-239.255.255.250  proto-0  proto-tcp  proto-udp  appi_name-0  \
0                           0        0          1          0            0   
1                           0        0          1          0            0   
2                           0        0          1          0            0   
3                           0        0          1          0            0   
4                           0        0          1          0            0   
...                       ...      ...        ...        ...          ...   
24819970                    0        0          1          0            0   
24819971                    0        0          1          0            0   
24819972                    0        0          1          0            0   
24819973                    0        0          1          0            0   
24819974                    0        0          1          0            0   

          appi_name-CIP_func75  appi_name-CIP_gen  \
0                            0                  0   
1                            0                  0   
2                            0                  0   
3                            0                  0   
4                            0                  0   
...                        ...                ...   
24819970                     0                  0   
24819971                     0                  0   
24819972                     0                  0   
24819973                     0                  0   
24819974                     0                  0   

          appi_name-CIP_read_tag_service  appi_name-CIP_write_tag_service  \
0                                      1                                0   
1                                      1                                0   
2                                      1                                0   
3                                      1                                0   
4                                      1                                0   
...                                  ...                              ...   
24819970                               1                                0   
24819971                               1                                0   
24819972                               1                                0   
24819973                               1                                0   
24819974                               1                                0   

          appi_name-Common Industrial Protocol  \
0                                            0   
1                                            0   
2                                            0   
3                                            0   
4                                            0   
...                                        ...   
24819970                                     0   
24819971                                     0   
24819972                                     0   
24819973                                     0   
24819974                                     0   

          appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)  \
0                                                         0                
1                                                         0                
2                                                         0                
3                                                         0                
4                                                         0                
...                                                     ...                
24819970                                                  0                
24819971                                                  0                
24819972                                                  0                
24819973                                                  0                
24819974                                                  0                

          appi_name-Common Industrial Protocol - get attribute all  \
0                                                         0          
1                                                         0          
2                                                         0          
3                                                         0          
4                                                         0          
...                                                     ...          
24819970                                                  0          
24819971                                                  0          
24819972                                                  0          
24819973                                                  0          
24819974                                                  0          

          appi_name-Common Industrial Protocol - get attribute single  \
0                                                         0             
1                                                         0             
2                                                         0             
3                                                         0             
4                                                         0             
...                                                     ...             
24819970                                                  0             
24819971                                                  0             
24819972                                                  0             
24819973                                                  0             
24819974                                                  0             

          appi_name-Common Industrial Protocol - multiple service packet  \
0                                                         0                
1                                                         0                
2                                                         0                
3                                                         0                
4                                                         0                
...                                                     ...                
24819970                                                  0                
24819971                                                  0                
24819972                                                  0                
24819973                                                  0                
24819974                                                  0                

          appi_name-Common Industrial Protocol - success  \
0                                                      0   
1                                                      0   
2                                                      0   
3                                                      0   
4                                                      0   
...                                                  ...   
24819970                                               0   
24819971                                               0   
24819972                                               0   
24819973                                               0   
24819974                                               0   

          appi_name-DCE-RPC Protocol  \
0                                  0   
1                                  0   
2                                  0   
3                                  0   
4                                  0   
...                              ...   
24819970                           0   
24819971                           0   
24819972                           0   
24819973                           0   
24819974                           0   

          appi_name-DNP3 Protocol - initialize data to defaults  \
0                                                         0       
1                                                         0       
2                                                         0       
3                                                         0       
4                                                         0       
...                                                     ...       
24819970                                                  0       
24819971                                                  0       
24819972                                                  0       
24819973                                                  0       
24819974                                                  0       

          appi_name-EtherNet/IP  appi_name-Google Chrome  \
0                             0                        0   
1                             0                        0   
2                             0                        0   
3                             0                        0   
4                             0                        0   
...                         ...                      ...   
24819970                      0                        0   
24819971                      0                        0   
24819972                      0                        0   
24819973                      0                        0   
24819974                      0                        0   

          appi_name-LLMNR Protocol  appi_name-Multicast DNS Protocol (mDNS)  \
0                                0                                        0   
1                                0                                        0   
2                                0                                        0   
3                                0                                        0   
4                                0                                        0   
...                            ...                                      ...   
24819970                         0                                        0   
24819971                         0                                        0   
24819972                         0                                        0   
24819973                         0                                        0   
24819974                         0                                        0   

          appi_name-NetBIOS Datagram Service  appi_name-NetBIOS Name Service  \
0                                          0                               0   
1                                          0                               0   
2                                          0                               0   
3                                          0                               0   
4                                          0                               0   
...                                      ...                             ...   
24819970                                   0                               0   
24819971                                   0                               0   
24819972                                   0                               0   
24819973                                   0                               0   
24819974                                   0                               0   

          appi_name-NetBIOS Session Service  appi_name-OSIsoft PI  \
0                                         0                     0   
1                                         0                     0   
2                                         0                     0   
3                                         0                     0   
4                                         0                     0   
...                                     ...                   ...   
24819970                                  0                     0   
24819971                                  0                     0   
24819972                                  0                     0   
24819973                                  0                     0   
24819974                                  0                     0   

          appi_name-SSDP  appi_name-Server Message Block (SMB)  \
0                      0                                     0   
1                      0                                     0   
2                      0                                     0   
3                      0                                     0   
4                      0                                     0   
...                  ...                                   ...   
24819970               0                                     0   
24819971               0                                     0   
24819972               0                                     0   
24819973               0                                     0   
24819974               0                                     0   

          appi_name-Unknown Traffic  appi_name-VNC  appi_name-Web Browsing  \
0                                 0              0                       0   
1                                 0              0                       0   
2                                 0              0                       0   
3                                 0              0                       0   
4                                 0              0                       0   
...                             ...            ...                     ...   
24819970                          0              0                       0   
24819971                          0              0                       0   
24819972                          0              0                       0   
24819973                          0              0                       0   
24819974                          0              0                       0   

          proxy_src_ip-0  proxy_src_ip-10.15.51.65  proxy_src_ip-192.168.1.10  \
0                      0                         0                          0   
1                      0                         0                          1   
2                      0                         0                          0   
3                      0                         0                          0   
4                      0                         0                          0   
...                  ...                       ...                        ...   
24819970               0                         0                          0   
24819971               0                         0                          0   
24819972               0                         0                          0   
24819973               0                         0                          1   
24819974               0                         0                          0   

          proxy_src_ip-192.168.1.134  proxy_src_ip-192.168.1.136  \
0                                  0                           0   
1                                  0                           0   
2                                  0                           0   
3                                  0                           0   
4                                  0                           0   
...                              ...                         ...   
24819970                           0                           0   
24819971                           0                           0   
24819972                           0                           0   
24819973                           0                           0   
24819974                           0                           0   

          proxy_src_ip-192.168.1.19  proxy_src_ip-192.168.1.199  \
0                                 0                           0   
1                                 0                           0   
2                                 0                           0   
3                                 0                           0   
4                                 0                           0   
...                             ...                         ...   
24819970                          0                           0   
24819971                          0                           0   
24819972                          0                           0   
24819973                          0                           0   
24819974                          0                           0   

          proxy_src_ip-192.168.1.20  proxy_src_ip-192.168.1.200  \
0                                 0                           0   
1                                 0                           0   
2                                 0                           0   
3                                 1                           0   
4                                 0                           0   
...                             ...                         ...   
24819970                          0                           0   
24819971                          0                           0   
24819972                          0                           0   
24819973                          0                           0   
24819974                          1                           0   

          proxy_src_ip-192.168.1.201  proxy_src_ip-192.168.1.202  \
0                                  0                           0   
1                                  0                           0   
2                                  0                           0   
3                                  0                           0   
4                                  0                           0   
...                              ...                         ...   
24819970                           0                           0   
24819971                           0                           0   
24819972                           0                           0   
24819973                           0                           0   
24819974                           0                           0   

          proxy_src_ip-192.168.1.30  proxy_src_ip-192.168.1.40  \
0                                 0                          0   
1                                 0                          0   
2                                 1                          0   
3                                 0                          0   
4                                 0                          0   
...                             ...                        ...   
24819970                          0                          0   
24819971                          0                          0   
24819972                          0                          0   
24819973                          0                          0   
24819974                          0                          0   

          proxy_src_ip-192.168.1.49  proxy_src_ip-192.168.1.60  \
0                                 0                          1   
1                                 0                          0   
2                                 0                          0   
3                                 0                          0   
4                                 0                          1   
...                             ...                        ...   
24819970                          0                          1   
24819971                          0                          1   
24819972                          0                          1   
24819973                          0                          0   
24819974                          0                          0   

          proxy_src_ip-192.168.1.88  modbus_function_description-0  \
0                                 0                              0   
1                                 0                              0   
2                                 0                              0   
3                                 0                              0   
4                                 0                              0   
...                             ...                            ...   
24819970                          0                              0   
24819971                          0                              0   
24819972                          0                              0   
24819973                          0                              0   
24819974                          0                              0   

          modbus_function_description-Forward Close - Response  \
0                                                         0      
1                                                         0      
2                                                         0      
3                                                         0      
4                                                         0      
...                                                     ...      
24819970                                                  0      
24819971                                                  0      
24819972                                                  0      
24819973                                                  0      
24819974                                                  0      

          modbus_function_description-Read Tag Service  \
0                                                    0   
1                                                    0   
2                                                    1   
3                                                    1   
4                                                    1   
...                                                ...   
24819970                                             1   
24819971                                             1   
24819972                                             0   
24819973                                             0   
24819974                                             1   

          modbus_function_description-Read Tag Service - Response  \
0                                                         1         
1                                                         1         
2                                                         0         
3                                                         0         
4                                                         0         
...                                                     ...         
24819970                                                  0         
24819971                                                  0         
24819972                                                  1         
24819973                                                  1         
24819974                                                  0         

          modbus_function_description-Unknown Function Code  \
0                                                         0   
1                                                         0   
2                                                         0   
3                                                         0   
4                                                         0   
...                                                     ...   
24819970                                                  0   
24819971                                                  0   
24819972                                                  0   
24819973                                                  0   
24819974                                                  0   

          modbus_function_description-Write Tag Service  scada_tag-0  \
0                                                     0            0   
1                                                     0            0   
2                                                     0            0   
3                                                     0            0   
4                                                     0            0   
...                                                 ...          ...   
24819970                                              0            0   
24819971                                              0            0   
24819972                                              0            0   
24819973                                              0            0   
24819974                                              0            0   

          scada_tag-HMI_AIT202  scada_tag-HMI_FIT201  scada_tag-HMI_LIT101  \
0                            1                     0                     0   
1                            0                     1                     0   
2                            0                     0                     0   
3                            0                     0                     0   
4                            0                     0                     1   
...                        ...                   ...                   ...   
24819970                     0                     0                     1   
24819971                     1                     0                     0   
24819972                     0                     0                     1   
24819973                     0                     1                     0   
24819974                     0                     0                     0   

          scada_tag-HMI_LIT301  scada_tag-HMI_LIT401  
0                            0                     0  
1                            0                     0  
2                            0                     1  
3                            1                     0  
4                            0                     0  
...                        ...                   ...  
24819970                     0                     0  
24819971                     0                     0  
24819972                     0                     0  
24819973                     0                     0  
24819974                     1                     0  

[24819975 rows x 108 columns]
[INFO] processing batch 0-256000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57548 (22.47969%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0021476384:0.00117%,0.0:0.00117%,0.0021789908:0.00078%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90586%,0.8139250565:21.04297%,0.8029830673999999:18.20469%,0.8149336757:17.47891%,0.8137722355:17.3582%,0.792988569:0.00156%,0.0:0.00117%,0.0020936488:0.00117%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00078%,0.7897640443:0.00078%,0.0818051226:0.00078%,0.0290360046:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.95547%,1:21.04453%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.73555%,1:43.26445%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.5207%,1:17.4793%]
[INFO] ** dst-192.168.1.40:[0:81.79531%,1:18.20469%]
[INFO] ** dst-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64219%,1:17.35781%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09453%,1:25.90547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95703%,1:21.04297%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52109%,1:17.47891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79531%,1:18.20469%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.4233 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.3743 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-0-256000
[INFO] processing batch 256000-512000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00703%]
[INFO] ** modbus_transaction_id:65264 (25.49375%)
[INFO] ** service:[0.7025755984000001:99.99297%,0.0208806885:0.00156%,0.002116286:0.00117%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0021789908:0.00078%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.89492%,0.8139250565:21.03672%,0.8029830673999999:18.12031%,0.8149336757:17.56719%,0.8137722355:17.37266%,0.0:0.00117%,0.0020936488:0.00078%,0.8685433095:0.00078%,0.8344030809:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.7593068036:0.00039%,0.9399107525:0.00039%,0.315972859:0.00039%,0.8668928418999999:0.00039%,0.8030136315999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8643407299:0.00039%,0.814841983:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:57.36133%,Single Stage Single Point:42.63867%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.10469%,1:25.89531%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.43242%,1:17.56758%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8793%,1:18.1207%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.60:[0:61.59062%,1:38.40938%]
[INFO] ** src-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.96328%,1:21.03672%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.73242%,1:43.26758%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.43281%,1:17.56719%]
[INFO] ** dst-192.168.1.40:[0:81.8793%,1:18.1207%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.10469%,1:25.89531%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43242%,1:17.56758%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8793%,1:18.1207%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59062%,1:38.40938%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-0:[0:99.99297%,1:0.00703%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00391%,1:49.99609%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62734%,1:17.37266%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.10508%,1:25.89492%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96367%,1:21.03633%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4332%,1:17.5668%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88008%,1:18.11992%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255994, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 23491,  23493,  23497, ..., 255995, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [146845. 109155.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7451 - tp: 112918.0000 - fp: 79082.0000 - tn: 688918.0000 - fn: 79082.0000 - accuracy: 0.8352 - precision: 0.5881 - recall: 0.5881 - auc: 0.8973 - val_loss: 0.7904 - val_tp: 33927.0000 - val_fp: 30073.0000 - val_tn: 225927.0000 - val_fn: 30073.0000 - val_accuracy: 0.8120 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.8825
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-256000-512000
[INFO] processing batch 512000-768000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.95469%,0.8139250565:20.98125%,0.8029830673999999:18.17227%,0.8149336757:17.52461%,0.8137722355:17.36484%,0.8030136315999999:0.00039%,0.9621003729000001:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:78.25859%,Single Stage Single Point:21.74141%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04453%,1:25.95547%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47461%,1:17.52539%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.65391%,1:38.34609%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.01875%,1:20.98125%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68047%,1:43.31953%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.475%,1:17.525%]
[INFO] ** dst-192.168.1.40:[0:81.82734%,1:18.17266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04453%,1:25.95547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47461%,1:17.52539%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65391%,1:38.34609%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63516%,1:17.36484%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04609%,1:25.95391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01875%,1:20.98125%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47578%,1:17.52422%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82773%,1:18.17227%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255994, 255995, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      6, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [200342.  55658.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6257 - tp: 138284.0000 - fp: 53716.0000 - tn: 714284.0000 - fn: 53716.0000 - accuracy: 0.8881 - precision: 0.7202 - recall: 0.7202 - auc: 0.9301 - val_loss: 0.4101 - val_tp: 62058.0000 - val_fp: 1942.0000 - val_tn: 254058.0000 - val_fn: 1942.0000 - val_accuracy: 0.9879 - val_precision: 0.9697 - val_recall: 0.9697 - val_auc: 0.9924
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-512000-768000
[INFO] processing batch 768000-1024000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:698 (0.27266%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.0043%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:63824 (24.93125%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.0208806885:0.00117%,0.0:0.00117%,0.0012540954:0.00078%,0.0348324999:0.00039%,0.0021633145999999997:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.96758%,0.8139250565:21.09844%,0.8029830673999999:18.08594%,0.8149336757:17.48789%,0.8137722355:17.35352%,0.0:0.00117%,0.7788831836:0.00078%,0.0020936488:0.00039%,0.814841983:0.00039%,0.8030441959000001:0.00039%,0.8147502904:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.792988569:0.00039%,0.8411730545999999:0.00039%,0.15240846019999998:0.00039%,0.0339568433:0.00039%,0.315972859:0.00039%,0.0021089309:0.00039%]
[INFO] ** classification:[normal:67.51602%,Single Stage Single Point:32.48398%]
[INFO] ** orig-192.168.1.48:[1:99.99961%,0:0.00039%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.51133%,1:17.48867%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91328%,1:18.08672%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.54805%,1:38.45195%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.90117%,1:21.09883%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67852%,1:43.32148%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.51211%,1:17.48789%]
[INFO] ** dst-192.168.1.40:[0:81.91367%,1:18.08633%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51133%,1:17.48867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91328%,1:18.08672%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54805%,1:38.45195%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.9957%,1:0.0043%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64687%,1:17.35312%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03242%,1:25.96758%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90156%,1:21.09844%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5125%,1:17.4875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91406%,1:18.08594%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-239.192.4.191': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      4, ..., 255995, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      7, ..., 255994, 255996, 255997]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [172841.  83159.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7177 - tp: 117250.0000 - fp: 74750.0000 - tn: 693250.0000 - fn: 74750.0000 - accuracy: 0.8443 - precision: 0.6107 - recall: 0.6107 - auc: 0.9022 - val_loss: 0.5068 - val_tp: 55591.0000 - val_fp: 8409.0000 - val_tn: 247591.0000 - val_fn: 8409.0000 - val_accuracy: 0.9474 - val_precision: 0.8686 - val_recall: 0.8686 - val_auc: 0.9672
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-768000-1024000
[INFO] processing batch 1024000-1280000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.9875%,0.0:0.0125%]
[INFO] ** modbus_transaction_id:53455 (20.88086%)
[INFO] ** service:[0.7025755984000001:99.9875%,0.08394601119999999:0.00234%,0.0021633145999999997:0.00195%,0.0:0.00195%,0.002116286:0.00156%,0.0021476384:0.00156%,0.0297847659:0.00078%,0.0208806885:0.00078%,0.08391465880000001:0.00078%,0.08543524949999999:0.00039%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.9625%,0.8139250565:21.11836%,0.8029830673999999:18.14102%,0.8149336757:17.43203%,0.8137722355:17.33203%,0.0021089309:0.00195%,0.0:0.00195%,0.0020936488:0.00156%,0.8343113882:0.00078%,0.0818051226:0.00078%,0.8166299895999999:0.00078%,0.9765266826000001:0.00039%,0.9399107525:0.00039%,0.814841983:0.00039%,0.9834647595:0.00039%,0.8643407299:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8668928418999999:0.00039%,0.7593068036:0.00039%,0.9344397579000001:0.00039%,0.0290360046:0.00039%,0.8738156367000001:0.00039%,0.15243902439999998:0.00039%,0.9621003729000001:0.00039%,0.9715599976:0.00039%]
[INFO] ** classification:[normal:77.33086%,Single Stage Single Point:22.66914%]
[INFO] ** orig-192.168.1.48:[1:99.99805%,0:0.00195%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99805%,1:0.00195%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.10:[0:74.03672%,1:25.96328%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.56758%,1:17.43242%]
[INFO] ** src-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85859%,1:18.14141%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** src-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:78.88164%,1:21.11836%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70508%,1:43.29492%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99648%,1:0.00352%]
[INFO] ** dst-192.168.1.30:[0:82.56797%,1:17.43203%]
[INFO] ** dst-192.168.1.40:[0:81.85898%,1:18.14102%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99766%,1:0.00234%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99062%,0:0.00938%]
[INFO] ** proto-udp:[0:99.99258%,1:0.00742%]
[INFO] ** appi_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9875%,0:0.0125%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99648%,1:0.00352%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03672%,1:25.96328%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56758%,1:17.43242%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85859%,1:18.14141%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-0:[0:99.9875%,1:0.0125%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00703%,1:49.99297%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98477%,1:0.01523%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66836%,1:17.33164%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03789%,1:25.96211%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.88203%,1:21.11797%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56797%,1:17.43203%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85898%,1:18.14102%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-10.15.51.65': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-10.15.51.65': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      5, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      4, ..., 123216, 123217, 123220]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [197967.  58033.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6441 - tp: 133967.0000 - fp: 58033.0000 - tn: 709967.0000 - fn: 58033.0000 - accuracy: 0.8791 - precision: 0.6977 - recall: 0.6977 - auc: 0.9244 - val_loss: 0.4007 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-1024000-1280000
[INFO] processing batch 1280000-1536000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:61506 (24.02578%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.08394601119999999:0.00117%,0.0:0.00078%,0.0021789908:0.00039%,0.0021633145999999997:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.96719%,0.8139250565:21.03398%,0.8029830673999999:18.2%,0.8149336757:17.47969%,0.8137722355:17.31445%,0.8166299895999999:0.00078%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8685433095:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.0020936488:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79961%,1:18.20039%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.65156%,1:38.34844%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96602%,1:21.03398%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.20:[0:56.71836%,1:43.28164%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.51992%,1:17.48008%]
[INFO] ** dst-192.168.1.40:[0:81.79961%,1:18.20039%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99883%,1:0.00117%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79961%,1:18.20039%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65156%,1:38.34844%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68555%,1:17.31445%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0332%,1:25.9668%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96602%,1:21.03398%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5207%,1:17.4793%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80039%,1:18.19961%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3726 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.3381 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-1280000-1536000
[INFO] processing batch 1536000-1792000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65533 (25.59883%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99258%,0.8139250565:21.06133%,0.8029830673999999:18.11328%,0.8149336757:17.46836%,0.8137722355:17.36289%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:99.99961%,Single Stage Single Point:0.00039%]
[INFO] ** orig-192.168.1.48:[1:99.99961%,0:0.00039%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00742%,1:25.99258%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53125%,1:17.46875%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88633%,1:18.11367%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.57578%,1:38.42422%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.93867%,1:21.06133%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64453%,1:43.35547%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53164%,1:17.46836%]
[INFO] ** dst-192.168.1.40:[0:81.88672%,1:18.11328%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00742%,1:25.99258%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53125%,1:17.46875%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88633%,1:18.11367%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.57578%,1:38.42422%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63711%,1:17.36289%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00781%,1:25.99219%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93867%,1:21.06133%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53203%,1:17.46797%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88672%,1:18.11328%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [255999.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([103785]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55999e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3110 - tp: 191999.0000 - fp: 1.0000 - tn: 767999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2860 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-1536000-1792000
[INFO] processing batch 1792000-2048000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:707 (0.27617%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.0:0.00391%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.13906%,0.8139250565:20.75586%,0.8029830673999999:18.23828%,0.8149336757:17.6168%,0.8137722355:17.2418%,0.0:0.00391%,0.8343113882:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:80.53203%,Single Stage Single Point:19.46797%]
[INFO] ** orig-192.168.1.48:[1:99.99688%,0:0.00312%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** i/f_name-eth1:[1:99.99609%,0:0.00391%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99688%,1:0.00312%]
[INFO] ** i/f_dir-outbound:[1:99.99688%,0:0.00312%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85938%,1:26.14062%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38203%,1:17.61797%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76133%,1:18.23867%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:62.00234%,1:37.99766%]
[INFO] ** src-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** dst-0:[0:99.99609%,1:0.00391%]
[INFO] ** dst-192.168.1.10:[0:79.24375%,1:20.75625%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61875%,1:43.38125%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38281%,1:17.61719%]
[INFO] ** dst-192.168.1.40:[0:81.76094%,1:18.23906%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99609%,1:0.00391%]
[INFO] ** proto-tcp:[1:99.99609%,0:0.00391%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99609%,1:0.00391%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85938%,1:26.14062%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38203%,1:17.61797%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76133%,1:18.23867%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.00234%,1:37.99766%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75859%,1:17.24141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86094%,1:26.13906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.24453%,1:20.75547%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.3832%,1:17.6168%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76211%,1:18.23789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255995, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 74088,  74092,  74093, ..., 255994, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [206162.  49838.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.5635 - tp: 148221.0000 - fp: 43779.0000 - tn: 724221.0000 - fn: 43779.0000 - accuracy: 0.9088 - precision: 0.7720 - recall: 0.7720 - auc: 0.9430 - val_loss: 0.3959 - val_tp: 57941.0000 - val_fp: 6059.0000 - val_tn: 249941.0000 - val_fn: 6059.0000 - val_accuracy: 0.9621 - val_precision: 0.9053 - val_recall: 0.9053 - val_auc: 0.9763
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-1792000-2048000
[INFO] processing batch 2048000-2304000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:704 (0.275%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.0012540954:0.00039%]
[INFO] ** s_port:[0.834280824:26.12969%,0.8139250565:20.76406%,0.8029830673999999:18.24258%,0.8149336757:17.61289%,0.8137722355:17.24648%,0.0:0.00273%,0.8030136315999999:0.00039%,0.8431597286:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:80.35703%,Single Stage Single Point:19.64297%]
[INFO] ** orig-192.168.1.48:[1:99.99766%,0:0.00234%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99766%,1:0.00234%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86992%,1:26.13008%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38672%,1:17.61328%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.75703%,1:18.24297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.98945%,1:38.01055%]
[INFO] ** src-192.168.1.88:[0:99.99766%,1:0.00234%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.23594%,1:20.76406%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.62383%,1:43.37617%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38711%,1:17.61289%]
[INFO] ** dst-192.168.1.40:[0:81.75742%,1:18.24258%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86992%,1:26.13008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38672%,1:17.61328%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75703%,1:18.24297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98945%,1:38.01055%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75352%,1:17.24648%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.87109%,1:26.12891%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.23594%,1:20.76406%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38711%,1:17.61289%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75742%,1:18.24258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Google Chrome': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      7, ..., 140271, 140272, 140276]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [205714.  50286.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6054 - tp: 141714.0000 - fp: 50286.0000 - tn: 717714.0000 - fn: 50286.0000 - accuracy: 0.8952 - precision: 0.7381 - recall: 0.7381 - auc: 0.9346 - val_loss: 0.2810 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-2048000-2304000
[INFO] processing batch 2304000-2560000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0348324999:0.00039%,0.0021633145999999997:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.11992%,0.8139250565:20.79062%,0.8029830673999999:18.25898%,0.8149336757:17.61406%,0.8137722355:17.21367%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0339568433:0.00039%,0.0818051226:0.00039%,0.0021089309:0.00039%,0.2528119078:0.00039%,0.1074484993:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88008%,1:26.11992%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.38594%,1:17.61406%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.74023%,1:18.25977%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.9957%,1:38.0043%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.20859%,1:20.79141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66641%,1:43.33359%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.38594%,1:17.61406%]
[INFO] ** dst-192.168.1.40:[0:81.74102%,1:18.25898%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88008%,1:26.11992%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38594%,1:17.61406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74023%,1:18.25977%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.9957%,1:38.0043%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78633%,1:17.21367%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88008%,1:26.11992%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20977%,1:20.79023%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38633%,1:17.61367%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74102%,1:18.25898%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-239.192.4.191': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2685 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2513 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-2304000-2560000
[INFO] processing batch 2560000-2816000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65413 (25.55195%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.18945%,0.8139250565:20.77422%,0.8029830673999999:18.24023%,0.8149336757:17.56523%,0.8137722355:17.22891%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.80977%,1:26.19023%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43438%,1:17.56562%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.75938%,1:18.24062%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.99688%,1:38.00312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.22578%,1:20.77422%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.58125%,1:43.41875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.43438%,1:17.56562%]
[INFO] ** dst-192.168.1.40:[0:81.75938%,1:18.24062%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.80977%,1:26.19023%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43438%,1:17.56562%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75938%,1:18.24062%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.99688%,1:38.00312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.77109%,1:17.22891%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.81055%,1:26.18945%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22617%,1:20.77383%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43516%,1:17.56484%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75977%,1:18.24023%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2362 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2216 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-2560000-2816000
[INFO] processing batch 2816000-3072000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.98984%,0.0:0.01016%]
[INFO] ** modbus_transaction_id:64676 (25.26406%)
[INFO] ** service:[0.7025755984000001:99.98984%,0.0:0.00742%,0.0297847659:0.00078%,0.08394601119999999:0.00078%,0.0021476384:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.15078%,0.8139250565:20.64023%,0.8029830673999999:18.33633%,0.8149336757:17.66367%,0.8137722355:17.19766%,0.0:0.00742%,0.0020936488:0.00078%,0.9715599976:0.00039%,0.8059172320999999:0.00039%,0.980989058:0.00039%,0.0818051226:0.00039%,0.8738156367000001:0.00039%,0.0290360046:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:74.09414%,Single Stage Single Point:25.90586%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99258%,1:0.00742%]
[INFO] ** i/f_name-eth1:[1:99.99258%,0:0.00742%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99297%,1:0.00703%]
[INFO] ** i/f_dir-outbound:[1:99.99297%,0:0.00703%]
[INFO] ** src-0:[0:99.99258%,1:0.00742%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.84883%,1:26.15117%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.33594%,1:17.66406%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.66367%,1:18.33633%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:62.16211%,1:37.83789%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99258%,1:0.00742%]
[INFO] ** dst-192.168.1.10:[0:79.35977%,1:20.64023%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65156%,1:43.34844%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.33633%,1:17.66367%]
[INFO] ** dst-192.168.1.40:[0:81.66328%,1:18.33672%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99258%,1:0.00742%]
[INFO] ** proto-tcp:[1:99.98984%,0:0.01016%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:99.99258%,1:0.00742%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98984%,0:0.01016%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99258%,1:0.00742%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.84883%,1:26.15117%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.33594%,1:17.66406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.66367%,1:18.33633%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.16211%,1:37.83789%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.98984%,1:0.01016%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9875%,1:0.0125%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.80273%,1:17.19727%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.84961%,1:26.15039%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.35977%,1:20.64023%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.33633%,1:17.66367%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.66406%,1:18.33594%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255995, 255996, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [189681.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 71814,  71815,  71818, ..., 255993, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [189681.  66319.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 12s - loss: 0.5638 - tp: 148720.0000 - fp: 43280.0000 - tn: 724720.0000 - fn: 43280.0000 - accuracy: 0.9098 - precision: 0.7746 - recall: 0.7746 - auc: 0.9436 - val_loss: 0.7677 - val_tp: 40961.0000 - val_fp: 23039.0000 - val_tn: 232961.0000 - val_fn: 23039.0000 - val_accuracy: 0.8560 - val_precision: 0.6400 - val_recall: 0.6400 - val_auc: 0.9100
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-2816000-3072000
[INFO] processing batch 3072000-3328000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:54629 (21.33945%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00156%,0.0021633145999999997:0.00078%,0.0021476384:0.00078%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.14023%,0.8139250565:20.83086%,0.8029830673999999:18.17813%,0.8149336757:17.62773%,0.8137722355:17.21641%,0.0:0.00156%,0.8030136315999999:0.00078%,0.0021089309:0.00078%,0.0020936488:0.00078%,0.8343113882:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:76.36523%,Single Stage Single Point:23.63477%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8582%,1:26.1418%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.37188%,1:17.62812%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82109%,1:18.17891%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.95273%,1:38.04727%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:79.16914%,1:20.83086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64336%,1:43.35664%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.37188%,1:17.62812%]
[INFO] ** dst-192.168.1.40:[0:81.82148%,1:18.17852%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8582%,1:26.1418%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.37188%,1:17.62812%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82109%,1:18.17891%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.95273%,1:38.04727%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78359%,1:17.21641%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86016%,1:26.13984%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16914%,1:20.83086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.37266%,1:17.62734%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82188%,1:18.17813%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      6,      8, ..., 168921, 168922, 168923]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [195495.  60505.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.6949 - tp: 131495.0000 - fp: 60505.0000 - tn: 707495.0000 - fn: 60505.0000 - accuracy: 0.8739 - precision: 0.6849 - recall: 0.6849 - auc: 0.9209 - val_loss: 0.2357 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-3072000-3328000
[INFO] processing batch 3328000-3584000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:48170 (18.81641%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.08391465880000001:0.00078%,0.0:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.125%,0.8139250565:20.73086%,0.8029830673999999:18.2793%,0.8149336757:17.60469%,0.8137722355:17.25391%,0.0:0.00078%,0.0818051226:0.00078%,0.0020936488:0.00039%,0.814841983:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.0021089309:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.87461%,1:26.12539%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.39492%,1:17.60508%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.72031%,1:18.27969%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:62.01523%,1:37.98477%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.26914%,1:20.73086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6207%,1:43.3793%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.39531%,1:17.60469%]
[INFO] ** dst-192.168.1.40:[0:81.7207%,1:18.2793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.87461%,1:26.12539%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.39492%,1:17.60508%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72031%,1:18.27969%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.01523%,1:37.98477%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74609%,1:17.25391%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.87539%,1:26.12461%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.26914%,1:20.73086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.39531%,1:17.60469%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7207%,1:18.2793%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 8, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2287 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2167 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-3328000-3584000
[INFO] processing batch 3584000-3840000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00273%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00117%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.11992%,0.8139250565:20.84648%,0.8029830673999999:18.15625%,0.8149336757:17.56992%,0.8137722355:17.30234%,0.6452258696000001:0.00156%,0.0:0.00117%,0.8059172320999999:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.87969%,1:26.12031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42969%,1:17.57031%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.84336%,1:18.15664%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85117%,1:38.14883%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.15352%,1:20.84648%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.57773%,1:43.42227%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43008%,1:17.56992%]
[INFO] ** dst-192.168.1.40:[0:81.84219%,1:18.15781%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.87969%,1:26.12031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42969%,1:17.57031%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84336%,1:18.15664%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85117%,1:38.14883%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69766%,1:17.30234%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88086%,1:26.11914%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15352%,1:20.84648%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43047%,1:17.56953%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84375%,1:18.15625%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 3, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2054 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1944 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-3584000-3840000
[INFO] processing batch 3840000-4096000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.17852%,0.8139250565:20.77656%,0.8029830673999999:18.23789%,0.8149336757:17.56172%,0.8137722355:17.24063%,0.0:0.00117%,0.8711259856999999:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:81.93477%,Single Stage Single Point:18.06523%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8207%,1:26.1793%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76211%,1:18.23789%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.98281%,1:38.01719%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.22344%,1:20.77656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.58086%,1:43.41914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43789%,1:17.56211%]
[INFO] ** dst-192.168.1.40:[0:81.76133%,1:18.23867%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8207%,1:26.1793%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76211%,1:18.23789%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98281%,1:38.01719%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75977%,1:17.24023%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.82148%,1:26.17852%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22383%,1:20.77617%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43828%,1:17.56172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76211%,1:18.23789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([  2401,   2407,   2413, ..., 255980, 255989, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [209753.  46247.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.4929 - tp: 157534.0000 - fp: 34466.0000 - tn: 733534.0000 - fn: 34466.0000 - accuracy: 0.9282 - precision: 0.8205 - recall: 0.8205 - auc: 0.9551 - val_loss: 0.5004 - val_tp: 52219.0000 - val_fp: 11781.0000 - val_tn: 244219.0000 - val_fn: 11781.0000 - val_accuracy: 0.9264 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.9540
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-3840000-4096000
[INFO] processing batch 4096000-4352000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:58132 (22.70781%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08391465880000001:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.11641%,0.8139250565:20.75781%,0.8029830673999999:18.28242%,0.8149336757:17.6%,0.8137722355:17.24141%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:99.29219%,Single Stage Single Point:0.70781%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8832%,1:26.1168%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.39961%,1:17.60039%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:62.00078%,1:37.99922%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.24219%,1:20.75781%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6418%,1:43.3582%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4%,1:17.6%]
[INFO] ** dst-192.168.1.40:[0:81.71758%,1:18.28242%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8832%,1:26.1168%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.39961%,1:17.60039%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.00078%,1:37.99922%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75859%,1:17.24141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88438%,1:26.11562%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.24219%,1:20.75781%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.40039%,1:17.59961%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71758%,1:18.28242%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([   4,    7,   13, ..., 9894, 9903, 9905]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [254188.   1812.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2022 - tp: 190188.0000 - fp: 1812.0000 - tn: 766188.0000 - fn: 1812.0000 - accuracy: 0.9962 - precision: 0.9906 - recall: 0.9906 - auc: 0.9979 - val_loss: 0.1780 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-4096000-4352000
[INFO] processing batch 4352000-4608000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:702 (0.27422%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00469%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:64698 (25.27266%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00234%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.14844%,0.8139250565:20.81289%,0.8029830673999999:18.23438%,0.8149336757:17.55586%,0.8137722355:17.24141%,0.0:0.00234%,0.6970474968000001:0.00156%,0.8166299895999999:0.00078%,0.8343113882:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_dir-outbound:[1:99.99766%,0:0.00234%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.44375%,1:17.55625%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76523%,1:18.23477%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.9457%,1:38.0543%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:79.18711%,1:20.81289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61016%,1:43.38984%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.44219%,1:17.55781%]
[INFO] ** dst-192.168.1.40:[0:81.76562%,1:18.23438%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44375%,1:17.55625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76523%,1:18.23477%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.9457%,1:38.0543%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99219%,1:0.00781%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75898%,1:17.24102%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85195%,1:26.14805%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.18711%,1:20.81289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44414%,1:17.55586%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76562%,1:18.23438%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 4, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1702 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1623 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-4352000-4608000
[INFO] processing batch 4608000-4864000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99609%,0.0:0.00391%]
[INFO] ** modbus_transaction_id:54680 (21.35938%)
[INFO] ** service:[0.7025755984000001:99.99609%,0.0:0.00234%,0.0021789908:0.00078%,0.08391465880000001:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.11484%,0.8139250565:20.79258%,0.8029830673999999:18.24414%,0.8149336757:17.55781%,0.8137722355:17.28555%,0.0:0.00234%,0.8831377224:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:88.0668%,Single Stage Single Point:11.9332%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4418%,1:17.5582%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.75547%,1:18.24453%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.92188%,1:38.07812%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:79.20742%,1:20.79258%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.59961%,1:43.40039%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44219%,1:17.55781%]
[INFO] ** dst-192.168.1.40:[0:81.75547%,1:18.24453%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99609%,0:0.00391%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4418%,1:17.5582%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75547%,1:18.24453%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.92188%,1:38.07812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99609%,1:0.00391%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71445%,1:17.28555%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88555%,1:26.11445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20742%,1:20.79258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44219%,1:17.55781%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75586%,1:18.24414%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 71810,  71813,  71819, ..., 157065, 157071, 157072]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225451.  30549.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.4593 - tp: 161451.0000 - fp: 30549.0000 - tn: 737451.0000 - fn: 30549.0000 - accuracy: 0.9364 - precision: 0.8409 - recall: 0.8409 - auc: 0.9605 - val_loss: 0.1612 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-4608000-4864000
[INFO] processing batch 4864000-5120000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:57519 (22.46836%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.1043%,0.8139250565:20.84141%,0.8029830673999999:18.19336%,0.8149336757:17.55039%,0.8137722355:17.30859%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89492%,1:26.10508%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44961%,1:17.55039%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80586%,1:18.19414%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85%,1:38.15%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.15859%,1:20.84141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.58672%,1:43.41328%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44922%,1:17.55078%]
[INFO] ** dst-192.168.1.40:[0:81.80625%,1:18.19375%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89492%,1:26.10508%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44961%,1:17.55039%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80586%,1:18.19414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85%,1:38.15%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69141%,1:17.30859%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89609%,1:26.10391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15898%,1:20.84102%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.45039%,1:17.54961%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80664%,1:18.19336%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1566 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1503 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-4864000-5120000
[INFO] processing batch 5120000-5376000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:62100 (24.25781%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.0957%,0.8139250565:20.8875%,0.8029830673999999:18.22148%,0.8149336757:17.5375%,0.8137722355:17.25469%,0.8059172320999999:0.00117%,0.814841983:0.00117%,0.8343113882:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90391%,1:26.09609%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.46133%,1:17.53867%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77852%,1:18.22148%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85781%,1:38.14219%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.1125%,1:20.8875%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64961%,1:43.35039%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4625%,1:17.5375%]
[INFO] ** dst-192.168.1.40:[0:81.77852%,1:18.22148%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90391%,1:26.09609%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.46133%,1:17.53867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77852%,1:18.22148%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85781%,1:38.14219%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7457%,1:17.2543%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90469%,1:26.09531%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.1125%,1:20.8875%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4625%,1:17.5375%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77891%,1:18.22109%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1444 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1385 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-5120000-5376000
[INFO] processing batch 5376000-5632000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.16484%,0.8139250565:20.91719%,0.8029830673999999:18.13555%,0.8149336757:17.49727%,0.8137722355:17.28086%,0.0:0.00117%,0.8166299895999999:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.83437%,1:26.16562%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.50195%,1:17.49805%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86406%,1:18.13594%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.80195%,1:38.19805%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.08281%,1:20.91719%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.5543%,1:43.4457%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.50234%,1:17.49766%]
[INFO] ** dst-192.168.1.40:[0:81.86367%,1:18.13633%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.83437%,1:26.16562%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50195%,1:17.49805%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86406%,1:18.13594%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.80195%,1:38.19805%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71914%,1:17.28086%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.83555%,1:26.16445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.08281%,1:20.91719%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50273%,1:17.49727%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86445%,1:18.13555%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1334 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1283 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-5376000-5632000
[INFO] processing batch 5632000-5888000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:704 (0.275%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.13164%,0.8139250565:20.83203%,0.8029830673999999:18.21758%,0.8149336757:17.55508%,0.8137722355:17.25898%,0.0:0.00273%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:85.86289%,Single Stage Single Point:14.13711%]
[INFO] ** orig-192.168.1.48:[1:99.99727%,0:0.00273%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86797%,1:26.13203%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44492%,1:17.55508%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.78164%,1:18.21836%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90898%,1:38.09102%]
[INFO] ** src-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.16797%,1:20.83203%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.60898%,1:43.39102%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44492%,1:17.55508%]
[INFO] ** dst-192.168.1.40:[0:81.78242%,1:18.21758%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86797%,1:26.13203%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44492%,1:17.55508%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.78164%,1:18.21836%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90898%,1:38.09102%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74102%,1:17.25898%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86875%,1:26.13125%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16797%,1:20.83203%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4457%,1:17.5543%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.78242%,1:18.21758%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 58699,  58701,  58705, ..., 159872, 159875, 159879]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [219809.  36191.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.5291 - tp: 155809.0000 - fp: 36191.0000 - tn: 731809.0000 - fn: 36191.0000 - accuracy: 0.9246 - precision: 0.8115 - recall: 0.8115 - auc: 0.9531 - val_loss: 0.1314 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-5632000-5888000
[INFO] processing batch 5888000-6144000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99414%,0.0:0.00547%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:63474 (24.79453%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.08391465880000001:0.00117%,0.0021633145999999997:0.00078%,0.0021476384:0.00078%,0.0:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.09609%,0.8139250565:20.79141%,0.8029830673999999:18.28281%,0.8149336757:17.57773%,0.8137722355:17.2457%,0.705452656:0.00156%,0.0818051226:0.00117%,0.0021089309:0.00078%,0.0020936488:0.00078%,0.0:0.00078%,0.8345253376999999:0.00039%,0.0290360046:0.00039%,0.9842747112000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90352%,1:26.09648%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42227%,1:17.57773%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96289%,1:38.03711%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.20859%,1:20.79141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6582%,1:43.3418%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.42031%,1:17.57969%]
[INFO] ** dst-192.168.1.40:[0:81.71719%,1:18.28281%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99883%,1:0.00117%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.9957%,0:0.0043%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99414%,0:0.00586%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90352%,1:26.09648%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42227%,1:17.57773%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96289%,1:38.03711%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7543%,1:17.2457%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9043%,1:26.0957%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20859%,1:20.79141%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42227%,1:17.57773%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71719%,1:18.28281%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1290 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1247 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-5888000-6144000
[INFO] processing batch 6144000-6400000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.09102%,0.8139250565:20.84219%,0.8029830673999999:18.28203%,0.8149336757:17.53047%,0.8137722355:17.25%,0.8059172320999999:0.00117%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8876612262000001:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:84.0875%,Single Stage Single Point:15.9125%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9082%,1:26.0918%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.46875%,1:17.53125%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90781%,1:38.09219%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.15781%,1:20.84219%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65859%,1:43.34141%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.46953%,1:17.53047%]
[INFO] ** dst-192.168.1.40:[0:81.71758%,1:18.28242%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9082%,1:26.0918%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.46875%,1:17.53125%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90781%,1:38.09219%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75039%,1:17.24961%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90938%,1:26.09062%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15781%,1:20.84219%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.46953%,1:17.53047%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71797%,1:18.28203%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([142218, 142219, 142225, ..., 255993, 255994, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215264.  40736.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.3250 - tp: 174156.0000 - fp: 17844.0000 - tn: 750156.0000 - fn: 17844.0000 - accuracy: 0.9628 - precision: 0.9071 - recall: 0.9071 - auc: 0.9757 - val_loss: 0.9030 - val_tp: 41108.0000 - val_fp: 22892.0000 - val_tn: 233108.0000 - val_fn: 22892.0000 - val_accuracy: 0.8569 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-6144000-6400000
[INFO] processing batch 6400000-6656000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.14219%,0.8139250565:20.80625%,0.8029830673999999:18.25117%,0.8149336757:17.57578%,0.8137722355:17.22266%,0.8166299895999999:0.00078%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:79.20547%,Single Stage Single Point:20.79453%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85781%,1:26.14219%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.42383%,1:17.57617%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74883%,1:18.25117%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97109%,1:38.02891%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.19375%,1:20.80625%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63516%,1:43.36484%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.42422%,1:17.57578%]
[INFO] ** dst-192.168.1.40:[0:81.74844%,1:18.25156%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85781%,1:26.14219%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42383%,1:17.57617%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74883%,1:18.25117%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97109%,1:38.02891%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.77734%,1:17.22266%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85781%,1:26.14219%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19414%,1:20.80586%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.425%,1:17.575%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74922%,1:18.25078%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      7, ..., 148577, 148583, 148584]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [202766.  53234.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.7201 - tp: 138766.0000 - fp: 53234.0000 - tn: 714766.0000 - fn: 53234.0000 - accuracy: 0.8891 - precision: 0.7227 - recall: 0.7227 - auc: 0.9308 - val_loss: 0.1327 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-6400000-6656000
[INFO] processing batch 6656000-6912000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65197 (25.46758%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.11367%,0.8139250565:20.77734%,0.8029830673999999:18.2707%,0.8149336757:17.58906%,0.8137722355:17.24609%,0.8030136315999999:0.00078%,0.8343113882:0.00078%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.72812%,1:18.27188%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97656%,1:38.02344%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.22266%,1:20.77734%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63984%,1:43.36016%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.41055%,1:17.58945%]
[INFO] ** dst-192.168.1.40:[0:81.7293%,1:18.2707%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72812%,1:18.27188%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97656%,1:38.02344%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75391%,1:17.24609%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88711%,1:26.11289%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22266%,1:20.77734%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41094%,1:17.58906%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7293%,1:18.2707%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1314 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1272 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-6656000-6912000
[INFO] processing batch 6912000-7168000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:59892 (23.39531%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.1043%,0.8139250565:20.79102%,0.8029830673999999:18.27422%,0.8149336757:17.5875%,0.8137722355:17.23945%,0.8059172320999999:0.00078%,0.8343113882:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8344030809:0.00039%]
[INFO] ** classification:[normal:99.99883%,Single Stage Single Point:0.00117%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89453%,1:26.10547%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4125%,1:17.5875%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.72539%,1:18.27461%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96953%,1:38.03047%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.20898%,1:20.79102%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65625%,1:43.34375%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4125%,1:17.5875%]
[INFO] ** dst-192.168.1.40:[0:81.72539%,1:18.27461%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89453%,1:26.10547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4125%,1:17.5875%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72539%,1:18.27461%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96953%,1:38.03047%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.76094%,1:17.23906%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89609%,1:26.10391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20898%,1:20.79102%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41328%,1:17.58672%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.72578%,1:18.27422%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [255997.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([ 90086, 134127, 239267]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [2.55997e+05 3.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1227 - tp: 191998.0000 - fp: 2.0000 - tn: 767998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1182 - val_tp: 63999.0000 - val_fp: 1.0000 - val_tn: 255999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-6912000-7168000
[INFO] processing batch 7168000-7424000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:706 (0.27578%)
[INFO] ** modbus_function_code:[0.9743589744:99.99453%,0.0:0.00547%]
[INFO] ** modbus_transaction_id:64992 (25.3875%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0:0.0043%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.03359%,0.8139250565:20.78242%,0.8029830673999999:18.34414%,0.8149336757:17.58828%,0.8137722355:17.24375%,0.0:0.0043%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.9344397579000001:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:92.32148%,Single Stage Multi Point:7.67812%,Single Stage Single Point:0.00039%]
[INFO] ** orig-192.168.1.48:[1:99.9957%,0:0.0043%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.9957%,1:0.0043%]
[INFO] ** i/f_name-eth1:[1:99.9957%,0:0.0043%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.9957%,1:0.0043%]
[INFO] ** i/f_dir-outbound:[1:99.9957%,0:0.0043%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.96562%,1:26.03437%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.65586%,1:18.34414%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97383%,1:38.02617%]
[INFO] ** src-192.168.1.88:[0:99.99492%,1:0.00508%]
[INFO] ** dst-0:[0:99.9957%,1:0.0043%]
[INFO] ** dst-192.168.1.10:[0:79.21719%,1:20.78281%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.72266%,1:43.27734%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.41133%,1:17.58867%]
[INFO] ** dst-192.168.1.40:[0:81.65508%,1:18.34492%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.9957%,1:0.0043%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99453%,0:0.00547%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.9957%,1:0.0043%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.96562%,1:26.03437%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.65586%,1:18.34414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97383%,1:38.02617%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9918%,1:0.0082%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75625%,1:17.24375%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9668%,1:26.0332%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.21758%,1:20.78242%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41172%,1:17.58828%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.65586%,1:18.34414%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 3, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255993, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [236343.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([849]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([213902, 213904, 213905, ..., 255995, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 1.96560e+04 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 1.96560e+04 0.00000e+00 0.00000e+00]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
z vector sum [2.36343e+05 1.00000e+00 1.96560e+04 0.00000e+00 0.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1142 - tp: 191999.0000 - fp: 1.0000 - tn: 767999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7703 - val_tp: 44344.0000 - val_fp: 19656.0000 - val_tn: 236344.0000 - val_fn: 19656.0000 - val_accuracy: 0.8772 - val_precision: 0.6929 - val_recall: 0.6929 - val_auc: 0.7313
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-7168000-7424000
[INFO] processing batch 7424000-7680000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:706 (0.27578%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:59138 (23.10078%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00352%]
[INFO] ** s_port:[0.834280824:26.08906%,0.8139250565:20.78789%,0.8029830673999999:18.26367%,0.8149336757:17.61172%,0.8137722355:17.24219%,0.0:0.00352%,0.8059172320999999:0.00078%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:59.34414%,Single Stage Multi Point:40.65586%]
[INFO] ** orig-192.168.1.48:[1:99.99648%,0:0.00352%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** i/f_name-eth1:[1:99.99648%,0:0.00352%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99648%,1:0.00352%]
[INFO] ** i/f_dir-outbound:[1:99.99648%,0:0.00352%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.91055%,1:26.08945%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38789%,1:17.61211%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.73594%,1:18.26406%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96992%,1:38.03008%]
[INFO] ** src-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** dst-0:[0:99.99648%,1:0.00352%]
[INFO] ** dst-192.168.1.10:[0:79.21211%,1:20.78789%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66836%,1:43.33164%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38828%,1:17.61172%]
[INFO] ** dst-192.168.1.40:[0:81.73633%,1:18.26367%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99648%,1:0.00352%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99648%,1:0.00352%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.91055%,1:26.08945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38789%,1:17.61211%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.73594%,1:18.26406%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96992%,1:38.03008%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7582%,1:17.2418%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.91094%,1:26.08906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.2125%,1:20.7875%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38828%,1:17.61172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.73672%,1:18.26328%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([     1,      4,      5, ..., 222071, 222075, 222076]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0. 104079.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0. 104079.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [151921.      0. 104079.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 2.5703 - tp: 102062.0000 - fp: 89938.0000 - tn: 678062.0000 - fn: 89938.0000 - accuracy: 0.8126 - precision: 0.5316 - recall: 0.5316 - auc: 0.6273 - val_loss: 1.2367 - val_tp: 49859.0000 - val_fp: 14141.0000 - val_tn: 241859.0000 - val_fn: 14141.0000 - val_accuracy: 0.9116 - val_precision: 0.7790 - val_recall: 0.7790 - val_auc: 0.8619
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-7424000-7680000
[INFO] processing batch 7680000-7936000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:698 (0.27266%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:63218 (24.69453%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.09844%,0.8139250565:20.80234%,0.8029830673999999:18.25859%,0.8149336757:17.5832%,0.8137722355:17.25547%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90078%,1:26.09922%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41641%,1:17.58359%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74102%,1:18.25898%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.94219%,1:38.05781%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.19727%,1:20.80273%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64609%,1:43.35391%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.41641%,1:17.58359%]
[INFO] ** dst-192.168.1.40:[0:81.74141%,1:18.25859%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90078%,1:26.09922%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41641%,1:17.58359%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74102%,1:18.25898%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.94219%,1:38.05781%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74453%,1:17.25547%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90234%,1:26.09766%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19766%,1:20.80234%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41758%,1:17.58242%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74141%,1:18.25859%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1168 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1137 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-7680000-7936000
[INFO] processing batch 7936000-8192000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99414%,0.0:0.00547%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.002116286:0.00117%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.14844%,0.8139250565:20.83828%,0.8029830673999999:18.2082%,0.8149336757:17.56406%,0.8137722355:17.2332%,0.8868054282:0.00156%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.7673146279999999:0.00039%,0.8345253376999999:0.00039%,0.0290360046:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.7788831836:0.00039%,0.8870957883:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.9156580476:0.00039%,0.8881655358:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43594%,1:17.56406%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79102%,1:18.20898%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.92852%,1:38.07148%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.16172%,1:20.83828%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61797%,1:43.38203%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.43555%,1:17.56445%]
[INFO] ** dst-192.168.1.40:[0:81.78984%,1:18.21016%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99414%,0:0.00586%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43594%,1:17.56406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79102%,1:18.20898%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.92852%,1:38.07148%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99102%,1:0.00898%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7668%,1:17.2332%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85156%,1:26.14844%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16211%,1:20.83789%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43672%,1:17.56328%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7918%,1:18.2082%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1103 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1069 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-7936000-8192000
[INFO] processing batch 8192000-8448000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65522 (25.59453%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.08555%,0.8139250565:20.85859%,0.8029830673999999:18.1793%,0.8149336757:17.63516%,0.8137722355:17.23984%,0.8059172320999999:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:87.94922%,Multi Stage Multi Point:12.05078%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.91406%,1:26.08594%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.36445%,1:17.63555%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90156%,1:38.09844%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.14141%,1:20.85859%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67461%,1:43.32539%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.36484%,1:17.63516%]
[INFO] ** dst-192.168.1.40:[0:81.8207%,1:18.1793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.91406%,1:26.08594%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.36445%,1:17.63555%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90156%,1:38.09844%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.76016%,1:17.23984%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.91484%,1:26.08516%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.14141%,1:20.85859%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.36484%,1:17.63516%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82109%,1:18.17891%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([ 25682,  25685,  25695, ..., 195376, 195386, 195390]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [225150.      0.      0.      0.  30850.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9996 - tp: 161781.0000 - fp: 30219.0000 - tn: 737781.0000 - fn: 30219.0000 - accuracy: 0.9370 - precision: 0.8426 - recall: 0.8426 - auc: 0.8426 - val_loss: 0.1602 - val_tp: 63369.0000 - val_fp: 631.0000 - val_tn: 255369.0000 - val_fn: 631.0000 - val_accuracy: 0.9961 - val_precision: 0.9901 - val_recall: 0.9901 - val_auc: 0.9901
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-8192000-8448000
[INFO] processing batch 8448000-8704000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:56456 (22.05313%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.002116286:0.00117%,0.0:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.10742%,0.8139250565:20.80391%,0.8029830673999999:18.28828%,0.8149336757:17.5793%,0.8137722355:17.21602%,0.8030136315999999:0.00078%,0.0:0.00078%,0.9104621309:0.00039%,0.8591448133:0.00039%,0.8916498562999999:0.00039%,0.7788831836:0.00039%,0.7891527599:0.00039%,0.8870957883:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:63.66172%,Multi Stage Multi Point:36.33828%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89219%,1:26.10781%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42031%,1:17.57969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71094%,1:18.28906%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.98008%,1:38.01992%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.19609%,1:20.80391%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67656%,1:43.32344%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.4207%,1:17.5793%]
[INFO] ** dst-192.168.1.40:[0:81.71172%,1:18.28828%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89219%,1:26.10781%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42031%,1:17.57969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71094%,1:18.28906%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98008%,1:38.01992%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78398%,1:17.21602%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89258%,1:26.10742%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19648%,1:20.80352%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42109%,1:17.57891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71211%,1:18.28789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([ 11294,  11295,  11297, ..., 255992, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [162974.      0.      0.      0.  93026.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 2.0399 - tp: 123282.0000 - fp: 68718.0000 - tn: 699282.0000 - fn: 68718.0000 - accuracy: 0.8568 - precision: 0.6421 - recall: 0.6421 - auc: 0.6421 - val_loss: 2.1019 - val_tp: 39692.0000 - val_fp: 24308.0000 - val_tn: 231692.0000 - val_fn: 24308.0000 - val_accuracy: 0.8481 - val_precision: 0.6202 - val_recall: 0.6202 - val_auc: 0.6202
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-8448000-8704000
[INFO] processing batch 8704000-8960000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:63796 (24.92031%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.09102%,0.8139250565:20.85859%,0.8029830673999999:18.25273%,0.8149336757:17.52617%,0.8137722355:17.26953%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:98.44844%,Multi Stage Multi Point:1.55156%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90742%,1:26.09258%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47383%,1:17.52617%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74688%,1:18.25312%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.87188%,1:38.12813%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.14141%,1:20.85859%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63906%,1:43.36094%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47344%,1:17.52656%]
[INFO] ** dst-192.168.1.40:[0:81.74688%,1:18.25312%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90742%,1:26.09258%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47383%,1:17.52617%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74688%,1:18.25312%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.87188%,1:38.12813%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.73086%,1:17.26914%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90977%,1:26.09023%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.14141%,1:20.85859%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47383%,1:17.52617%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74727%,1:18.25273%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([    4,     6,     9, ..., 10386, 10388, 10391]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [252028.      0.      0.      0.   3972.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.2172 - tp: 188028.0000 - fp: 3972.0000 - tn: 764028.0000 - fn: 3972.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9793 - val_loss: 0.1071 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-8704000-8960000
[INFO] processing batch 8960000-9216000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.9957%,0.0:0.00391%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57363 (22.40742%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.07148%,0.8139250565:20.81289%,0.8029830673999999:18.23047%,0.8149336757:17.57383%,0.8137722355:17.30469%,0.7579772602:0.00156%,0.8059172320999999:0.00078%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.8262729995999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.0290360046:0.00039%,0.0020936488:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.92812%,1:26.07188%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42578%,1:17.57422%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76875%,1:18.23125%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.88242%,1:38.11758%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.18711%,1:20.81289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.62188%,1:43.37812%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.42617%,1:17.57383%]
[INFO] ** dst-192.168.1.40:[0:81.76914%,1:18.23086%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9957%,0:0.0043%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.92812%,1:26.07188%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42578%,1:17.57422%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76875%,1:18.23125%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.88242%,1:38.11758%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99609%,1:0.00391%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69531%,1:17.30469%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.92891%,1:26.07109%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.18711%,1:20.81289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42656%,1:17.57344%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76953%,1:18.23047%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 6, 'type-alert': 2, 'type-log': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1042 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1011 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-8960000-9216000
[INFO] processing batch 9216000-9472000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:61876 (24.17031%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.1332%,0.8139250565:20.83086%,0.8029830673999999:18.15234%,0.8149336757:17.59102%,0.8137722355:17.29141%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:72.04688%,Single Stage Multi Point:27.95312%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86602%,1:26.13398%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.40898%,1:17.59102%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.87773%,1:38.12227%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.16914%,1:20.83086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.57539%,1:43.42461%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.40859%,1:17.59141%]
[INFO] ** dst-192.168.1.40:[0:81.84766%,1:18.15234%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86602%,1:26.13398%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.40898%,1:17.59102%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.87773%,1:38.12227%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.70859%,1:17.29141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86719%,1:26.13281%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16953%,1:20.83047%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.40898%,1:17.59102%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84805%,1:18.15195%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([ 46464,  46465,  46466, ..., 163814, 163816, 163819]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.  71560.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.  71560.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [184440.      0.  71560.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.9499 - tp: 120440.0000 - fp: 71560.0000 - tn: 696440.0000 - fn: 71560.0000 - accuracy: 0.8509 - precision: 0.6273 - recall: 0.6273 - auc: 0.7582 - val_loss: 0.1056 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-9216000-9472000
[INFO] processing batch 9472000-9728000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00547%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.13047%,0.8139250565:20.83359%,0.8029830673999999:18.22422%,0.8149336757:17.54023%,0.8137722355:17.26289%,0.0:0.00547%,0.814841983:0.00078%,0.9715599976:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:83.99258%,Single Stage Multi Point:16.00742%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_name-eth1:[1:99.99453%,0:0.00547%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99453%,1:0.00547%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86875%,1:26.13125%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.45859%,1:17.54141%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77578%,1:18.22422%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.90352%,1:38.09648%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99453%,1:0.00547%]
[INFO] ** dst-192.168.1.10:[0:79.16641%,1:20.83359%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.60664%,1:43.39336%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.45977%,1:17.54023%]
[INFO] ** dst-192.168.1.40:[0:81.775%,1:18.225%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99453%,1:0.00547%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99453%,1:0.00547%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86875%,1:26.13125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.45859%,1:17.54141%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77578%,1:18.22422%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90352%,1:38.09648%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99023%,1:0.00977%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7375%,1:17.2625%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86992%,1:26.13008%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16641%,1:20.83359%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.46016%,1:17.53984%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77578%,1:18.22422%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([ 25270,  25279,  25287, ..., 249670, 249676, 249686]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.  40979.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.  40979.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [215021.      0.  40979.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8644 - tp: 161553.0000 - fp: 30447.0000 - tn: 737553.0000 - fn: 30447.0000 - accuracy: 0.9366 - precision: 0.8414 - recall: 0.8414 - auc: 0.8810 - val_loss: 0.8855 - val_tp: 53468.0000 - val_fp: 10532.0000 - val_tn: 245468.0000 - val_fn: 10532.0000 - val_accuracy: 0.9342 - val_precision: 0.8354 - val_recall: 0.8354 - val_auc: 0.8766
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-9472000-9728000
[INFO] processing batch 9728000-9984000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:63091 (24.64492%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.09727%,0.8139250565:20.87695%,0.8029830673999999:18.14492%,0.8149336757:17.58789%,0.8137722355:17.28906%,0.8030136315999999:0.00078%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90195%,1:26.09805%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41172%,1:17.58828%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85391%,1:18.14609%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.83398%,1:38.16602%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.12305%,1:20.87695%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61328%,1:43.38672%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.41172%,1:17.58828%]
[INFO] ** dst-192.168.1.40:[0:81.85508%,1:18.14492%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90195%,1:26.09805%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41172%,1:17.58828%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85391%,1:18.14609%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.83398%,1:38.16602%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71094%,1:17.28906%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90312%,1:26.09688%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.12344%,1:20.87656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4125%,1:17.5875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85508%,1:18.14492%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.1042 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1014 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-9728000-9984000
[INFO] processing batch 9984000-10240000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:58560 (22.875%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.002116286:0.00117%,0.0012540954:0.00039%]
[INFO] ** s_port:[0.834280824:25.95625%,0.8139250565:21.02656%,0.8029830673999999:18.18047%,0.8149336757:17.49258%,0.8137722355:17.33984%,0.8059172320999999:0.00117%,0.8030136315999999:0.00039%,0.7918882572:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8985420868999999:0.00039%,0.9339660126:0.00039%,0.7788831836:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04258%,1:25.95742%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50742%,1:17.49258%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.81914%,1:18.18086%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.63359%,1:38.36641%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97344%,1:21.02656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70391%,1:43.29609%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50703%,1:17.49297%]
[INFO] ** dst-192.168.1.40:[0:81.81914%,1:18.18086%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04258%,1:25.95742%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50742%,1:17.49258%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.81914%,1:18.18086%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63359%,1:38.36641%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04453%,1:25.95547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97344%,1:21.02656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50781%,1:17.49219%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.81953%,1:18.18047%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 12s - loss: 0.0987 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0960 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-9984000-10240000
[INFO] processing batch 10240000-10496000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0:0.00273%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.01641%,0.8139250565:20.95156%,0.8029830673999999:18.13867%,0.8149336757:17.55234%,0.8137722355:17.33281%,0.0:0.00273%,0.7414573018:0.00156%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.8935448376999999:0.00039%,0.0290360046:0.00039%,0.0020936488:0.00039%]
[INFO] ** classification:[normal:87.29883%,Multi Stage Single Point:12.70117%]
[INFO] ** orig-192.168.1.48:[1:99.99727%,0:0.00273%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.98359%,1:26.01641%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44687%,1:17.55313%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86094%,1:18.13906%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.71562%,1:38.28437%]
[INFO] ** src-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.04688%,1:20.95312%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65078%,1:43.34922%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.44766%,1:17.55234%]
[INFO] ** dst-192.168.1.40:[0:81.86133%,1:18.13867%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99453%,0:0.00547%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.98359%,1:26.01641%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44687%,1:17.55313%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86094%,1:18.13906%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.71562%,1:38.28437%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99102%,1:0.00898%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66719%,1:17.33281%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98359%,1:26.01641%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.04883%,1:20.95117%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44766%,1:17.55234%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86172%,1:18.13828%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [223485.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [223485.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [223485.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([186683, 186685, 186690, ..., 255994, 255995, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [223485.      0.      0.  32515.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [223485.      0.      0.  32515.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.1571 - tp: 189510.0000 - fp: 2490.0000 - tn: 765510.0000 - fn: 2490.0000 - accuracy: 0.9948 - precision: 0.9870 - recall: 0.9870 - auc: 0.9920 - val_loss: 2.3884 - val_tp: 33975.0000 - val_fp: 30025.0000 - val_tn: 225975.0000 - val_fn: 30025.0000 - val_accuracy: 0.8123 - val_precision: 0.5309 - val_recall: 0.5309 - val_auc: 0.7068
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-10240000-10496000
[INFO] processing batch 10496000-10752000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:705 (0.27539%)
[INFO] ** modbus_function_code:[0.9743589744:99.99219%,0.0:0.00781%]
[INFO] ** modbus_transaction_id:60618 (23.67891%)
[INFO] ** service:[0.7025755984000001:99.99219%,0.0:0.00664%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.97539%,0.8139250565:21.02148%,0.8029830673999999:18.08672%,0.8149336757:17.56211%,0.8137722355:17.34375%,0.0:0.00664%,0.9004676325:0.00078%,0.8343113882:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:53.00195%,Multi Stage Single Point:46.99805%]
[INFO] ** orig-192.168.1.48:[1:99.99492%,0:0.00508%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99766%,1:0.00234%]
[INFO] ** type-log:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_name-eth1:[1:99.99336%,0:0.00664%]
[INFO] ** i/f_name-geod daemon:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-inbound:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_dir-outbound:[1:99.99375%,0:0.00625%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02344%,1:25.97656%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.63477%,1:38.36523%]
[INFO] ** src-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** dst-0:[0:99.99336%,1:0.00664%]
[INFO] ** dst-192.168.1.10:[0:78.97852%,1:21.02148%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.68086%,1:43.31914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43789%,1:17.56211%]
[INFO] ** dst-192.168.1.40:[0:81.9125%,1:18.0875%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99336%,1:0.00664%]
[INFO] ** proto-tcp:[1:99.99297%,0:0.00703%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99336%,1:0.00664%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99219%,0:0.00781%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99336%,1:0.00664%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02344%,1:25.97656%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63477%,1:38.36523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99219%,1:0.00781%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98828%,1:0.01172%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65625%,1:17.34375%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02539%,1:25.97461%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97852%,1:21.02148%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43828%,1:17.56172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91328%,1:18.08672%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_name-geod daemon': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      4,      5, ..., 255995, 255996, 255997]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [135685.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [135685.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [135685.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     0,      1,      3, ..., 255992, 255998, 255999]),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [135685.      0.      0. 120315.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [135685.      0.      0. 120315.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 2.3250 - tp: 101670.0000 - fp: 90330.0000 - tn: 677670.0000 - fn: 90330.0000 - accuracy: 0.8118 - precision: 0.5295 - recall: 0.5295 - auc: 0.6785 - val_loss: 2.2374 - val_tp: 34015.0000 - val_fp: 29985.0000 - val_tn: 226015.0000 - val_fn: 29985.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.6486
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-10496000-10752000
[INFO] processing batch 10752000-11008000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:702 (0.27422%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00508%]
[INFO] ** modbus_transaction_id:49732 (19.42656%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0:0.00469%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.95898%,0.8139250565:21.05586%,0.8029830673999999:18.11641%,0.8149336757:17.46875%,0.8137722355:17.39375%,0.0:0.00469%,0.0818051226:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:61.98516%,Multi Stage Single Point:38.01484%]
[INFO] ** orig-192.168.1.48:[1:99.99648%,0:0.00352%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_name-eth1:[1:99.99531%,0:0.00469%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04023%,1:25.95977%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53086%,1:17.46914%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55039%,1:38.44961%]
[INFO] ** src-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** dst-0:[0:99.99531%,1:0.00469%]
[INFO] ** dst-192.168.1.10:[0:78.94414%,1:21.05586%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64727%,1:43.35273%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53086%,1:17.46914%]
[INFO] ** dst-192.168.1.40:[0:81.88359%,1:18.11641%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99531%,1:0.00469%]
[INFO] ** proto-tcp:[1:99.99492%,0:0.00508%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99531%,1:0.00469%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99531%,1:0.00469%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04023%,1:25.95977%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53086%,1:17.46914%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55039%,1:38.44961%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99492%,1:0.00508%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60625%,1:17.39375%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04102%,1:25.95898%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94453%,1:21.05547%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53164%,1:17.46836%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88398%,1:18.11602%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      5,      6, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     0,      1,      3, ..., 206898, 206899, 206901]),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.  97318.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [158682.      0.      0.  97318.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 2.1834 - tp: 101693.0000 - fp: 90307.0000 - tn: 677693.0000 - fn: 90307.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.7397 - val_loss: 0.5781 - val_tp: 56989.0000 - val_fp: 7011.0000 - val_tn: 248989.0000 - val_fn: 7011.0000 - val_accuracy: 0.9562 - val_precision: 0.8905 - val_recall: 0.8905 - val_auc: 0.9452
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-10752000-11008000
[INFO] processing batch 11008000-11264000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:46761 (18.26602%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.97266%,0.8139250565:21.02031%,0.8029830673999999:18.12383%,0.8149336757:17.52305%,0.8137722355:17.35781%,0.8059172320999999:0.00117%,0.8030136315999999:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02734%,1:25.97266%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47695%,1:17.52305%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87539%,1:18.12461%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.62188%,1:38.37813%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.97969%,1:21.02031%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66914%,1:43.33086%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47695%,1:17.52305%]
[INFO] ** dst-192.168.1.40:[0:81.87617%,1:18.12383%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02734%,1:25.97266%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47695%,1:17.52305%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87539%,1:18.12461%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.62188%,1:38.37813%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64258%,1:17.35742%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02773%,1:25.97227%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97969%,1:21.02031%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47695%,1:17.52305%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87617%,1:18.12383%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1085 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1063 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-11008000-11264000
[INFO] processing batch 11264000-11520000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:56871 (22.21523%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00078%]
[INFO] ** s_port:[0.834280824:26.01133%,0.8139250565:20.98555%,0.8029830673999999:18.14258%,0.8149336757:17.52539%,0.8137722355:17.33125%,0.8166299895999999:0.00078%,0.8147502904:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9875%,1:26.0125%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.47344%,1:17.52656%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85703%,1:18.14297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.6832%,1:38.3168%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.01406%,1:20.98594%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65742%,1:43.34258%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47422%,1:17.52578%]
[INFO] ** dst-192.168.1.40:[0:81.85625%,1:18.14375%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9875%,1:26.0125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47344%,1:17.52656%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85703%,1:18.14297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.6832%,1:38.3168%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00195%,0:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66914%,1:17.33086%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98906%,1:26.01094%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01445%,1:20.98555%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.475%,1:17.525%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85742%,1:18.14258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.1037 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1011 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-11264000-11520000
[INFO] processing batch 11520000-11776000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.98789%,0.0:0.01094%,0.9871794872:0.00039%,1.0:0.00039%,0.9615384615000001:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99023%,0.0:0.00586%,0.0021633145999999997:0.00117%,0.0297847659:0.00078%,0.08394601119999999:0.00078%,0.08391465880000001:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.95625%,0.8139250565:21.00703%,0.8029830673999999:18.13984%,0.8149336757:17.50117%,0.8137722355:17.38242%,0.0:0.00586%,0.7077908184999999:0.00156%,0.0021089309:0.00117%,0.45597224770000006:0.00078%,0.0818051226:0.00078%,0.8343113882:0.00039%,0.814841983:0.00039%,0.9034629256000001:0.00039%,0.9715599976:0.00039%,0.0020936488:0.00039%,0.0290360046:0.00039%,0.8059172320999999:0.00039%,0.9535729568000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99922%,1:0.00078%]
[INFO] ** type-control:[0:99.99883%,1:0.00117%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** i/f_name-eth1:[1:99.99414%,0:0.00586%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_dir-outbound:[1:99.99453%,0:0.00547%]
[INFO] ** src-0:[0:99.99414%,1:0.00586%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04336%,1:25.95664%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49844%,1:17.50156%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86016%,1:18.13984%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.61055%,1:38.38945%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99414%,1:0.00586%]
[INFO] ** dst-192.168.1.10:[0:78.99297%,1:21.00703%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66133%,1:43.33867%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.49648%,1:17.50352%]
[INFO] ** dst-192.168.1.40:[0:81.86016%,1:18.13984%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99414%,1:0.00586%]
[INFO] ** proto-tcp:[1:99.99023%,0:0.00977%]
[INFO] ** proto-udp:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** appi_name-CIP_func75:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98789%,0:0.01211%]
[INFO] ** appi_name-CIP_write_tag_service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99414%,1:0.00586%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04336%,1:25.95664%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49844%,1:17.50156%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86016%,1:18.13984%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.61055%,1:38.38945%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.98906%,1:0.01094%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00664%,1:49.99336%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Write Tag Service:[0:99.99961%,1:0.00039%]
[INFO] ** scada_tag-0:[0:99.98594%,1:0.01406%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61758%,1:17.38242%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04414%,1:25.95586%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.99297%,1:21.00703%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49883%,1:17.50117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86055%,1:18.13945%]
[INFO] columns with count within 2-10 {'modbus_function_code': 5, 'service': 7, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_func75': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-CIP_write_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'modbus_function_description-Unknown Function Code': 2, 'modbus_function_description-Write Tag Service': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.0988 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0964 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-11520000-11776000
[INFO] processing batch 11776000-12032000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:65188 (25.46406%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00156%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.99336%,0.8139250565:21.06289%,0.8029830673999999:18.05547%,0.8149336757:17.50742%,0.8137722355:17.37539%,0.0:0.00156%,0.8059172320999999:0.00078%,0.905082829:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:77.16641%,Multi Stage Single Point:22.83359%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00547%,1:25.99453%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49219%,1:17.50781%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.94414%,1:18.05586%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.56172%,1:38.43828%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:78.93711%,1:21.06289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.63125%,1:43.36875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49219%,1:17.50781%]
[INFO] ** dst-192.168.1.40:[0:81.94414%,1:18.05586%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00547%,1:25.99453%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49219%,1:17.50781%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.94414%,1:18.05586%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56172%,1:38.43828%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62461%,1:17.37539%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00664%,1:25.99336%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93711%,1:21.06289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49336%,1:17.50664%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.94453%,1:18.05547%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [197546.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [197546.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [197546.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([ 91957,  91958,  91961, ..., 255989, 255993, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [197546.      0.      0.  58454.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]]
z vector sum [197546.      0.      0.  58454.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8925 - tp: 156412.0000 - fp: 35588.0000 - tn: 732412.0000 - fn: 35588.0000 - accuracy: 0.9259 - precision: 0.8146 - recall: 0.8146 - auc: 0.9073 - val_loss: 1.6173 - val_tp: 41134.0000 - val_fp: 22866.0000 - val_tn: 233134.0000 - val_fn: 22866.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.8214
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-11776000-12032000
[INFO] processing batch 12032000-12288000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00508%]
[INFO] ** modbus_transaction_id:62510 (24.41797%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0208806885:0.00156%,0.0021476384:0.00117%,0.0:0.00078%,0.08394601119999999:0.00039%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.95039%,0.8139250565:21.01641%,0.8029830673999999:18.12734%,0.8149336757:17.51797%,0.8137722355:17.38125%,0.0020936488:0.00117%,0.0:0.00078%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.8147502904:0.00039%,0.8059172320999999:0.00039%,0.8876612262000001:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.8030136315999999:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:64.35391%,Multi Stage Single Point:35.64609%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04961%,1:25.95039%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.48164%,1:17.51836%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87188%,1:18.12812%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.60234%,1:38.39766%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.98359%,1:21.01641%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66797%,1:43.33203%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.48203%,1:17.51797%]
[INFO] ** dst-192.168.1.40:[0:81.87227%,1:18.12773%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04961%,1:25.95039%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48164%,1:17.51836%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87188%,1:18.12812%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.60234%,1:38.39766%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99492%,1:0.00508%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9918%,1:0.0082%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61914%,1:17.38086%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.05039%,1:25.94961%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.98398%,1:21.01602%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.48203%,1:17.51797%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87266%,1:18.12734%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 8, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     4,      5,      7, ..., 255993, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.  91254.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164746.      0.      0.  91254.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.5893 - tp: 123527.0000 - fp: 68473.0000 - tn: 699527.0000 - fn: 68473.0000 - accuracy: 0.8573 - precision: 0.6434 - recall: 0.6434 - auc: 0.8217 - val_loss: 1.5573 - val_tp: 41219.0000 - val_fp: 22781.0000 - val_tn: 233219.0000 - val_fn: 22781.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.8220
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-12032000-12288000
[INFO] processing batch 12288000-12544000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:61654 (24.08359%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00117%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.93789%,0.8139250565:21.06484%,0.8029830673999999:18.15703%,0.8149336757:17.45625%,0.8137722355:17.3793%,0.814841983:0.00117%,0.0:0.00117%,0.2528119078:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.8465523565:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.38594%,Multi Stage Single Point:28.27344%,Single Stage Single Point:7.34063%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06133%,1:25.93867%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54258%,1:17.45742%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55586%,1:38.44414%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.93438%,1:21.06562%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68281%,1:43.31719%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54336%,1:17.45664%]
[INFO] ** dst-192.168.1.40:[0:81.84297%,1:18.15703%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06133%,1:25.93867%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54258%,1:17.45742%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55586%,1:38.44414%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6207%,1:17.3793%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06211%,1:25.93789%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93516%,1:21.06484%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54375%,1:17.45625%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84336%,1:18.15664%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 3, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([203060, 203067, 203071, ..., 255992, 255993, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([     1,      2,      5, ..., 203055, 203056, 203057]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.  72380.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164828.  18792.      0.  72380.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.5322 - tp: 123560.0000 - fp: 68440.0000 - tn: 699560.0000 - fn: 68440.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.8218 - val_loss: 1.1028 - val_tp: 41268.0000 - val_fp: 22732.0000 - val_tn: 233268.0000 - val_fn: 22732.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.8958
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-12288000-12544000
[INFO] processing batch 12544000-12800000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:63248 (24.70625%)
[INFO] ** service:[0.7025755984000001:99.99805%,0.002116286:0.00117%,0.0012540954:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.9293%,0.8139250565:21.08945%,0.8029830673999999:18.1125%,0.8149336757:17.48984%,0.8137722355:17.37539%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.9802707989:0.00039%,0.9054801638:0.00039%,0.9502261752:0.00039%,0.7788831836:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.39727%,Single Stage Single Point:35.60273%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06992%,1:25.93008%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.51016%,1:17.48984%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88711%,1:18.11289%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.53516%,1:38.46484%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91055%,1:21.08945%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69492%,1:43.30508%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.51016%,1:17.48984%]
[INFO] ** dst-192.168.1.40:[0:81.88711%,1:18.11289%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06992%,1:25.93008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51016%,1:17.48984%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88711%,1:18.11289%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.53516%,1:38.46484%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62461%,1:17.37539%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.07148%,1:25.92852%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91055%,1:21.08945%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51055%,1:17.48945%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8875%,1:18.1125%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      4,      5, ..., 255992, 255994, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164857.  91143.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 1.0036 - tp: 123588.0000 - fp: 68412.0000 - tn: 699588.0000 - fn: 68412.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9109 - val_loss: 0.9765 - val_tp: 41269.0000 - val_fp: 22731.0000 - val_tn: 233269.0000 - val_fn: 22731.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-12544000-12800000
[INFO] processing batch 12800000-13056000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:59778 (23.35078%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0:0.00078%]
[INFO] ** s_port:[0.834280824:25.93711%,0.8139250565:21.04336%,0.8029830673999999:18.1625%,0.8149336757:17.49609%,0.8137722355:17.35859%,0.8059172320999999:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:64.34062%,Single Stage Single Point:35.65937%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0625%,1:25.9375%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.83711%,1:18.16289%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.59805%,1:38.40195%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.95664%,1:21.04336%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.7043%,1:43.2957%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50352%,1:17.49648%]
[INFO] ** dst-192.168.1.40:[0:81.8375%,1:18.1625%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0625%,1:25.9375%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.83711%,1:18.16289%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59805%,1:38.40195%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6418%,1:17.3582%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06289%,1:25.93711%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95664%,1:21.04336%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50391%,1:17.49609%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8375%,1:18.1625%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      4, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164712.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      6, ..., 255990, 255992, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164712.  91288.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9580 - tp: 123531.0000 - fp: 68469.0000 - tn: 699531.0000 - fn: 68469.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9108 - val_loss: 0.9360 - val_tp: 41181.0000 - val_fp: 22819.0000 - val_tn: 233181.0000 - val_fn: 22819.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-12800000-13056000
[INFO] processing batch 13056000-13312000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:59589 (23.27695%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.92344%,0.8139250565:21.10312%,0.8029830673999999:18.15703%,0.8149336757:17.46484%,0.8137722355:17.34961%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:64.37773%,Single Stage Single Point:35.62227%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.07578%,1:25.92422%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53477%,1:17.46523%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54727%,1:38.45273%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.89687%,1:21.10312%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.72695%,1:43.27305%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53516%,1:17.46484%]
[INFO] ** dst-192.168.1.40:[0:81.84219%,1:18.15781%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.07578%,1:25.92422%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53477%,1:17.46523%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84258%,1:18.15742%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54727%,1:38.45273%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00156%,0:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65039%,1:17.34961%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.07695%,1:25.92305%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.89727%,1:21.10273%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53555%,1:17.46445%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84336%,1:18.15664%]
[INFO] columns with count within 2-10 {'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      6, ..., 255992, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164807.  91193.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.9166 - tp: 123615.0000 - fp: 68385.0000 - tn: 699615.0000 - fn: 68385.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.8986 - val_tp: 41192.0000 - val_fp: 22808.0000 - val_tn: 233192.0000 - val_fn: 22808.0000 - val_accuracy: 0.8575 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-13056000-13312000
[INFO] processing batch 13312000-13568000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99062%,0.0:0.00938%]
[INFO] ** modbus_transaction_id:59423 (23.21211%)
[INFO] ** service:[0.7025755984000001:99.99062%,0.0208806885:0.00156%,0.002116286:0.00156%,0.0021476384:0.00156%,0.0021633145999999997:0.00117%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.09248953609999999:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.96484%,0.8139250565:20.99258%,0.8029830673999999:18.22031%,0.8149336757:17.47617%,0.8137722355:17.33555%,0.0020936488:0.00156%,0.0:0.00117%,0.0021089309:0.00117%,0.814841983:0.00078%,0.9502261752:0.00039%,0.9834647595:0.00039%,0.8030441959000001:0.00039%,0.7788831836:0.00039%,0.8465523565:0.00039%,0.9715599976:0.00039%,0.9054801638:0.00039%,0.9802707989:0.00039%,0.8411730545999999:0.00039%,0.15240846019999998:0.00039%,0.0818051226:0.00039%,0.15243902439999998:0.00039%,0.9344397579000001:0.00039%,0.315972859:0.00039%,0.9535729568000001:0.00039%]
[INFO] ** classification:[normal:64.30313%,Single Stage Single Point:35.69688%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03516%,1:25.96484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52305%,1:17.47695%]
[INFO] ** src-192.168.1.200:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.7793%,1:18.2207%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** src-192.168.1.88:[0:99.99844%,1:0.00156%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.00742%,1:20.99258%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69922%,1:43.30078%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.255:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.30:[0:82.52383%,1:17.47617%]
[INFO] ** dst-192.168.1.40:[0:81.77969%,1:18.22031%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99453%,0:0.00547%]
[INFO] ** proto-udp:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99062%,0:0.00938%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03516%,1:25.96484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52305%,1:17.47695%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.7793%,1:18.2207%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-0:[0:99.99062%,1:0.00938%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98867%,1:0.01133%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66445%,1:17.33555%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03555%,1:25.96445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.00742%,1:20.99258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52422%,1:17.47578%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77969%,1:18.22031%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255994, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164616.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      5,      7, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164616.  91384.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8842 - tp: 123437.0000 - fp: 68563.0000 - tn: 699437.0000 - fn: 68563.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.9107 - val_loss: 0.8674 - val_tp: 41179.0000 - val_fp: 22821.0000 - val_tn: 233179.0000 - val_fn: 22821.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-13312000-13568000
[INFO] processing batch 13568000-13824000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:65533 (25.59883%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.08394601119999999:0.00195%,0.0208806885:0.00039%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.93906%,0.8139250565:21.07109%,0.8029830673999999:18.15859%,0.8149336757:17.48516%,0.8137722355:17.3418%,0.8166299895999999:0.00156%,0.8059172320999999:0.00039%,0.7593068036:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.35586%,Single Stage Single Point:35.64414%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06055%,1:25.93945%]
[INFO] ** src-192.168.1.134:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.20:[0:82.51484%,1:17.48516%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84141%,1:18.15859%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58711%,1:38.41289%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.92891%,1:21.07109%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71914%,1:43.28086%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.51445%,1:17.48555%]
[INFO] ** dst-192.168.1.40:[0:81.84141%,1:18.15859%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99805%,1:0.00195%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06055%,1:25.93945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51484%,1:17.48516%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84141%,1:18.15859%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58711%,1:38.41289%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65859%,1:17.34141%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06133%,1:25.93867%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92891%,1:21.07109%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51484%,1:17.48516%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84141%,1:18.15859%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255994, 255996, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164751.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      4,      7, ..., 255995, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164751.  91249.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.8537 - tp: 123539.0000 - fp: 68461.0000 - tn: 699539.0000 - fn: 68461.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9108 - val_loss: 0.8393 - val_tp: 41212.0000 - val_fp: 22788.0000 - val_tn: 233212.0000 - val_fn: 22788.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-13568000-13824000
[INFO] processing batch 13824000-14080000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.95586%,0.8139250565:21.03906%,0.8029830673999999:18.17891%,0.8149336757:17.47344%,0.8137722355:17.35%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.34727%,Single Stage Single Point:35.65273%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04414%,1:25.95586%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52578%,1:17.47422%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.61094%,1:38.38906%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96094%,1:21.03906%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69414%,1:43.30586%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.52656%,1:17.47344%]
[INFO] ** dst-192.168.1.40:[0:81.8207%,1:18.1793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04414%,1:25.95586%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52578%,1:17.47422%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.61094%,1:38.38906%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65%,1:17.35%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04453%,1:25.95547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96133%,1:21.03867%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52695%,1:17.47305%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82148%,1:18.17852%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      5, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      4, ..., 255992, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164729.  91271.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.8284 - tp: 123556.0000 - fp: 68444.0000 - tn: 699556.0000 - fn: 68444.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.9109 - val_loss: 0.8171 - val_tp: 41173.0000 - val_fp: 22827.0000 - val_tn: 233173.0000 - val_fn: 22827.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-13824000-14080000
[INFO] processing batch 14080000-14336000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:62632 (24.46562%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.09248953609999999:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.93789%,0.8139250565:21.06602%,0.8029830673999999:18.12578%,0.8149336757:17.45859%,0.8137722355:17.40898%,0.8343113882:0.00078%,0.8345253376999999:0.00039%,0.1074484993:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.41484%,Single Stage Single Point:35.58516%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.54141%,1:17.45859%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87383%,1:18.12617%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.525%,1:38.475%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.93359%,1:21.06641%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65273%,1:43.34727%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54102%,1:17.45898%]
[INFO] ** dst-192.168.1.40:[0:81.87422%,1:18.12578%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54141%,1:17.45859%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87383%,1:18.12617%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.525%,1:38.475%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.59102%,1:17.40898%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0625%,1:25.9375%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93398%,1:21.06602%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5418%,1:17.4582%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87422%,1:18.12578%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - success': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      6, ..., 255993, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164902.  91098.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.8057 - tp: 123681.0000 - fp: 68319.0000 - tn: 699681.0000 - fn: 68319.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9111 - val_loss: 0.7960 - val_tp: 41221.0000 - val_fp: 22779.0000 - val_tn: 233221.0000 - val_fn: 22779.0000 - val_accuracy: 0.8576 - val_precision: 0.6441 - val_recall: 0.6441 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-14080000-14336000
[INFO] processing batch 14336000-14592000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:58803 (22.96992%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.99727%,0.8139250565:21.03086%,0.8029830673999999:18.15469%,0.8149336757:17.50117%,0.8137722355:17.31172%,0.0:0.00273%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%]
[INFO] ** classification:[normal:64.34375%,Single Stage Single Point:35.65625%]
[INFO] ** orig-192.168.1.48:[1:99.99883%,0:0.00117%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99844%,1:0.00156%]
[INFO] ** type-log:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00273%,1:25.99727%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.84492%,1:18.15508%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.65742%,1:38.34258%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:78.96914%,1:21.03086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.69102%,1:43.30898%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49883%,1:17.50117%]
[INFO] ** dst-192.168.1.40:[0:81.84531%,1:18.15469%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00273%,1:25.99727%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84492%,1:18.15508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65742%,1:38.34258%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68867%,1:17.31133%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00273%,1:25.99727%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96914%,1:21.03086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49883%,1:17.50117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8457%,1:18.1543%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 's_port': 9, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255992, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164720.  91280.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7886 - tp: 123523.0000 - fp: 68477.0000 - tn: 699523.0000 - fn: 68477.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.9109 - val_loss: 0.7796 - val_tp: 41197.0000 - val_fp: 22803.0000 - val_tn: 233197.0000 - val_fn: 22803.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-14336000-14592000
[INFO] processing batch 14592000-14848000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:61358 (23.96797%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00078%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.98203%,0.8139250565:21.03906%,0.8029830673999999:18.13672%,0.8149336757:17.46211%,0.8137722355:17.37617%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.9344397579000001:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.4%,Single Stage Single Point:35.6%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01758%,1:25.98242%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.5375%,1:17.4625%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8625%,1:18.1375%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** src-192.168.1.88:[0:99.99844%,1:0.00156%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96055%,1:21.03945%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64141%,1:43.35859%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.5375%,1:17.4625%]
[INFO] ** dst-192.168.1.40:[0:81.86289%,1:18.13711%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01758%,1:25.98242%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.5375%,1:17.4625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8625%,1:18.1375%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62383%,1:17.37617%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01875%,1:25.98125%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96094%,1:21.03906%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53828%,1:17.46172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86328%,1:18.13672%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      7,      8, ..., 255989, 255993, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164864.  91136.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7718 - tp: 123652.0000 - fp: 68348.0000 - tn: 699652.0000 - fn: 68348.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9110 - val_loss: 0.7647 - val_tp: 41212.0000 - val_fp: 22788.0000 - val_tn: 233212.0000 - val_fn: 22788.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-14592000-14848000
[INFO] processing batch 14848000-15104000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:65530 (25.59766%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.01992%,0.8139250565:21.02656%,0.8029830673999999:18.12148%,0.8149336757:17.50391%,0.8137722355:17.32656%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.37461%,Single Stage Single Point:35.62539%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9793%,1:26.0207%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4957%,1:17.5043%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87852%,1:18.12148%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.64688%,1:38.35312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97344%,1:21.02656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65352%,1:43.34648%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49609%,1:17.50391%]
[INFO] ** dst-192.168.1.40:[0:81.87812%,1:18.12188%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9793%,1:26.0207%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4957%,1:17.5043%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87852%,1:18.12148%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.64688%,1:38.35312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99805%,1:0.00195%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67344%,1:17.32656%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98008%,1:26.01992%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97344%,1:21.02656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49648%,1:17.50352%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87852%,1:18.12148%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     4,      5,      6, ..., 255996, 255997, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      1,      2, ..., 255990, 255992, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164799.  91201.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7588 - tp: 123594.0000 - fp: 68406.0000 - tn: 699594.0000 - fn: 68406.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9110 - val_loss: 0.7526 - val_tp: 41205.0000 - val_fp: 22795.0000 - val_tn: 233205.0000 - val_fn: 22795.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-14848000-15104000
[INFO] processing batch 15104000-15360000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:55201 (21.56289%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.9457%,0.8139250565:21.08125%,0.8029830673999999:18.10352%,0.8149336757:17.49609%,0.8137722355:17.37188%,0.8030136315999999:0.00078%,0.8059172320999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.39961%,Single Stage Single Point:35.60039%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05391%,1:25.94609%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8957%,1:18.1043%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54688%,1:38.45312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91875%,1:21.08125%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68242%,1:43.31758%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50391%,1:17.49609%]
[INFO] ** dst-192.168.1.40:[0:81.89648%,1:18.10352%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05391%,1:25.94609%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50391%,1:17.49609%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8957%,1:18.1043%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54688%,1:38.45312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62852%,1:17.37148%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.05508%,1:25.94492%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91914%,1:21.08086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50391%,1:17.49609%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.89688%,1:18.10313%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     3,      4,      5, ..., 255993, 255995, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164863.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      1,      2, ..., 255996, 255997, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164863.  91137.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7472 - tp: 123629.0000 - fp: 68371.0000 - tn: 699629.0000 - fn: 68371.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.7416 - val_tp: 41234.0000 - val_fp: 22766.0000 - val_tn: 233234.0000 - val_fn: 22766.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-15104000-15360000
[INFO] processing batch 15360000-15616000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:52006 (20.31484%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.96992%,0.8139250565:21.05938%,0.8029830673999999:18.11211%,0.8149336757:17.47383%,0.8137722355:17.38203%,0.814841983:0.00117%,0.8345253376999999:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.41328%,Single Stage Single Point:35.58672%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52461%,1:17.47539%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8875%,1:18.1125%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.94062%,1:21.05938%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64766%,1:43.35234%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.52578%,1:17.47422%]
[INFO] ** dst-192.168.1.40:[0:81.8875%,1:18.1125%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52461%,1:17.47539%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8875%,1:18.1125%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61797%,1:17.38203%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03008%,1:25.96992%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94062%,1:21.05938%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52656%,1:17.47344%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88789%,1:18.11211%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255995, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      7,      8, ..., 255993, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164898.  91102.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7376 - tp: 123632.0000 - fp: 68368.0000 - tn: 699632.0000 - fn: 68368.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.7322 - val_tp: 41266.0000 - val_fp: 22734.0000 - val_tn: 233266.0000 - val_fn: 22734.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-15360000-15616000
[INFO] processing batch 15616000-15872000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99258%,0.0:0.00742%]
[INFO] ** modbus_transaction_id:52095 (20.34961%)
[INFO] ** service:[0.7025755984000001:99.99258%,0.0:0.00625%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.95977%,0.8139250565:21.03828%,0.8029830673999999:18.20312%,0.8149336757:17.45156%,0.8137722355:17.33906%,0.0:0.00625%,0.9715599976:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.34531%,Single Stage Single Point:35.65469%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_name-eth1:[1:99.99375%,0:0.00625%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99414%,1:0.00586%]
[INFO] ** i/f_dir-outbound:[1:99.99414%,0:0.00586%]
[INFO] ** src-0:[0:99.99375%,1:0.00625%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03945%,1:25.96055%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54844%,1:17.45156%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79688%,1:18.20312%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.62266%,1:38.37734%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99375%,1:0.00625%]
[INFO] ** dst-192.168.1.10:[0:78.96172%,1:21.03828%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70117%,1:43.29883%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.54844%,1:17.45156%]
[INFO] ** dst-192.168.1.40:[0:81.79648%,1:18.20352%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99375%,1:0.00625%]
[INFO] ** proto-tcp:[1:99.99258%,0:0.00742%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99258%,0:0.00742%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99375%,1:0.00625%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03945%,1:25.96055%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54844%,1:17.45156%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79688%,1:18.20312%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.62266%,1:38.37734%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99258%,1:0.00742%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00391%,1:49.99609%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66094%,1:17.33906%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04063%,1:25.95938%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96211%,1:21.03789%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54883%,1:17.45117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79688%,1:18.20312%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      4, ..., 255996, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      5, ..., 255992, 255993, 255997]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164724.  91276.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7302 - tp: 123527.0000 - fp: 68473.0000 - tn: 699527.0000 - fn: 68473.0000 - accuracy: 0.8573 - precision: 0.6434 - recall: 0.6434 - auc: 0.9109 - val_loss: 0.7261 - val_tp: 41197.0000 - val_fp: 22803.0000 - val_tn: 233197.0000 - val_fn: 22803.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-15616000-15872000
[INFO] processing batch 15872000-16128000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:62931 (24.58242%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00078%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.97227%,0.8139250565:21.01094%,0.8029830673999999:18.15195%,0.8149336757:17.50937%,0.8137722355:17.35078%,0.8059172320999999:0.00117%,0.8030136315999999:0.00078%,0.0:0.00078%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.3375%,Single Stage Single Point:35.6625%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02695%,1:25.97305%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84727%,1:18.15273%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.63828%,1:38.36172%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.98906%,1:21.01094%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67695%,1:43.32305%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.49023%,1:17.50977%]
[INFO] ** dst-192.168.1.40:[0:81.84805%,1:18.15195%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02695%,1:25.97305%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84727%,1:18.15273%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63828%,1:38.36172%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64922%,1:17.35078%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02812%,1:25.97188%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.98906%,1:21.01094%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49062%,1:17.50937%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84844%,1:18.15156%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255995, 255997, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164704.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      6,      7, ..., 255994, 255996, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164704.  91296.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7233 - tp: 123531.0000 - fp: 68469.0000 - tn: 699531.0000 - fn: 68469.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9110 - val_loss: 0.7203 - val_tp: 41173.0000 - val_fp: 22827.0000 - val_tn: 233173.0000 - val_fn: 22827.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-15872000-16128000
[INFO] processing batch 16128000-16384000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00508%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0208806885:0.00156%,0.0:0.00156%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.96602%,0.8139250565:21.09766%,0.8029830673999999:18.07891%,0.8149336757:17.47734%,0.8137722355:17.37344%,0.0:0.00156%,0.0020936488:0.00078%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8147502904:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.8344030809:0.00039%,0.15243902439999998:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:64.44375%,Single Stage Single Point:35.55625%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0332%,1:25.9668%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52227%,1:17.47773%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.92109%,1:18.07891%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.52891%,1:38.47109%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:78.90234%,1:21.09766%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66055%,1:43.33945%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.52266%,1:17.47734%]
[INFO] ** dst-192.168.1.40:[0:81.92031%,1:18.07969%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0332%,1:25.9668%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52227%,1:17.47773%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.92109%,1:18.07891%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.52891%,1:38.47109%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99492%,1:0.00508%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62656%,1:17.37344%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03438%,1:25.96562%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90234%,1:21.09766%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52305%,1:17.47695%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.92109%,1:18.07891%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      7, ..., 255993, 255994, 255995]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164976.  91024.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7163 - tp: 123781.0000 - fp: 68219.0000 - tn: 699781.0000 - fn: 68219.0000 - accuracy: 0.8579 - precision: 0.6447 - recall: 0.6447 - auc: 0.9112 - val_loss: 0.7148 - val_tp: 41195.0000 - val_fp: 22805.0000 - val_tn: 233195.0000 - val_fn: 22805.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-16128000-16384000
[INFO] processing batch 16384000-16640000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:63141 (24.66445%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.002116286:0.00117%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.95469%,0.8139250565:21.07812%,0.8029830673999999:18.19219%,0.8149336757:17.43789%,0.8137722355:17.33281%,0.814841983:0.00078%,0.7825203251999999:0.00039%,0.9802707989:0.00039%,0.9054801638:0.00039%,0.8345253376999999:0.00039%,0.9502261752:0.00039%,0.2528119078:0.00039%,0.7788831836:0.00039%,0.0020936488:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.36953%,Single Stage Single Point:35.63047%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04492%,1:25.95508%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.56133%,1:17.43867%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.58906%,1:38.41094%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.92148%,1:21.07852%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.7125%,1:43.2875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.56172%,1:17.43828%]
[INFO] ** dst-192.168.1.40:[0:81.80781%,1:18.19219%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04492%,1:25.95508%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56133%,1:17.43867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58906%,1:38.41094%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66719%,1:17.33281%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0457%,1:25.9543%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92227%,1:21.07773%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5625%,1:17.4375%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80781%,1:18.19219%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      4,      6, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      3, ..., 255992, 255995, 255996]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164786.  91214.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7124 - tp: 123621.0000 - fp: 68379.0000 - tn: 699621.0000 - fn: 68379.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.7109 - val_tp: 41165.0000 - val_fp: 22835.0000 - val_tn: 233165.0000 - val_fn: 22835.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-16384000-16640000
[INFO] processing batch 16640000-16896000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.95664%,0.8139250565:21.02539%,0.8029830673999999:18.1918%,0.8149336757:17.4918%,0.8137722355:17.33242%,0.8030136315999999:0.00078%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.31523%,Single Stage Single Point:35.68477%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04297%,1:25.95703%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50781%,1:17.49219%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80703%,1:18.19297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.64219%,1:38.35781%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97461%,1:21.02539%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71055%,1:43.28945%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.5082%,1:17.4918%]
[INFO] ** dst-192.168.1.40:[0:81.8082%,1:18.1918%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04297%,1:25.95703%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50781%,1:17.49219%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80703%,1:18.19297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.64219%,1:38.35781%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66797%,1:17.33203%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04375%,1:25.95625%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97461%,1:21.02539%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5082%,1:17.4918%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80859%,1:18.19141%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      3,      5, ..., 255991, 255995, 255996]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164647.  91353.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7095 - tp: 123417.0000 - fp: 68583.0000 - tn: 699417.0000 - fn: 68583.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.9106 - val_loss: 0.7063 - val_tp: 41230.0000 - val_fp: 22770.0000 - val_tn: 233230.0000 - val_fn: 22770.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-16640000-16896000
[INFO] processing batch 16896000-17152000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99805%,0.0:0.00195%]
[INFO] ** s_port:[0.834280824:25.93984%,0.8139250565:21.03945%,0.8029830673999999:18.1543%,0.8149336757:17.47109%,0.8137722355:17.39023%,0.0:0.00195%,0.8059172320999999:0.00117%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.37422%,Single Stage Single Point:35.62578%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99805%,1:0.00195%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05898%,1:25.94102%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52812%,1:17.47188%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8457%,1:18.1543%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.57031%,1:38.42969%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:78.96055%,1:21.03945%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66992%,1:43.33008%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.52852%,1:17.47148%]
[INFO] ** dst-192.168.1.40:[0:81.84492%,1:18.15508%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05898%,1:25.94102%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52812%,1:17.47188%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8457%,1:18.1543%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.57031%,1:38.42969%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00156%,0:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60977%,1:17.39023%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06055%,1:25.93945%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96055%,1:21.03945%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5293%,1:17.4707%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8457%,1:18.1543%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255996, 255997, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164798.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      5, ..., 255992, 255995, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164798.  91202.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.7053 - tp: 123600.0000 - fp: 68400.0000 - tn: 699600.0000 - fn: 68400.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9110 - val_loss: 0.7038 - val_tp: 41198.0000 - val_fp: 22802.0000 - val_tn: 233198.0000 - val_fn: 22802.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-16896000-17152000
[INFO] processing batch 17152000-17408000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99961%,0.8139250565:21.05%,0.8029830673999999:18.12773%,0.8149336757:17.46641%,0.8137722355:17.35547%,0.8059172320999999:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.40586%,Single Stage Single Point:35.59414%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00039%,1:25.99961%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53359%,1:17.46641%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87227%,1:18.12773%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.59453%,1:38.40547%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.95%,1:21.05%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64492%,1:43.35508%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53359%,1:17.46641%]
[INFO] ** dst-192.168.1.40:[0:81.87227%,1:18.12773%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00039%,1:25.99961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53359%,1:17.46641%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87227%,1:18.12773%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59453%,1:38.40547%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99844%,1:0.00156%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64453%,1:17.35547%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00078%,1:25.99922%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95%,1:21.05%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53398%,1:17.46602%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87227%,1:18.12773%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255995, 255996, 255997]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164879.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      6, ..., 255992, 255998, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164879.  91121.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 12s - loss: 0.7020 - tp: 123711.0000 - fp: 68289.0000 - tn: 699711.0000 - fn: 68289.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.9111 - val_loss: 0.7017 - val_tp: 41168.0000 - val_fp: 22832.0000 - val_tn: 233168.0000 - val_fn: 22832.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-17152000-17408000
[INFO] processing batch 17408000-17664000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.97344%,0.8139250565:21.04922%,0.8029830673999999:18.15234%,0.8149336757:17.46406%,0.8137722355:17.35703%,0.8030136315999999:0.00078%,0.814841983:0.00078%,0.0:0.00078%,0.0818051226:0.00039%,0.8344030809:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.38242%,Single Stage Single Point:35.61758%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02578%,1:25.97422%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53516%,1:17.46484%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84648%,1:18.15352%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.59375%,1:38.40625%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.95078%,1:21.04922%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66914%,1:43.33086%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53594%,1:17.46406%]
[INFO] ** dst-192.168.1.40:[0:81.84727%,1:18.15273%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02578%,1:25.97422%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53516%,1:17.46484%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84648%,1:18.15352%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59375%,1:38.40625%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64336%,1:17.35664%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02656%,1:25.97344%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95117%,1:21.04883%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53594%,1:17.46406%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84805%,1:18.15195%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255995, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164819.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      6, ..., 255993, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164819.  91181.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.6998 - tp: 123701.0000 - fp: 68299.0000 - tn: 699701.0000 - fn: 68299.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.9112 - val_loss: 0.7002 - val_tp: 41118.0000 - val_fp: 22882.0000 - val_tn: 233118.0000 - val_fn: 22882.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-17408000-17664000
[INFO] processing batch 17664000-17920000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.08394601119999999:0.00078%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.9793%,0.8139250565:20.98828%,0.8029830673999999:18.18008%,0.8149336757:17.50898%,0.8137722355:17.33984%,0.8166299895999999:0.00078%,0.814841983:0.00078%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.31055%,Single Stage Single Point:35.68945%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01992%,1:25.98008%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.48984%,1:17.51016%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.81992%,1:18.18008%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.01133%,1:20.98867%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68086%,1:43.31914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49062%,1:17.50937%]
[INFO] ** dst-192.168.1.40:[0:81.81953%,1:18.18047%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01992%,1:25.98008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48984%,1:17.51016%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.81992%,1:18.18008%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.67188%,1:38.32812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02148%,1:25.97852%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01172%,1:20.98828%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49141%,1:17.50859%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.81992%,1:18.18008%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     4,      5,      8, ..., 255991, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164635.  91365.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6985 - tp: 123546.0000 - fp: 68454.0000 - tn: 699546.0000 - fn: 68454.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.9109 - val_loss: 0.6987 - val_tp: 41089.0000 - val_fp: 22911.0000 - val_tn: 233089.0000 - val_fn: 22911.0000 - val_accuracy: 0.8568 - val_precision: 0.6420 - val_recall: 0.6420 - val_auc: 0.9105
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-17664000-17920000
[INFO] processing batch 17920000-18176000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.00352%,0.8139250565:21.07344%,0.8029830673999999:18.11914%,0.8149336757:17.46094%,0.8137722355:17.34063%,0.8059172320999999:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.0021089309:0.00039%]
[INFO] ** classification:[normal:64.41953%,Single Stage Single Point:35.58047%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.99648%,1:26.00352%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53906%,1:17.46094%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88047%,1:18.11953%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58594%,1:38.41406%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.92656%,1:21.07344%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65586%,1:43.34414%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.53906%,1:17.46094%]
[INFO] ** dst-192.168.1.40:[0:81.88086%,1:18.11914%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.99648%,1:26.00352%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53906%,1:17.46094%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88047%,1:18.11953%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58594%,1:38.41406%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65938%,1:17.34063%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.99648%,1:26.00352%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92656%,1:21.07344%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53906%,1:17.46094%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88125%,1:18.11875%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      4, ..., 255995, 255996, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      3,      5, ..., 255994, 255997, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164914.  91086.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6963 - tp: 123681.0000 - fp: 68319.0000 - tn: 699681.0000 - fn: 68319.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9112 - val_loss: 0.6954 - val_tp: 41233.0000 - val_fp: 22767.0000 - val_tn: 233233.0000 - val_fn: 22767.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-17920000-18176000
[INFO] processing batch 18176000-18432000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:55800 (21.79688%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.98555%,0.8139250565:21.06953%,0.8029830673999999:18.08633%,0.8149336757:17.48359%,0.8137722355:17.37188%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:64.42891%,Single Stage Single Point:35.57109%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01367%,1:25.98633%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.51641%,1:17.48359%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.93047%,1:21.06953%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64219%,1:43.35781%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.51602%,1:17.48398%]
[INFO] ** dst-192.168.1.40:[0:81.91328%,1:18.08672%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01367%,1:25.98633%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51641%,1:17.48359%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55859%,1:38.44141%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62852%,1:17.37148%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01523%,1:25.98477%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93047%,1:21.06953%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51641%,1:17.48359%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91367%,1:18.08633%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255996, 255997, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164938.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      6,      9, ..., 255992, 255995, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164938.  91062.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6950 - tp: 123640.0000 - fp: 68360.0000 - tn: 699640.0000 - fn: 68360.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9109 - val_loss: 0.6933 - val_tp: 41298.0000 - val_fp: 22702.0000 - val_tn: 233298.0000 - val_fn: 22702.0000 - val_accuracy: 0.8581 - val_precision: 0.6453 - val_recall: 0.6453 - val_auc: 0.9113
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-18176000-18432000
[INFO] processing batch 18432000-18688000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:53869 (21.04258%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08391465880000001:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.95781%,0.8139250565:21.05938%,0.8029830673999999:18.11641%,0.8149336757:17.48984%,0.8137722355:17.37461%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.39375%,Single Stage Single Point:35.60625%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0418%,1:25.9582%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50937%,1:17.49063%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.56602%,1:38.43398%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.94062%,1:21.05938%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66758%,1:43.33242%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.51016%,1:17.48984%]
[INFO] ** dst-192.168.1.40:[0:81.8832%,1:18.1168%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0418%,1:25.9582%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50937%,1:17.49063%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88359%,1:18.11641%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56602%,1:38.43398%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62539%,1:17.37461%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04219%,1:25.95781%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94062%,1:21.05938%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51055%,1:17.48945%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88359%,1:18.11641%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      7, ..., 255993, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164848.  91152.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6939 - tp: 123615.0000 - fp: 68385.0000 - tn: 699615.0000 - fn: 68385.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.6929 - val_tp: 41233.0000 - val_fp: 22767.0000 - val_tn: 233233.0000 - val_fn: 22767.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-18432000-18688000
[INFO] processing batch 18688000-18944000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:54033 (21.10664%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.94609%,0.8139250565:21.09766%,0.8029830673999999:18.11172%,0.8149336757:17.50117%,0.8137722355:17.33984%,0.814841983:0.00078%,0.9344397579000001:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.38633%,Single Stage Single Point:35.61367%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05273%,1:25.94727%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88789%,1:18.11211%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.5625%,1:38.4375%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.90195%,1:21.09805%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71367%,1:43.28633%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.49844%,1:17.50156%]
[INFO] ** dst-192.168.1.40:[0:81.88789%,1:18.11211%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05273%,1:25.94727%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49805%,1:17.50195%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88789%,1:18.11211%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5625%,1:38.4375%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0543%,1:25.9457%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90273%,1:21.09727%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49883%,1:17.50117%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88867%,1:18.11133%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      5,      7, ..., 255992, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164829.  91171.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6926 - tp: 123645.0000 - fp: 68355.0000 - tn: 699645.0000 - fn: 68355.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9110 - val_loss: 0.6925 - val_tp: 41184.0000 - val_fp: 22816.0000 - val_tn: 233184.0000 - val_fn: 22816.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-18688000-18944000
[INFO] processing batch 18944000-19200000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:64214 (25.08359%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.98281%,0.8139250565:21.08516%,0.8029830673999999:18.06875%,0.8149336757:17.45547%,0.8137722355:17.40664%,0.8059172320999999:0.00078%,0.8030136315999999:0.00039%]
[INFO] ** classification:[normal:64.47539%,Single Stage Single Point:35.52461%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01719%,1:25.98281%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54453%,1:17.45547%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.93086%,1:18.06914%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91484%,1:21.08516%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61055%,1:43.38945%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54453%,1:17.45547%]
[INFO] ** dst-192.168.1.40:[0:81.93125%,1:18.06875%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01719%,1:25.98281%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54453%,1:17.45547%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.93086%,1:18.06914%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99805%,1:0.00195%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.59375%,1:17.40625%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01758%,1:25.98242%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91484%,1:21.08516%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54453%,1:17.45547%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.93125%,1:18.06875%]
[INFO] columns with count within 2-10 {'s_port': 7, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      5,      6, ..., 255990, 255994, 255996]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165057.  90943.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6907 - tp: 123888.0000 - fp: 68112.0000 - tn: 699888.0000 - fn: 68112.0000 - accuracy: 0.8581 - precision: 0.6453 - recall: 0.6453 - auc: 0.9113 - val_loss: 0.6917 - val_tp: 41169.0000 - val_fp: 22831.0000 - val_tn: 233169.0000 - val_fn: 22831.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-18944000-19200000
[INFO] processing batch 19200000-19456000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.91523%,0.8139250565:21.08711%,0.8029830673999999:18.23672%,0.8149336757:17.43164%,0.8137722355:17.32812%,0.8059172320999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:64.33164%,Single Stage Single Point:35.66836%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.08438%,1:25.91562%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.56797%,1:17.43203%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76328%,1:18.23672%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91289%,1:21.08711%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.75664%,1:43.24336%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.56836%,1:17.43164%]
[INFO] ** dst-192.168.1.40:[0:81.76289%,1:18.23711%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.08438%,1:25.91562%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56797%,1:17.43203%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76328%,1:18.23672%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58477%,1:38.41523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67188%,1:17.32812%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.08516%,1:25.91484%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91289%,1:21.08711%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56914%,1:17.43086%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76328%,1:18.23672%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164689.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      9, ..., 255994, 255995, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164689.  91311.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6913 - tp: 123500.0000 - fp: 68500.0000 - tn: 699500.0000 - fn: 68500.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.9108 - val_loss: 0.6906 - val_tp: 41189.0000 - val_fp: 22811.0000 - val_tn: 233189.0000 - val_fn: 22811.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-19200000-19456000
[INFO] processing batch 19456000-19712000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00586%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.98398%,0.8139250565:21.0457%,0.8029830673999999:18.14141%,0.8149336757:17.46133%,0.8137722355:17.35859%,0.0:0.00586%,0.8343113882:0.00078%,0.9715599976:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.8345253376999999:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.39648%,Single Stage Single Point:35.60352%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99883%,1:0.00117%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** i/f_name-eth1:[1:99.99414%,0:0.00586%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_dir-outbound:[1:99.99453%,0:0.00547%]
[INFO] ** src-0:[0:99.99414%,1:0.00586%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01445%,1:25.98555%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53828%,1:17.46172%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8582%,1:18.1418%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.5957%,1:38.4043%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99414%,1:0.00586%]
[INFO] ** dst-192.168.1.10:[0:78.9543%,1:21.0457%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65742%,1:43.34258%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53828%,1:17.46172%]
[INFO] ** dst-192.168.1.40:[0:81.8582%,1:18.1418%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99414%,1:0.00586%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99414%,1:0.00586%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99414%,1:0.00586%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01445%,1:25.98555%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53828%,1:17.46172%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8582%,1:18.1418%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5957%,1:38.4043%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64141%,1:17.35859%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01641%,1:25.98359%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95469%,1:21.04531%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53867%,1:17.46133%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85898%,1:18.14102%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      9,     11, ..., 255990, 255992, 255994]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164855.  91145.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6897 - tp: 123689.0000 - fp: 68311.0000 - tn: 699689.0000 - fn: 68311.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9110 - val_loss: 0.6900 - val_tp: 41166.0000 - val_fp: 22834.0000 - val_tn: 233166.0000 - val_fn: 22834.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-19456000-19712000
[INFO] processing batch 19712000-19968000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:56152 (21.93437%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00195%,1.0:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.98945%,0.8139250565:20.99453%,0.8029830673999999:18.17266%,0.8149336757:17.51328%,0.8137722355:17.32656%,0.0:0.00195%,0.814841983:0.00078%,0.0021089309:0.00039%,0.0818356868:0.00039%]
[INFO] ** classification:[normal:64.31406%,Single Stage Single Point:35.68594%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99805%,1:0.00195%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01055%,1:25.98945%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.48594%,1:17.51406%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.67891%,1:38.32109%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:79.00547%,1:20.99453%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68398%,1:43.31602%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.48672%,1:17.51328%]
[INFO] ** dst-192.168.1.40:[0:81.82734%,1:18.17266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01055%,1:25.98945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.48594%,1:17.51406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.67891%,1:38.32109%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67383%,1:17.32617%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01094%,1:25.98906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.00547%,1:20.99453%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.48672%,1:17.51328%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82734%,1:18.17266%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 's_port': 9, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DNP3 Protocol - initialize data to defaults': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      6, ..., 255994, 255997, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      4, ..., 255995, 255996, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164644.  91356.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6899 - tp: 123402.0000 - fp: 68598.0000 - tn: 699402.0000 - fn: 68598.0000 - accuracy: 0.8571 - precision: 0.6427 - recall: 0.6427 - auc: 0.9107 - val_loss: 0.6884 - val_tp: 41242.0000 - val_fp: 22758.0000 - val_tn: 233242.0000 - val_fn: 22758.0000 - val_accuracy: 0.8578 - val_precision: 0.6444 - val_recall: 0.6444 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-19712000-19968000
[INFO] processing batch 19968000-20224000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:58822 (22.97734%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.0021476384:0.00156%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.91172%,0.8139250565:21.07344%,0.8029830673999999:18.17578%,0.8149336757:17.45547%,0.8137722355:17.37695%,0.0020936488:0.00156%,0.7586191087:0.00039%,0.8147502904:0.00039%,0.0021089309:0.00039%,0.8345253376999999:0.00039%,0.8059172320999999:0.00039%,0.8411730545999999:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.8344030809:0.00039%,0.15243902439999998:0.00039%,0.8030136315999999:0.00039%,0.315972859:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.36797%,Single Stage Single Point:35.63203%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.0875%,1:25.9125%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.20:[0:82.54414%,1:17.45586%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82383%,1:18.17617%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.92656%,1:21.07344%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71133%,1:43.28867%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.54414%,1:17.45586%]
[INFO] ** dst-192.168.1.40:[0:81.82344%,1:18.17656%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.0875%,1:25.9125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54414%,1:17.45586%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82383%,1:18.17617%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99297%,1:0.00703%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62305%,1:17.37695%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.08828%,1:25.91172%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92656%,1:21.07344%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54492%,1:17.45508%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82422%,1:18.17578%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     3,      9,     12, ..., 255991, 255993, 255995]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164782.  91218.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6887 - tp: 123541.0000 - fp: 68459.0000 - tn: 699541.0000 - fn: 68459.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9109 - val_loss: 0.6877 - val_tp: 41241.0000 - val_fp: 22759.0000 - val_tn: 233241.0000 - val_fn: 22759.0000 - val_accuracy: 0.8578 - val_precision: 0.6444 - val_recall: 0.6444 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-19968000-20224000
[INFO] processing batch 20224000-20480000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.98945%,0.0:0.01055%]
[INFO] ** modbus_transaction_id:63526 (24.81484%)
[INFO] ** service:[0.7025755984000001:99.98945%,0.08394601119999999:0.00195%,0.0208806885:0.00195%,0.002116286:0.00156%,0.0:0.00156%,0.0021476384:0.00117%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08543524949999999:0.00039%,0.09248953609999999:0.00039%,0.0021633145999999997:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.97188%,0.8139250565:21.05156%,0.8029830673999999:18.16094%,0.8149336757:17.44414%,0.8137722355:17.35977%,0.0:0.00156%,0.0020936488:0.00117%,0.8166299895999999:0.00078%,1.0:0.00039%,0.9535729568000001:0.00039%,0.315972859:0.00039%,0.9834647595:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.7788831836:0.00039%,0.0021089309:0.00039%,0.9502261752:0.00039%,0.9054801638:0.00039%,0.8030136315999999:0.00039%,0.15243902439999998:0.00039%,0.9802707989:0.00039%,0.8411730545999999:0.00039%,0.8059172320999999:0.00039%,0.7593068036:0.00039%,0.7825203251999999:0.00039%,0.9344397579000001:0.00039%,0.15240846019999998:0.00039%,0.0818051226:0.00039%,0.9715599976:0.00039%]
[INFO] ** classification:[normal:64.39414%,Single Stage Single Point:35.60586%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02812%,1:25.97188%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.20:[0:82.55586%,1:17.44414%]
[INFO] ** src-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.201:[0:99.99648%,1:0.00352%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.83828%,1:18.16172%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.60:[0:61.58867%,1:38.41133%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:78.94844%,1:21.05156%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66797%,1:43.33203%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.55586%,1:17.44414%]
[INFO] ** dst-192.168.1.40:[0:81.83906%,1:18.16094%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99805%,1:0.00195%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99414%,0:0.00586%]
[INFO] ** proto-udp:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98945%,0:0.01055%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99609%,1:0.00391%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02812%,1:25.97188%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.55586%,1:17.44414%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.83828%,1:18.16172%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58867%,1:38.41133%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.98945%,1:0.01055%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00625%,1:49.99375%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98711%,1:0.01289%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64023%,1:17.35977%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02891%,1:25.97109%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94844%,1:21.05156%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.55586%,1:17.44414%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.83945%,1:18.16055%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      5, ..., 255996, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164849.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      3,      4, ..., 255992, 255993, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164849.  91151.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6876 - tp: 123640.0000 - fp: 68360.0000 - tn: 699640.0000 - fn: 68360.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.9110 - val_loss: 0.6873 - val_tp: 41209.0000 - val_fp: 22791.0000 - val_tn: 233209.0000 - val_fn: 22791.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-20224000-20480000
[INFO] processing batch 20480000-20736000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0021633145999999997:0.00117%,0.002116286:0.00117%,0.0012540954:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.93828%,0.8139250565:21.09258%,0.8029830673999999:18.17773%,0.8149336757:17.43398%,0.8137722355:17.35234%,0.0021089309:0.00117%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.9502261752:0.00039%,0.8212604682:0.00039%,0.7788831836:0.00039%,0.0020936488:0.00039%,0.9088575095999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.38789%,Single Stage Single Point:35.61211%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.56523%,1:17.43477%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82227%,1:18.17773%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.55508%,1:38.44492%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.90742%,1:21.09258%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70937%,1:43.29062%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.56562%,1:17.43438%]
[INFO] ** dst-192.168.1.40:[0:81.82227%,1:18.17773%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.06094%,1:25.93906%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56523%,1:17.43477%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82227%,1:18.17773%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.55508%,1:38.44492%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64805%,1:17.35195%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.06172%,1:25.93828%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90742%,1:21.09258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56602%,1:17.43398%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82227%,1:18.17773%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      3,      4, ..., 255995, 255997, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      1,      8, ..., 255993, 255996, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164833.  91167.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6871 - tp: 123598.0000 - fp: 68402.0000 - tn: 699598.0000 - fn: 68402.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9109 - val_loss: 0.6864 - val_tp: 41235.0000 - val_fp: 22765.0000 - val_tn: 233235.0000 - val_fn: 22765.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-20480000-20736000
[INFO] processing batch 20736000-20992000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0:0.00078%]
[INFO] ** s_port:[0.834280824:25.98789%,0.8139250565:21.075%,0.8029830673999999:18.09727%,0.8149336757:17.45625%,0.8137722355:17.38125%,0.8030136315999999:0.00078%,0.814841983:0.00078%,0.0:0.00078%]
[INFO] ** classification:[normal:64.4457%,Single Stage Single Point:35.5543%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.01211%,1:25.98789%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54297%,1:17.45703%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.90195%,1:18.09805%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54375%,1:38.45625%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.925%,1:21.075%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63086%,1:43.36914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54375%,1:17.45625%]
[INFO] ** dst-192.168.1.40:[0:81.90273%,1:18.09727%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.01211%,1:25.98789%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54297%,1:17.45703%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.90195%,1:18.09805%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54375%,1:38.45625%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61875%,1:17.38125%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.01289%,1:25.98711%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92539%,1:21.07461%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54453%,1:17.45547%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.90273%,1:18.09727%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 8, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255989, 255995, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164981.  91019.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6859 - tp: 123769.0000 - fp: 68231.0000 - tn: 699769.0000 - fn: 68231.0000 - accuracy: 0.8579 - precision: 0.6446 - recall: 0.6446 - auc: 0.9112 - val_loss: 0.6860 - val_tp: 41212.0000 - val_fp: 22788.0000 - val_tn: 233212.0000 - val_fn: 22788.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-20736000-20992000
[INFO] processing batch 20992000-21248000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:64919 (25.35898%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.97148%,0.8139250565:21.03398%,0.8029830673999999:18.17773%,0.8149336757:17.49805%,0.8137722355:17.31641%,0.8059172320999999:0.00078%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.32344%,Single Stage Single Point:35.67656%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02773%,1:25.97227%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50156%,1:17.49844%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82188%,1:18.17813%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.64961%,1:38.35039%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.96602%,1:21.03398%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.71172%,1:43.28828%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50156%,1:17.49844%]
[INFO] ** dst-192.168.1.40:[0:81.82188%,1:18.17813%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02773%,1:25.97227%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50156%,1:17.49844%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82188%,1:18.17813%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.64961%,1:38.35039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68359%,1:17.31641%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02852%,1:25.97148%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96602%,1:21.03398%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50195%,1:17.49805%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82266%,1:18.17734%]
[INFO] columns with count within 2-10 {'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      9, ..., 255991, 255992, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164668.  91332.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6862 - tp: 123459.0000 - fp: 68541.0000 - tn: 699459.0000 - fn: 68541.0000 - accuracy: 0.8572 - precision: 0.6430 - recall: 0.6430 - auc: 0.9108 - val_loss: 0.6854 - val_tp: 41209.0000 - val_fp: 22791.0000 - val_tn: 233209.0000 - val_fn: 22791.0000 - val_accuracy: 0.8576 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-20992000-21248000
[INFO] processing batch 21248000-21504000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:65321 (25.51602%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00117%,0.08391465880000001:0.00078%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.92227%,0.8139250565:21.08281%,0.8029830673999999:18.1707%,0.8149336757:17.42852%,0.8137722355:17.3918%,0.0:0.00117%,0.0818051226:0.00078%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.0020936488:0.00039%,0.8683752063:0.00039%]
[INFO] ** classification:[normal:64.40078%,Single Stage Single Point:35.59922%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.07656%,1:25.92344%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.57148%,1:17.42852%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.8293%,1:18.1707%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.52539%,1:38.47461%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.91719%,1:21.08281%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68594%,1:43.31406%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.57148%,1:17.42852%]
[INFO] ** dst-192.168.1.40:[0:81.82891%,1:18.17109%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.07656%,1:25.92344%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.57148%,1:17.42852%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8293%,1:18.1707%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.52539%,1:38.47461%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60859%,1:17.39141%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.07812%,1:25.92188%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91719%,1:21.08281%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.57148%,1:17.42852%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.8293%,1:18.1707%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      5, ..., 255993, 255994, 255995]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164866.  91134.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6849 - tp: 123683.0000 - fp: 68317.0000 - tn: 699683.0000 - fn: 68317.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9110 - val_loss: 0.6850 - val_tp: 41183.0000 - val_fp: 22817.0000 - val_tn: 233183.0000 - val_fn: 22817.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-21248000-21504000
[INFO] processing batch 21504000-21760000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:60727 (23.72148%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99648%,0.8139250565:21.01445%,0.8029830673999999:18.12266%,0.8149336757:17.49414%,0.8137722355:17.36992%,0.8030136315999999:0.00078%,0.8059172320999999:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:64.38203%,Single Stage Single Point:35.61797%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00352%,1:25.99648%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50547%,1:17.49453%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87617%,1:18.12383%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.61562%,1:38.38438%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.98555%,1:21.01445%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6332%,1:43.3668%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50586%,1:17.49414%]
[INFO] ** dst-192.168.1.40:[0:81.87734%,1:18.12266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00352%,1:25.99648%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50547%,1:17.49453%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87617%,1:18.12383%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.61562%,1:38.38438%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63008%,1:17.36992%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00391%,1:25.99609%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.98555%,1:21.01445%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50664%,1:17.49336%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87734%,1:18.12266%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255993, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255995, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164818.  91182.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6846 - tp: 123564.0000 - fp: 68436.0000 - tn: 699564.0000 - fn: 68436.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.9108 - val_loss: 0.6837 - val_tp: 41254.0000 - val_fp: 22746.0000 - val_tn: 233254.0000 - val_fn: 22746.0000 - val_accuracy: 0.8578 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-21504000-21760000
[INFO] processing batch 21760000-22016000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:56134 (21.92734%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00078%]
[INFO] ** s_port:[0.834280824:25.90469%,0.8139250565:21.12695%,0.8029830673999999:18.12656%,0.8149336757:17.425%,0.8137722355:17.41367%,0.814841983:0.00117%,0.8166299895999999:0.00078%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:64.44805%,Single Stage Single Point:35.55195%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09453%,1:25.90547%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.57344%,1:17.42656%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.87344%,1:18.12656%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.45938%,1:38.54062%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.87305%,1:21.12695%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68164%,1:43.31836%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.57461%,1:17.42539%]
[INFO] ** dst-192.168.1.40:[0:81.87305%,1:18.12695%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09453%,1:25.90547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.57344%,1:17.42656%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87344%,1:18.12656%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.45938%,1:38.54062%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.58633%,1:17.41367%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0957%,1:25.9043%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.87305%,1:21.12695%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.575%,1:17.425%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87344%,1:18.12656%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      6, ..., 255994, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164987.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      4, ..., 255995, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164987.  91013.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6835 - tp: 123717.0000 - fp: 68283.0000 - tn: 699717.0000 - fn: 68283.0000 - accuracy: 0.8577 - precision: 0.6444 - recall: 0.6444 - auc: 0.9111 - val_loss: 0.6829 - val_tp: 41270.0000 - val_fp: 22730.0000 - val_tn: 233270.0000 - val_fn: 22730.0000 - val_accuracy: 0.8579 - val_precision: 0.6448 - val_recall: 0.6448 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-21760000-22016000
[INFO] processing batch 22016000-22272000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65090 (25.42578%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00078%,0.09248953609999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.9543%,0.8139250565:21.04297%,0.8029830673999999:18.15234%,0.8149336757:17.475%,0.8137722355:17.37266%,0.8059172320999999:0.00078%,0.0:0.00078%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:64.37266%,Single Stage Single Point:35.62734%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04531%,1:25.95469%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.525%,1:17.475%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58438%,1:38.41562%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.95703%,1:21.04297%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67305%,1:43.32695%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.525%,1:17.475%]
[INFO] ** dst-192.168.1.40:[0:81.84766%,1:18.15234%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04531%,1:25.95469%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.525%,1:17.475%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58438%,1:38.41562%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62773%,1:17.37227%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04609%,1:25.95391%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95742%,1:21.04258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.525%,1:17.475%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84766%,1:18.15234%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255995, 255996, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164794.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      7, ..., 255992, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164794.  91206.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6830 - tp: 123690.0000 - fp: 68310.0000 - tn: 699690.0000 - fn: 68310.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9111 - val_loss: 0.6839 - val_tp: 41104.0000 - val_fp: 22896.0000 - val_tn: 233104.0000 - val_fn: 22896.0000 - val_accuracy: 0.8569 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-22016000-22272000
[INFO] processing batch 22272000-22528000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99727%,0.0:0.00273%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0:0.00234%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:25.97461%,0.8139250565:21.1%,0.8029830673999999:18.12305%,0.8149336757:17.45625%,0.8137722355:17.3418%,0.0:0.00234%,0.8059172320999999:0.00039%,0.0818051226:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.41992%,Single Stage Single Point:35.58008%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02461%,1:25.97539%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.54375%,1:17.45625%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.87656%,1:18.12344%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.5582%,1:38.4418%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:78.9%,1:21.1%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6832%,1:43.3168%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.54336%,1:17.45664%]
[INFO] ** dst-192.168.1.40:[0:81.87695%,1:18.12305%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99727%,0:0.00273%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02461%,1:25.97539%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.54375%,1:17.45625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.87656%,1:18.12344%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5582%,1:38.4418%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6582%,1:17.3418%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02578%,1:25.97422%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.9%,1:21.1%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.54453%,1:17.45547%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87734%,1:18.12266%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      4, ..., 255993, 255996, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      3,      5, ..., 255995, 255997, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6825 - tp: 123672.0000 - fp: 68328.0000 - tn: 699672.0000 - fn: 68328.0000 - accuracy: 0.8577 - precision: 0.6441 - recall: 0.6441 - auc: 0.9110 - val_loss: 0.6820 - val_tp: 41243.0000 - val_fp: 22757.0000 - val_tn: 233243.0000 - val_fn: 22757.0000 - val_accuracy: 0.8578 - val_precision: 0.6444 - val_recall: 0.6444 - val_auc: 0.9111
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-22272000-22528000
[INFO] processing batch 22528000-22784000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.96172%,0.8139250565:21.05625%,0.8029830673999999:18.09258%,0.8149336757:17.4875%,0.8137722355:17.40039%,0.8059172320999999:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.41992%,Single Stage Single Point:35.58008%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.51172%,1:17.48828%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.90742%,1:18.09258%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.54336%,1:38.45664%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.94336%,1:21.05664%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63789%,1:43.36211%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.5125%,1:17.4875%]
[INFO] ** dst-192.168.1.40:[0:81.90703%,1:18.09297%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51172%,1:17.48828%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.90742%,1:18.09258%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54336%,1:38.45664%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99805%,1:0.00195%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.59961%,1:17.40039%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03828%,1:25.96172%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94414%,1:21.05586%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5125%,1:17.4875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.90742%,1:18.09258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 's_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      5,      7, ..., 255990, 255991, 255996]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164915.  91085.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6821 - tp: 123623.0000 - fp: 68377.0000 - tn: 699623.0000 - fn: 68377.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.9110 - val_loss: 0.6810 - val_tp: 41292.0000 - val_fp: 22708.0000 - val_tn: 233292.0000 - val_fn: 22708.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.9113
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-22528000-22784000
[INFO] processing batch 22784000-23040000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:56752 (22.16875%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.00898%,0.8139250565:21.04414%,0.8029830673999999:18.06172%,0.8149336757:17.50859%,0.8137722355:17.37383%,0.814841983:0.00117%,0.9344397579000001:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:64.4293%,Single Stage Single Point:35.5707%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.99023%,1:26.00977%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.93828%,1:18.06172%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.58203%,1:38.41797%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.95586%,1:21.04414%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61719%,1:43.38281%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.49102%,1:17.50898%]
[INFO] ** dst-192.168.1.40:[0:81.93828%,1:18.06172%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.99023%,1:26.00977%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.49023%,1:17.50977%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.93828%,1:18.06172%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.58203%,1:38.41797%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62656%,1:17.37344%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9918%,1:26.0082%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95586%,1:21.04414%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49141%,1:17.50859%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.93828%,1:18.06172%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      6, ..., 255996, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      4, ..., 255989, 255993, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164939.  91061.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6811 - tp: 123759.0000 - fp: 68241.0000 - tn: 699759.0000 - fn: 68241.0000 - accuracy: 0.8578 - precision: 0.6446 - recall: 0.6446 - auc: 0.9111 - val_loss: 0.6815 - val_tp: 41180.0000 - val_fp: 22820.0000 - val_tn: 233180.0000 - val_fn: 22820.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-22784000-23040000
[INFO] processing batch 23040000-23296000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:56178 (21.94453%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.86328%,0.8139250565:21.12305%,0.8029830673999999:18.19102%,0.8149336757:17.44766%,0.8137722355:17.37188%,0.8059172320999999:0.00078%,0.8030136315999999:0.00078%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.36016%,Single Stage Single Point:35.63984%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.13555%,1:25.86445%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.55234%,1:17.44766%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.50508%,1:38.49492%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.87695%,1:21.12305%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.76445%,1:43.23555%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.55234%,1:17.44766%]
[INFO] ** dst-192.168.1.40:[0:81.80859%,1:18.19141%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.13555%,1:25.86445%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.55234%,1:17.44766%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80781%,1:18.19219%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.50508%,1:38.49492%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00156%,0:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62812%,1:17.37188%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.13672%,1:25.86328%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.87734%,1:21.12266%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.55273%,1:17.44727%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80937%,1:18.19062%]
[INFO] columns with count within 2-10 {'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      5, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      4, ..., 255989, 255994, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164762.  91238.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6813 - tp: 123507.0000 - fp: 68493.0000 - tn: 699507.0000 - fn: 68493.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.9108 - val_loss: 0.6802 - val_tp: 41255.0000 - val_fp: 22745.0000 - val_tn: 233255.0000 - val_fn: 22745.0000 - val_accuracy: 0.8578 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-23040000-23296000
[INFO] processing batch 23296000-23552000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:56269 (21.98008%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:25.94531%,0.8139250565:21.08359%,0.8029830673999999:18.17734%,0.8149336757:17.44219%,0.8137722355:17.35078%,0.1074637814:0.00039%,0.8059172320999999:0.00039%]
[INFO] ** classification:[normal:64.38047%,Single Stage Single Point:35.61953%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.05469%,1:25.94531%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.55781%,1:17.44219%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82266%,1:18.17734%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.56562%,1:38.43437%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.91641%,1:21.08359%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70391%,1:43.29609%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.55781%,1:17.44219%]
[INFO] ** dst-192.168.1.40:[0:81.82266%,1:18.17734%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.05469%,1:25.94531%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.55781%,1:17.44219%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82266%,1:18.17734%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56562%,1:38.43437%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99844%,1:0.00156%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64922%,1:17.35078%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.05547%,1:25.94453%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.91641%,1:21.08359%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.55781%,1:17.44219%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82266%,1:18.17734%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 's_port': 7, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255995, 255996, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      4,      7, ..., 255991, 255997, 255998]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164814.  91186.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6804 - tp: 123601.0000 - fp: 68399.0000 - tn: 699601.0000 - fn: 68399.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9109 - val_loss: 0.6800 - val_tp: 41213.0000 - val_fp: 22787.0000 - val_tn: 233213.0000 - val_fn: 22787.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.9110
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-23296000-23552000
[INFO] processing batch 23552000-23808000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:55508 (21.68281%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00547%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.96953%,0.8139250565:21.09688%,0.8029830673999999:18.04336%,0.8149336757:17.48633%,0.8137722355:17.39492%,0.0:0.00547%,0.9715599976:0.00039%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.9535729568000001:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:64.46914%,Single Stage Single Point:35.53086%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_name-eth1:[1:99.99453%,0:0.00547%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99453%,1:0.00547%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.51328%,1:17.48672%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.95586%,1:18.04414%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99453%,1:0.00547%]
[INFO] ** dst-192.168.1.10:[0:78.90312%,1:21.09688%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63516%,1:43.36484%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.51328%,1:17.48672%]
[INFO] ** dst-192.168.1.40:[0:81.95664%,1:18.04336%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99453%,1:0.00547%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99453%,1:0.00547%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02969%,1:25.97031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51328%,1:17.48672%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.95586%,1:18.04414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5082%,1:38.4918%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.60547%,1:17.39453%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03047%,1:25.96953%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90312%,1:21.09688%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.51367%,1:17.48633%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.95664%,1:18.04336%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      3,      8, ..., 255990, 255994, 255995]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [165041.  90959.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6794 - tp: 123749.0000 - fp: 68251.0000 - tn: 699749.0000 - fn: 68251.0000 - accuracy: 0.8578 - precision: 0.6445 - recall: 0.6445 - auc: 0.9111 - val_loss: 0.6787 - val_tp: 41292.0000 - val_fp: 22708.0000 - val_tn: 233292.0000 - val_fn: 22708.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.9113
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-23552000-23808000
[INFO] processing batch 23808000-24064000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:54330 (21.22266%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.0:0.00078%]
[INFO] ** s_port:[0.834280824:25.92031%,0.8139250565:21.05508%,0.8029830673999999:18.13008%,0.8149336757:17.50703%,0.8137722355:17.38398%,0.814841983:0.00117%,0.8343113882:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%]
[INFO] ** classification:[normal:64.3625%,Single Stage Single Point:35.6375%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.07852%,1:25.92148%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4918%,1:17.5082%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86953%,1:18.13047%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.56094%,1:38.43906%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.94492%,1:21.05508%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6957%,1:43.3043%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.49297%,1:17.50703%]
[INFO] ** dst-192.168.1.40:[0:81.86953%,1:18.13047%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.07852%,1:25.92148%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4918%,1:17.5082%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86953%,1:18.13047%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.56094%,1:38.43906%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.61602%,1:17.38398%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.08008%,1:25.91992%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.94531%,1:21.05469%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.49375%,1:17.50625%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.87031%,1:18.12969%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      5, ..., 255995, 255996, 255998]),)
y_vector [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164768.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     0,      2,      4, ..., 255989, 255997, 255999]),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164768.  91232.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6793 - tp: 123603.0000 - fp: 68397.0000 - tn: 699603.0000 - fn: 68397.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.9110 - val_loss: 0.6794 - val_tp: 41165.0000 - val_fp: 22835.0000 - val_tn: 233165.0000 - val_fn: 22835.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-23808000-24064000
[INFO] processing batch 24064000-24320000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:696 (0.27187%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:53384 (20.85312%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.0:0.00117%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.96133%,0.8139250565:21.07148%,0.8029830673999999:18.16055%,0.8149336757:17.4707%,0.8137722355:17.32969%,0.0:0.00117%,0.0020936488:0.00078%,0.8059172320999999:0.00078%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.15243902439999998:0.00039%,0.8147502904:0.00039%,0.7586191087:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:64.36836%,Single Stage Single Point:35.63164%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52891%,1:17.47109%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.83945%,1:18.16055%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.92852%,1:21.07148%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70898%,1:43.29102%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.52891%,1:17.47109%]
[INFO] ** dst-192.168.1.40:[0:81.83906%,1:18.16094%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03828%,1:25.96172%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52891%,1:17.47109%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.83945%,1:18.16055%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67031%,1:17.32969%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03906%,1:25.96094%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.92852%,1:21.07148%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5293%,1:17.4707%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.83945%,1:18.16055%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255995, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     2,      5,      9, ..., 255993, 255996, 255997]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [164783.  91217.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 10s - loss: 0.6788 - tp: 123599.0000 - fp: 68401.0000 - tn: 699599.0000 - fn: 68401.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.9109 - val_loss: 0.6787 - val_tp: 41184.0000 - val_fp: 22816.0000 - val_tn: 233184.0000 - val_fn: 22816.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9109
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-24064000-24320000
[INFO] processing batch 24320000-24576000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:63855 (24.94336%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.002116286:0.00078%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90703%,0.8139250565:21.06953%,0.8029830673999999:18.22578%,0.8149336757:17.47305%,0.8137722355:17.3207%,0.0:0.00117%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,1.0:0.00039%,0.8344030809:0.00039%,0.8673054588:0.00039%,0.9088575095999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:64.30039%,Single Stage Single Point:35.69961%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09258%,1:25.90742%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52695%,1:17.47305%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77344%,1:18.22656%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.60977%,1:38.39023%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.93047%,1:21.06953%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.77188%,1:43.22812%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.52695%,1:17.47305%]
[INFO] ** dst-192.168.1.40:[0:81.77383%,1:18.22617%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09258%,1:25.90742%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52695%,1:17.47305%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77344%,1:18.22656%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.60977%,1:38.39023%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.67969%,1:17.32031%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09336%,1:25.90664%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93086%,1:21.06914%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52695%,1:17.47305%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77422%,1:18.22578%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      3,      4, ..., 255994, 255995, 255998]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
z vector sum [164609.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([     1,      2,      6, ..., 255996, 255997, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]]
z vector sum [164609.  91391.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 11s - loss: 0.6788 - tp: 123440.0000 - fp: 68560.0000 - tn: 699440.0000 - fn: 68560.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.9107 - val_loss: 0.6783 - val_tp: 41169.0000 - val_fp: 22831.0000 - val_tn: 233169.0000 - val_fn: 22831.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9108
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-24320000-24576000
[INFO] processing batch 24576000-24832000/24819975
[33m[LOSS] 0.6783265175819397[0m
[CHECKING EARLY STOP]: currentLoss < min_delta ? => 0.6783265175819397  <  0.001
--- 4129.769550085068 seconds ---
2020-02-09 01:52:01.326305: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-09 01:52:01.342548: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8e9ee83ea0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-09 01:52:01.342586: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Using TensorFlow backend.
WARNING:tensorflow:Large dropout rate: 0.8 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
=================================================
        SCORING v0.4.4 (multi-class)
=================================================
Date: 2020-02-09 01:52:01.321342
MULTI-CLASS num classes: 5
------------DNN info-------------
wrapLayerSize 2
coreLayerSize 4
numCoreLayers 1
outputLayerActivation softmax
output_dim 5
loss categorical_crossentropy
optimizer adam
------------DNN info-------------
[INFO] input_shape (128, 107)
[INFO] LSTM first and last layer neurons: 2
[INFO] adding core layer 0
[INFO] created DNN
loading weights: checkpoints/*
loading file checkpoints/lstm-epoch-003-files-0-50-batch-9984000-10240000
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2015-12-31_130240_112.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2015-12-31_181648_113.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2015-12-31_181648_113.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2015-12-31_233049_114.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_151435_117.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_151435_117.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_151435_117.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_203011_118.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_203011_118.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_014558_119.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_121729_121.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_121729_121.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_121729_121.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_172943_122.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_172943_122.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_172943_122.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (7939824, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (7939824, 17)

[INFO] analyzing data
[INFO] 7939824 rows
[INFO] ** unixtime:21665 (0.27286%)
[INFO] ** orig:[192.168.1.48:99.99797%,192.168.1.88:0.00188%,192.168.1.87:0.00015%]
[INFO] ** type:[log:99.99952%,control:0.00039%,alert:9e-05%]
[INFO] ** i/f_name:[eth1:99.99694%,0:0.00306%]
[INFO] ** i/f_dir:[outbound:99.99708%,inbound:0.00292%]
[INFO] ** src:[192.168.1.60:38.1781%,192.168.1.10:26.08802%,192.168.1.30:18.17053%,192.168.1.20:17.55846%,192.168.1.88:0.00202%,0:0.00118%,192.168.1.19:0.00044%,192.168.1.40:0.00034%,192.168.1.136:0.00031%,192.168.1.49:0.00025%,192.168.1.201:0.00018%,192.168.1.200:0.0001%,192.168.1.199:5e-05%,192.168.1.134:1e-05%]
[INFO] ** dst:[192.168.1.20:43.37809%,192.168.1.10:20.88767%,192.168.1.40:18.17044%,192.168.1.30:17.55826%,0:0.00306%,192.168.1.50:0.00106%,192.168.1.255:0.00039%,192.168.1.60:0.00023%,224.0.0.252:0.0002%,192.168.1.201:0.00015%,224.0.0.251:0.00014%,239.255.255.250:0.0001%,192.168.1.19:8e-05%,192.168.1.200:5e-05%,192.168.1.49:5e-05%,192.168.1.88:4e-05%]
[INFO] ** proto:[tcp:99.99607%,0:0.00306%,udp:0.00087%]
[INFO] ** appi_name:[CIP_read_tag_service:99.99545%,0:0.00306%,NetBIOS Name Service:0.00024%,LLMNR Protocol:0.0002%,NetBIOS Datagram Service:0.00019%,Multicast DNS Protocol (mDNS):0.00014%,DCE-RPC Protocol:0.0001%,Unknown Traffic:0.0001%,SSDP:0.0001%,CIP_gen:9e-05%,EtherNet/IP:6e-05%,Common Industrial Protocol - RMW (Read/Modify/Write):6e-05%,Common Industrial Protocol:6e-05%,Server Message Block (SMB):4e-05%,NetBIOS Session Service:4e-05%,OSIsoft PI:3e-05%,Simple Object Access Protocol:1e-05%,Common Industrial Protocol - success:1e-05%,Web Browsing:1e-05%]
[INFO] ** proxy_src_ip:[192.168.1.60:38.1781%,192.168.1.10:26.08802%,192.168.1.30:18.17053%,192.168.1.20:17.55846%,0:0.00306%,192.168.1.19:0.00044%,192.168.1.40:0.00034%,192.168.1.136:0.00031%,192.168.1.49:0.00025%,192.168.1.201:0.00018%,192.168.1.88:0.00014%,192.168.1.200:0.0001%,192.168.1.199:5e-05%,192.168.1.134:1e-05%]
[INFO] ** modbus_function_code:[0.9743589744:99.99545%,0.0:0.00446%,1.0:9e-05%]
[INFO] ** modbus_function_description:[Read Tag Service - Response:49.99838%,Read Tag Service:49.99708%,0:0.00446%,Forward Close - Response:9e-05%]
[INFO] ** modbus_transaction_id:65536 (0.82541%)
[INFO] ** scada_tag:[HMI_FIT201:26.08708%,HMI_LIT101:20.88743%,HMI_LIT401:18.17008%,HMI_LIT301:17.55785%,HMI_AIT202:17.29042%,0:0.00715%]
[INFO] ** service:[0.7025755984000001:99.99574%,0.0:0.00306%,0.0021476384:0.00024%,0.08394601119999999:0.0002%,0.0021633145999999997:0.00019%,0.08391465880000001:0.00014%,0.0208806885:0.0001%,0.0297847659:0.0001%,0.002116286:0.0001%,0.0021789908:8e-05%,0.08543524949999999:3e-05%,0.0839773636:1e-05%,0.0012540954:1e-05%]
[INFO] ** s_port:[0.834280824:26.08742%,0.8139250565:20.88754%,0.8029830673999999:18.17019%,0.8149336757:17.55806%,0.8137722355:17.29056%,0.0:0.00306%,0.8343113882:0.00034%,0.8059172320999999:0.00034%,0.814841983:0.00031%,0.0020936488:0.00024%,0.8030136315999999:0.00023%,0.0021089309:0.00019%,0.8345253376999999:0.00015%,0.0818051226:0.00014%,0.8030441959000001:0.00013%,0.8344030809:0.00011%,0.8147502904:9e-05%,0.0290360046:6e-05%,0.7431230515:6e-05%,0.696222263:6e-05%,0.8683752063:5e-05%,0.8896631823000001:5e-05%,0.7435203863:5e-05%,0.7081881533:5e-05%,0.7967938137999999:4e-05%,0.9715599976:4e-05%,0.9535729568000001:4e-05%,0.15240846019999998:3e-05%,0.9385047986:3e-05%,0.9137019378:3e-05%,0.7586191087:3e-05%,0.7593068036:3e-05%,0.15243902439999998:3e-05%,0.8411730545999999:3e-05%,0.315972859:3e-05%,0.9310776942:3e-05%,0.9945442875:3e-05%,0.7943945229:1e-05%,0.9228712024:1e-05%,0.7806864723:1e-05%,0.9925728957:1e-05%,0.9406137294:1e-05%,0.8086374473000001:1e-05%,0.1074484993:1e-05%,0.9705208142:1e-05%,0.7840485359999999:1e-05%,0.9882022128:1e-05%,0.7853933615:1e-05%,0.7616602481999999:1e-05%]2020-02-09 01:53:26.496360: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 01:53:26.502987: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 01:53:26.506109: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 01:53:26.532462: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 01:53:26.534358: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 01:53:26.536548: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 01:53:26.538746: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 01:53:26.549054: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.

[INFO] ** classification:[normal:87.56318%,Single Stage Single Point:7.92975%,Multi Stage Multi Point:2.55424%,Single Stage Multi Point:1.3816%,Multi Stage Single Point:0.57123%]
[INFO] columns with count within 2-10 {'orig': 3, 'type': 3, 'i/f_name': 2, 'i/f_dir': 2, 'proto': 3, 'modbus_function_code': 3, 'modbus_function_description': 4, 'scada_tag': 6, 'classification': 5}
[33mencode_text_dummy orig[0m
[33mencode_text_dummy type[0m
[33mencode_text_dummy i/f_name[0m
[33mencode_text_dummy i/f_dir[0m
[33mencode_text_dummy src[0m
[33mencode_text_dummy dst[0m
[33mencode_text_dummy proto[0m
[33mencode_text_dummy appi_name[0m
[33mencode_text_dummy proxy_src_ip[0m
[33mencode_text_dummy modbus_function_description[0m
[33mencode_text_dummy scada_tag[0m
adding missing-0
adding missing-1
adding missing-2
adding missing-3
adding missing-4
adding missing-5
adding missing-6
adding missing-7
adding missing-8
adding missing-9
adding missing-10
adding missing-11
adding missing-12
adding missing-13
adding missing-14
adding missing-15
len(df.columns) 108
numFeatures 107
[INFO] processing batch 0-256000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 1 1 ... 0 1 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.0019809284210206
tp :  164503.0
fp :  91497.0
tn :  932503.0
fn :  91497.0
accuracy :  0.8570374846458435
precision :  0.6425898671150208
recall :  0.6425898671150208
auc :  0.910647451877594

y_eval {0: 164503, 1: 91497}
pred {0: 256000}
[INFO] confusion matrix for file 
[[164503      0      0      0      0]
 [ 91497      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[164503      0      0      0      0]
 [ 91497      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 256000-512000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [1 0 1 ... 2 2 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.3237501811981201
tp :  239293.0
fp :  16707.0
tn :  1007293.0
fn :  16707.0
accuracy :  0.9738954901695251
precision :  0.934738278388977
recall :  0.934738278388977
auc :  0.9732812643051147

y_eval {0: 239293, 1: 9605, 2: 7102}
pred {0: 256000}
[INFO] confusion matrix for file 
[[239293      0      0      0      0]
 [  9605      0      0      0      0]
 [  7102      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[403796      0      0      0      0]
 [101102      0      0      0      0]
 [  7102      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 512000-768000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 2 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.4685981611609459
tp :  236050.0
fp :  19950.0
tn :  1004050.0
fn :  19950.0
accuracy :  0.9688284397125244
precision :  0.922070324420929
recall :  0.922070324420929
auc :  0.9512939453125

y_eval {0: 236050, 2: 19950}
pred {0: 256000}
[INFO] confusion matrix for file 
[[236050      0      0      0      0]
 [     0      0      0      0      0]
 [ 19950      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[639846      0      0      0      0]
 [101102      0      0      0      0]
 [ 27052      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 768000-1024000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 4 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.7955921847820282
tp :  172406.0
fp :  83594.0
tn :  940406.0
fn :  83594.0
accuracy :  0.8693856000900269
precision :  0.6734609603881836
recall :  0.6734609603881836
auc :  0.6734609603881836

y_eval {0: 172406, 4: 83594}
pred {0: 256000}
[INFO] confusion matrix for file 
[[172406      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [ 83594      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[812252      0      0      0      0]
 [101102      0      0      0      0]
 [ 27052      0      0      0      0]
 [     0      0      0      0      0]
 [ 83594      0      0      0      0]]
[INFO] processing batch 1024000-1280000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [4 0 4 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  2.519676342189312
tp :  136792.0
fp :  119208.0
tn :  904792.0
fn :  119208.0
accuracy :  0.8137394189834595
precision :  0.5343437790870667
recall :  0.5343437790870667
auc :  0.5343437194824219

y_eval {0: 136792, 4: 119208}
pred {0: 256000}
[INFO] confusion matrix for file 
[[136792      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [119208      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[949044      0      0      0      0]
 [101102      0      0      0      0]
 [ 27052      0      0      0      0]
 [     0      0      0      0      0]
 [202802      0      0      0      0]]
[INFO] processing batch 1280000-1536000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.09600474137067795
tp :  256000.0
fp :  0.0
tn :  1024000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file 
[[256000      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[1205044       0       0       0       0]
 [ 101102       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 1536000-1792000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 1 1 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.15473198175430297
tp :  250069.0
fp :  5931.0
tn :  1018069.0
fn :  5931.0
accuracy :  0.9907329678535461
precision :  0.9768320322036743
recall :  0.9768320322036743
auc :  0.9942079782485962

y_eval {0: 250069, 1: 5931}
pred {0: 256000}
[INFO] confusion matrix for file 
[[250069      0      0      0      0]
 [  5931      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[1455113       0       0       0       0]
 [ 107033       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 1792000-2048000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 1] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.3862937681674957
tp :  226683.0
fp :  29317.0
tn :  994683.0
fn :  29317.0
accuracy :  0.9541926980018616
precision :  0.8854804635047913
recall :  0.8854804635047913
auc :  0.9713701009750366

y_eval {0: 226683, 1: 29317}
pred {0: 256000}
[INFO] confusion matrix for file 
[[226683      0      0      0      0]
 [ 29317      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[1681796       0       0       0       0]
 [ 136350       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 2048000-2304000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [1 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.7719247798323632
tp :  187737.0
fp :  68263.0
tn :  955737.0
fn :  68263.0
accuracy :  0.8933401107788086
precision :  0.7333476543426514
recall :  0.7333476543426514
auc :  0.9333369135856628

y_eval {0: 187737, 1: 68263}
pred {0: 256000}
[INFO] confusion matrix for file 
[[187737      0      0      0      0]
 [ 68263      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[1869533       0       0       0       0]
 [ 204613       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 2304000-2560000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.09600474137067795
tp :  256000.0
fp :  0.0
tn :  1024000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file 
[[256000      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[2125533       0       0       0       0]
 [ 204613       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 2560000-2816000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.09600474137067795
tp :  256000.0
fp :  0.0
tn :  1024000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file 
[[256000      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[2381533       0       0       0       0]
 [ 204613       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 2816000-3072000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 1 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.5709305794239045
tp :  208036.0
fp :  47964.0
tn :  976036.0
fn :  47964.0
accuracy :  0.9250568151473999
precision :  0.8126406073570251
recall :  0.8126406073570251
auc :  0.9531601667404175

y_eval {0: 208036, 1: 47964}
pred {0: 256000}
[INFO] confusion matrix for file 
[[208036      0      0      0      0]
 [ 47964      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[2589569       0       0       0       0]
 [ 252577       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 3072000-3328000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.3780154647231102
tp :  227519.0
fp :  28481.0
tn :  995519.0
fn :  28481.0
accuracy :  0.9554988741874695
precision :  0.8887460827827454
recall :  0.8887460827827454
auc :  0.9721865057945251

y_eval {0: 227519, 1: 28481}
pred {0: 256000}
[INFO] confusion matrix for file 
[[227519      0      0      0      0]
 [ 28481      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[2817088       0       0       0       0]
 [ 281058       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 3328000-3584000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.09600474137067795
tp :  256000.0
fp :  0.0
tn :  1024000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file 
[[256000      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[3073088       0       0       0       0]
 [ 281058       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 3584000-3840000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.26788860458135605
tp :  238641.0
fp :  17359.0
tn :  1006641.0
fn :  17359.0
accuracy :  0.972876787185669
precision :  0.9321914315223694
recall :  0.9321914315223694
auc :  0.9830478429794312

y_eval {0: 238641, 1: 17359}
pred {0: 256000}
[INFO] confusion matrix for file 
[[238641      0      0      0      0]
 [ 17359      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[3311729       0       0       0       0]
 [ 298417       0       0       0       0]
 [  27052       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 3840000-4096000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 2 2 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.4739454345703125
tp :  182220.0
fp :  73780.0
tn :  950220.0
fn :  73780.0
accuracy :  0.884719729423523
precision :  0.7117968797683716
recall :  0.7117968797683716
auc :  0.819873034954071

y_eval {0: 182220, 2: 73780}
pred {0: 256000}
[INFO] confusion matrix for file 
[[182220      0      0      0      0]
 [     0      0      0      0      0]
 [ 73780      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[3493949       0       0       0       0]
 [ 298417       0       0       0       0]
 [ 100832       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 4096000-4352000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 2 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.2615332378745079
tp :  247137.0
fp :  8863.0
tn :  1015137.0
fn :  8863.0
accuracy :  0.9861516952514648
precision :  0.9653788805007935
recall :  0.9653788805007935
auc :  0.9783617854118347

y_eval {0: 247137, 2: 8863}
pred {0: 256000}
[INFO] confusion matrix for file 
[[247137      0      0      0      0]
 [     0      0      0      0      0]
 [  8863      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[3741086       0       0       0       0]
 [ 298417       0       0       0       0]
 [ 109695       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 4352000-4608000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 1 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.45598155570030213
tp :  219645.0
fp :  36355.0
tn :  987645.0
fn :  36355.0
accuracy :  0.943195641040802
precision :  0.8579882979393005
recall :  0.8579882979393005
auc :  0.9644970893859863

y_eval {0: 219645, 1: 36355}
pred {0: 256000}
[INFO] confusion matrix for file 
[[219645      0      0      0      0]
 [ 36355      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[3960731       0       0       0       0]
 [ 334772       0       0       0       0]
 [ 109695       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 4608000-4864000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 1 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.6563923122286797
tp :  199405.0
fp :  56595.0
tn :  967405.0
fn :  56595.0
accuracy :  0.9115711450576782
precision :  0.7789257764816284
recall :  0.7789257764816284
auc :  0.9447314739227295

y_eval {0: 199405, 1: 56595}
pred {0: 256000}
[INFO] confusion matrix for file 
[[199405      0      0      0      0]
 [ 56595      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[4160136       0       0       0       0]
 [ 391367       0       0       0       0]
 [ 109695       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 4864000-5120000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.09600474137067795
tp :  256000.0
fp :  0.0
tn :  1024000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file 
[[256000      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[4416136       0       0       0       0]
 [ 391367       0       0       0       0]
 [ 109695       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 5120000-5376000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.09600474137067795
tp :  256000.0
fp :  0.0
tn :  1024000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file 
[[256000      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[4672136       0       0       0       0]
 [ 391367       0       0       0       0]
 [ 109695       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 5376000-5632000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.09604209381341934
tp :  255998.0
fp :  2.0
tn :  1023998.0
fn :  2.0
accuracy :  0.9999969005584717
precision :  0.9999921917915344
recall :  0.9999921917915344
auc :  0.9999951124191284

y_eval {0: 255998, 2: 2}
pred {0: 256000}
[INFO] confusion matrix for file 
[[255998      0      0      0      0]
 [     0      0      0      0      0]
 [     2      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[4928134       0       0       0       0]
 [ 391367       0       0       0       0]
 [ 109697       0       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 5632000-5888000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.4548124086260796
tp :  237169.0
fp :  18831.0
tn :  1005169.0
fn :  18831.0
accuracy :  0.9705768823623657
precision :  0.9264414310455322
recall :  0.9264414310455322
auc :  0.9540258646011353

y_eval {0: 237169, 3: 18831}
pred {0: 256000}
[INFO] confusion matrix for file 
[[237169      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [ 18831      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[5165303       0       0       0       0]
 [ 391367       0       0       0       0]
 [ 109697       0       0       0       0]
 [  18831       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 5888000-6144000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.7168796689510345
tp :  217813.0
fp :  38187.0
tn :  985813.0
fn :  38187.0
accuracy :  0.9403335452079773
precision :  0.8508320450782776
recall :  0.8508320450782776
auc :  0.9238544702529907

y_eval {0: 217813, 1: 11663, 3: 26524}
pred {0: 256000}
[INFO] confusion matrix for file 
[[217813      0      0      0      0]
 [ 11663      0      0      0      0]
 [     0      0      0      0      0]
 [ 26524      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[5383116       0       0       0       0]
 [ 403030       0       0       0       0]
 [ 109697       0       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 6144000-6400000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [1 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.1760009498000145
tp :  247921.0
fp :  8079.0
tn :  1015921.0
fn :  8079.0
accuracy :  0.9873766899108887
precision :  0.9684414267539978
recall :  0.9684414267539978
auc :  0.9921103715896606

y_eval {0: 247921, 1: 8079}
pred {0: 256000}
[INFO] confusion matrix for file 
[[247921      0      0      0      0]
 [  8079      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[5631037       0       0       0       0]
 [ 411109       0       0       0       0]
 [ 109697       0       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 6400000-6656000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.09600474137067795
tp :  256000.0
fp :  0.0
tn :  1024000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file 
[[256000      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[5887037       0       0       0       0]
 [ 411109       0       0       0       0]
 [ 109697       0       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 6656000-6912000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 1 0 1] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.24992673516273498
tp :  240455.0
fp :  15545.0
tn :  1008455.0
fn :  15545.0
accuracy :  0.9757110476493835
precision :  0.9392773509025574
recall :  0.9392773509025574
auc :  0.9848193526268005

y_eval {0: 240455, 1: 15545}
pred {0: 256000}
[INFO] confusion matrix for file 
[[240455      0      0      0      0]
 [ 15545      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[6127492       0       0       0       0]
 [ 426654       0       0       0       0]
 [ 109697       0       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 6912000-7168000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 1] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.99520814037323
tp :  165187.0
fp :  90813.0
tn :  933187.0
fn :  90813.0
accuracy :  0.858106255531311
precision :  0.6452617049217224
recall :  0.6452617049217224
auc :  0.9113154411315918

y_eval {0: 165187, 1: 90813}
pred {0: 256000}
[INFO] confusion matrix for file 
[[165187      0      0      0      0]
 [ 90813      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[6292679       0       0       0       0]
 [ 517467       0       0       0       0]
 [ 109697       0       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 7168000-7424000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 1 ... 0 1 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.0026047382354737
tp :  164440.0
fp :  91560.0
tn :  932440.0
fn :  91560.0
accuracy :  0.856938898563385
precision :  0.6423437595367432
recall :  0.6423437595367432
auc :  0.9105859398841858

y_eval {0: 164440, 1: 91560}
pred {0: 256000}
[INFO] confusion matrix for file 
[[164440      0      0      0      0]
 [ 91560      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[6457119       0       0       0       0]
 [ 609027       0       0       0       0]
 [ 109697       0       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 7424000-7680000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [1 0 1 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.2997916998267174
tp :  235419.0
fp :  20581.0
tn :  1003419.0
fn :  20581.0
accuracy :  0.9678425192832947
precision :  0.9196054935455322
recall :  0.9196054935455322
auc :  0.9799013733863831

y_eval {0: 235419, 1: 20581}
pred {0: 256000}
[INFO] confusion matrix for file 
[[235419      0      0      0      0]
 [ 20581      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[6692538       0       0       0       0]
 [ 629608       0       0       0       0]
 [ 109697       0       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 7680000-7936000/7939824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.09600474137067795
tp :  256000.0
fp :  0.0
tn :  1024000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file 
[[256000      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[6948538       0       0       0       0]
 [ 629608       0       0       0       0]
 [ 109697       0       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
--- 281.7298879623413 seconds ---
